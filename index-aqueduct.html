<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Aqueduct API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index-aqueduct aqueduct" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo-aqueduct.png" alt="Logo aqueduct" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://ui.resourcewatch.org'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/resource-watch/doc-api'>Contribute to these docs</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Aqueduct API Documentation</p>

          <h1 id="authentication">Authentication</h1>

<p>The RW API uses JWT <a href="https://tools.ietf.org/html/rfc7519">(JSON Web Tokens)</a> to identify and authenticate its users. This token must be provided inside an <code class="prettyprint">Authorization</code> header, with the form <code class="prettyprint">Bearer: &lt;token&gt;</code>.</p>

<p>However, in order to perform GET requests for content that is not private, there&rsquo;s no need for any sort of authentication or token.</p>

<h2 id="how-to-generate-your-private-token">How to generate your private token</h2>

<p>To generate your own token, perform the following steps:</p>

<ol>
<li>Navigate to <a href="http://ui.resourcewatch.org/">here</a>. If you are not logged in yet, the application will redirect you to the login page. You will see the login page:</li>
</ol>

<p><img src="images/authentication/login.png" alt="Control Tower login page" /></p>

<p>You can login with your WRI credentials (email and password) or with other auth providers (a Google, Facebook, or Twitter account). If you can&rsquo;t remember your password (don&rsquo;t worry! it happens to everyone!) you can reset your password clicking on &lsquo;Recover password&rsquo;.</p>

<ol>
<li><p>After logging in you will be redirected to the Control Tower application and you will see its front page:
<img src="images/authentication/control-tower.png" alt="Control Tower Dashboard" /></p></li>
<li><p>To obtain your token, click in the Profile menu item and you will see the token:
<img src="images/authentication/profile.png" alt="Control Tower Profile" /></p></li>
<li><p>Copy your token clicking the Copy button. Remember to add the header <code class="prettyprint">Authorization: Bearer: &lt;yourToken&gt;</code> to any API call to authenticate yourself.</p></li>
</ol>

<h2 id="how-to-create-a-new-user">How to create a new user</h2>

<p>To create a new user make a request like the one in the sidebar:</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/auth/user <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"&lt;email&gt;",
    "role":"&lt;role&gt;",
    "extraUserData": {
      "apps": [
        "&lt;apps&gt;"
      ]
    }
}'</span>
</code></pre>
<p>There are three allowed roles: <code class="prettyprint">USER</code>, <code class="prettyprint">MANAGER</code> and <code class="prettyprint">ADMIN</code>. The &#39;apps&rsquo; field only permits applications that are powered by the API: <code class="prettyprint">rw</code>, <code class="prettyprint">gfw</code>, <code class="prettyprint">prep</code>, etc.</p>

          <h1 id="dataset">Dataset</h1>

<h2 id="what-is-a-dataset">What is a Dataset?</h2>

<p>A dataset abstracts the data that can be obtained from several sources into a common interface. There are several data providers supported in the API, and each of those has a different provider. Datasets can belong to several applications.</p>

<h2 id="supported-dataset-sources">Supported dataset sources</h2>

<h3 id="third-party-dataset-connectors">Third party Dataset connectors</h3>

<p>For data stored on third party services.</p>

<h4 id="carto">Carto</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;cartodb&#39;)</code></strong><br>
<a href="https://www.carto.com"><img src="images/dataset/carto.png" alt="Carto" /></a> CARTO is an open, powerful, and intuitive map platform for discovering and predicting the key insights underlying the location data in our world.</p>

<h3 id="arcgis-feature-service">ArcGIS Feature service</h3>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;featureservice&#39;)</code></strong> <a href="https://www.arcgis.com/features/index.html"><img src="https://www.arcgis.com/features/img/logo-esri.png" alt="Logo esri" /></a><br>
ArcGIS for server is a Complete, Cloud-Based Mapping Platform.</p>

<h3 id="google-earth-engine">Google Earth Engine</h3>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;gee&#39;)</code></strong> <a href="https://earthengine.google.com/"><img src="https://earthengine.google.com/static/images/GoogleEarthEngine_Grey_108.png" alt="Googleearthengine grey 108" /></a><br>
Google Earth Engine combines a multi-petabyte catalog of satellite imagery and geospatial datasets with planetary-scale analysis capabilities and makes it available for scientists, researchers, and developers to detect changes, map trends, and quantify differences on the Earth&rsquo;s surface.</p>

<h4 id="web-map-services-wms">Web Map Services (<a href="http://www.opengeospatial.org/standards/wms">WMS</a>)</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;wms&#39;, provider: &#39;wms&#39;)</code></strong></p>

<p>WMS connector provides access to data served through <a href="http://www.opengeospatial.org/standards/wms">OGC WMS</a> protocol standard.</p>

<h4 id="rasdaman-raster-data-manager">Rasdaman (Raster Data Manager)</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;rasdaman&#39;)</code></strong><br>
<a href="http://www.rasdaman.com/">Rasdaman</a> is a database with capabilities for storage, manipulation and retrieval of multidimensional arrays.</p>

<h3 id="internal-storage-connectors">Internal storage connectors</h3>

<p>For data stored in our system.</p>

<h4 id="nex-gddp">NEX-GDDP</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;nexgddp&#39;)</code></strong><br>
The NASA Earth Exchange Global Daily Downscaled Projections (<a href="https://nex.nasa.gov/nex/projects/1356/">NEX-GDDP</a>) dataset is comprised of downscaled climate scenarios for the globe that are derived from the General Circulation Model (GCM) runs conducted under the Coupled Model Intercomparison Project Phase 5 (CMIP5) and across two of the four greenhouse gas emissions scenarios known as Representative Concentration Pathways (RCPs).</p>

<h4 id="comma-separated-values-csv">Comma-Separated Values (CSV)</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;document&#39;, provider: &#39;csv&#39;)</code></strong><br>
Arbitrary Comma-Separated Values data</p>

<h4 id="tab-separated-values-tsv">Tab-Separated Values (TSV)</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;document&#39;, provider: &#39;tsv&#39;)</code></strong><br>
Arbitrary tab-Separated Values data</p>

<h4 id="javascript-object-notation-json">JavaScript Object Notation (JSON)</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;document&#39;, provider: &#39;json&#39;)</code></strong><br>
Arbitrary <a href="http://www.json.org/">json</a> structured data</p>

<h4 id="xml">XML</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;document&#39;, provider: &#39;xml&#39;)</code></strong><br>
Arbitrary <a href="https://www.w3.org/TR/2006/REC-xml11-20060816/">XML</a> data documents</p>

<h2 id="getting-all-datasets">Getting all datasets</h2>

<p>This endpoint will allow to get all datasets available in the API:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00f2be42-1ee8-4069-a55a-16a988f2b7a0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Glad points"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Glad-points-1490086842129"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"data4sdgs"</span><span class="p">],</span><span class="w">
            </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributesPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"connectorType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"document"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"58333dcfd9f39b189ca44c75"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"connectorUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers.csv"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"overwrite"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"blockchain"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geoInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                </span><span class="p">},</span><span class="w">
            </span><span class="s2">"clonedHost"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
            </span><span class="s2">"errorMessage"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-13T10:45:46.368Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetRelevantProps"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"layerRelevantProps"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=99&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"prev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=2&amp;page[size]=10"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">990</span><span class="p">,</span><span class="w">
    </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="slug-amp-dataset-id">Slug &amp; dataset-id</h3>

<p>Datasets have an auto-generated and unique slug and id that allows the user to get, create, update, query or clone that dataset.</p>

<p>The dataset slug and the id cannot be updated even if the name changes.</p>

<h3 id="error-message">Error Message</h3>

<p>When a dataset is created the status is set to &ldquo;pending&rdquo; by default. Once the adapter validates the dataset, the status is changed to &ldquo;saved&rdquo;. If the validation fails, the status will be set to &ldquo;failed&rdquo; and the adapter will also set an error message indicating the reason.</p>

<h3 id="filters">Filters</h3>

<p>The dataset list provided by the endpoint can be filtered with the following attributes:</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Description</th>
<th>Accepted values</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Allow us to filter by name</td>
<td>any valid text</td>
</tr>
<tr>
<td>type</td>
<td>Allow us to distinguish between tabular and raster datasets</td>
<td><code class="prettyprint">raster</code> or <code class="prettyprint">tabular</code></td>
</tr>
<tr>
<td>app</td>
<td>Applications to which this dataset is being used</td>
<td>Available applications like: <code class="prettyprint">[&quot;data4sdgs&quot;,&quot;gfw&quot;,&quot;rw&quot;,&quot;aqueduct&quot;,&quot;prep&quot;,&quot;forest-atlas&quot;,&quot;gfw-climate&quot;,&quot;aqueduct-water-risk&quot;,&quot;test&quot;,&quot;gfw-pro&quot;,&quot;globalforestwatch&quot;, &quot;ghg-gdp&quot;]</code></td>
</tr>
<tr>
<td>connectorType</td>
<td></td>
<td><code class="prettyprint">rest</code> or <code class="prettyprint">document</code></td>
</tr>
<tr>
<td>provider</td>
<td>Dataset provider this include inner connectors and 3rd party ones</td>
<td><a href="##supported-dataset-sources">A valid dataset provider</a></td>
</tr>
<tr>
<td>userId</td>
<td>the user who registered the dataset</td>
<td>valid id</td>
</tr>
<tr>
<td>status</td>
<td>the internal dataset status at connection time</td>
<td><code class="prettyprint">pending</code>, <code class="prettyprint">saved</code> or <code class="prettyprint">failed</code></td>
</tr>
<tr>
<td>published</td>
<td></td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>env</td>
<td>If the dataset is in preproduction environment or in production one</td>
<td><code class="prettyprint">production</code>or <code class="prettyprint">preproduction</code></td>
</tr>
<tr>
<td>overwritted</td>
<td>If the data can be overwritten (only for being able to make dataset updates)</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>verify</td>
<td>If this dataset contains data that is verified using blockchain</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>protected</td>
<td>If it&rsquo;s a protected layer</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>geoInfo</td>
<td>If it contains interceptable geographical info</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Filtering datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?name<span class="o">=</span>birds&amp;provider<span class="o">=</span>cartodb
</code></pre>
<blockquote>
<p>For inclusive filtering with array props use &rsquo;@&rsquo;</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?app<span class="o">=</span>gfw@rw@prep
</code></pre>
<h3 id="sorting">Sorting</h3>

<h4 id="basics-of-sorting">Basics of sorting</h4>

<p>The API currently supports sorting by means of the <code class="prettyprint">sort</code> parameter.</p>

<blockquote>
<p>Sorting datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>name
</code></pre>
<p>Multiple sorting criteria can be used, separating them by commas.</p>

<blockquote>
<p>Sorting datasets by multiple criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>name,description
</code></pre>
<p>You can specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> or <code class="prettyprint">+</code>. By default, <code class="prettyprint">asc</code> order is assumed.</p>

<blockquote>
<p>Explicit order of sorting</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>-name,+description
</code></pre>
<h4 id="special-sorting-criteria">Special sorting criteria</h4>

<p>There are four special sorting criteria:</p>

<ul>
<li><code class="prettyprint">metadata</code>: delegates sorting to the metadata component, sorting by the name field of the metadata.</li>
<li><code class="prettyprint">most-viewed</code> delegates sorting to the graph component, sorting by the datasets that have been queried more frequently. Supports ascending/descending order.</li>
<li><code class="prettyprint">most-favorited</code>: delegates sorting to the graph component, sorting by the datasets that have been more favorited. Supports ascending/descending order.</li>
<li><code class="prettyprint">relevance</code>: delegates sorting to the metadata component, sorting by the datasets which metadata better match the search criteria. Can only be used in conjunction with a <code class="prettyprint">search</code> parameter. Does not support ascending order.</li>
</ul>

<p>Special search criteria must be used as sole sorting criteria, as it&rsquo;s not possible to combine any of them with any other search criteria.</p>

<blockquote>
<p>Sorting datasets with special criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>-most-favorited
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>relevance&amp;status<span class="o">=</span>saved&amp;search<span class="o">=</span>agriculture
</code></pre>
<h3 id="relationships">Relationships</h3>

<p>Available relationships: Any dataset relationship [&lsquo;widget&rsquo;, &#39;layer&rsquo;, &#39;vocabulary&rsquo;, &#39;metadata&rsquo;]</p>

<blockquote>
<p>Including relationships</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata,vocabulary,widget,layer
</code></pre>
<h3 id="advanced-filters">Advanced filters</h3>

<p>By vocabulary-tag matching</p>

<blockquote>
<p>Matching vocabulary tags</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata,vocabulary,widget,layer&amp;vocabulary[legacy]<span class="o">=</span>umd
</code></pre>
<h3 id="pagination">Pagination</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">The number elements per page</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">The page number</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Paginating the output</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata,vocabulary,widget,layer&amp;vocabulary[legacy]<span class="o">=</span>threshold&amp;page[number]<span class="o">=</span>1
curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata,vocabulary,widget,layer&amp;vocabulary[legacy]<span class="o">=</span>threshold&amp;page[number]<span class="o">=</span>2
</code></pre>
<h2 id="how-to-get-a-specific-dataset">How to get a specific dataset</h2>

<blockquote>
<p>To get a dataset:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/51943691-eebc-4cb4-bdfb-057ad4fc2145
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"data"</span>: <span class="o">{</span>
        <span class="s2">"id"</span>: <span class="s2">"51943691-eebc-4cb4-bdfb-057ad4fc2145"</span>,
        <span class="s2">"type"</span>: <span class="s2">"dataset"</span>,
        <span class="s2">"attributes"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Timber Production RDC (test)"</span>,
            <span class="s2">"slug"</span>: <span class="s2">"Timber-Production-RDC-test-1490086842132"</span>,
            <span class="s2">"type"</span>: null,
            <span class="s2">"subtitle"</span>: null,
            <span class="s2">"application"</span>: <span class="o">[</span><span class="s2">"forest-atlas"</span><span class="o">]</span>,
            <span class="s2">"dataPath"</span>: null,
            <span class="s2">"attributesPath"</span>: null,
            <span class="s2">"connectorType"</span>: <span class="s2">"document"</span>,
            <span class="s2">"provider"</span>: <span class="s2">"csv"</span>,
            <span class="s2">"userId"</span>: <span class="s2">"58750a56dfc643722bdd02ab"</span>,
            <span class="s2">"connectorUrl"</span>: <span class="s2">"http://wri-forest-atlas.s3.amazonaws.com/COD/temp/annual%20timber%20production%20DRC%20%28test%29%20-%20Sheet1.csv"</span>,
            <span class="s2">"tableName"</span>: <span class="s2">"index_51943691eebc4cb4bdfb057ad4fc2145"</span>,
            <span class="s2">"status"</span>: <span class="s2">"saved"</span>,
            <span class="s2">"overwrite"</span>: <span class="nb">false</span>,
            <span class="s2">"legend"</span>: <span class="o">{</span>
                <span class="s2">"date"</span>: <span class="o">[</span><span class="s2">"year"</span><span class="o">]</span>,
                <span class="s2">"region"</span>: <span class="o">[]</span>,
                <span class="s2">"country"</span>: <span class="o">[]</span>,
                <span class="s2">"long"</span>: <span class="s2">""</span>,
                <span class="s2">"lat"</span>: <span class="s2">""</span>
            <span class="o">}</span>,
            <span class="s2">"clonedHost"</span>: <span class="o">{}</span>,
            <span class="s2">"errorMessage"</span>: null,
            <span class="s2">"createdAt"</span>: <span class="s2">"2017-01-25T21:48:27.535Z"</span>,
            <span class="s2">"updatedAt"</span>: <span class="s2">"2017-01-25T21:48:28.675Z"</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<blockquote>
<p>To get the dataset including its relationships:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/06c44f9a-aae7-401e-874c-de13b7764959?includes<span class="o">=</span>metadata,vocabulary,widget,layer
</code></pre>
<h2 id="creating-a-dataset">Creating a Dataset</h2>

<p>To create a dataset, you will need an authorization token. Follow the steps of this <a href="#generate-your-own-oauth-token">guide</a> to get yours.</p>

<p>To create a dataset, you need to define all of the required fields in the request body. The fields that compose a dataset are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Dataset name</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>type</td>
<td style="text-align: center">Dataset type</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>subtitle</td>
<td style="text-align: center">Dataset subtitle</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Applications the dataset belongs to</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">Any valid application name(s)</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>connectorType</td>
<td style="text-align: center">Connector type</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">rest, document, wms</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>provider</td>
<td style="text-align: center">The connectorType provider</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">cartodb, feature service, gee, csv, tsv, xml, json, nexgddp</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>connectorUrl</td>
<td style="text-align: center">Url of the data source</td>
<td style="text-align: right">Url</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">Yes (except for gee, nexgddp and json formats)</td>
</tr>
<tr>
<td>tableName</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid table name</td>
<td style="text-align: right">No (just for GEE and nexgddp datasets)</td>
</tr>
<tr>
<td>data</td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present</td>
<td style="text-align: right">JSON</td>
<td style="text-align: right">[{},{},{}]</td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
<tr>
<td>dataPath</td>
<td style="text-align: center">Path to the data in a json dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid JSON key</td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
<tr>
<td>legend</td>
<td style="text-align: center">Legend for dataset. Keys for special fields</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">&ldquo;legend&rdquo;: {&ldquo;long&rdquo;: &ldquo;123&rdquo;, &ldquo;lat&rdquo;: &ldquo;123&rdquo;, &ldquo;country&rdquo;: [&ldquo;pais&rdquo;], &ldquo;region&rdquo;: [&ldquo;barrio&rdquo;], &ldquo;date&rdquo;: [&ldquo;startDate&rdquo;, &ldquo;endDate&rdquo;]}}</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>overwrite</td>
<td style="text-align: center">It allows to overwrite dataset data</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">To set a public or private dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">To generate a verified blockchain of the dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>vocabularies</td>
<td style="text-align: center">Cluster of tags</td>
<td style="text-align: right">Object</td>
<td style="text-align: right"><code class="prettyprint">{&quot;vocabularyOne&quot;: {&quot;tags&quot;: [&lt;tags&gt;]},&quot;vocabularyTwo&quot;: {&quot;tags&quot;: [&lt;tags&gt;]}}</code></td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>widgetRelevantProps</td>
<td style="text-align: center">Group of relevant props of a widget</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>layerRelevantProps</td>
<td style="text-align: center">Group of relevant props of a layer</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>subscribable</td>
<td style="text-align: center">Available dataset queries for subscriptions parameters accepted: <code class="prettyprint">{{begin}}</code> for date begin and <code class="prettyprint">{{end}}</code> for date end</td>
<td style="text-align: right">Object</td>
<td style="text-align: right"><code class="prettyprint">{&quot; &lt;queryname&gt;&quot;: &quot;&lt;querybodytemplate&gt;&quot;}</code></td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
</tbody></table>

<p>There are some differences between datasets types.</p>

<h3 id="carto-datasets">Carto datasets</h3>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "connectorType":"rest",
    "provider":"cartodb",
    "connectorUrl":"&lt;cartoUrl&gt;",
    "application":[
     "your", "apps"
    ],
    "name":"Example Carto Dataset"
}'</span>
</code></pre>
<blockquote>
<p>A real example:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"cartodb",
    "connectorUrl":"https://wri-01.carto.com/tables/wdpa_protected_areas/table",
    "application":[
     "gfw", "forest-atlas"
    ],
    "name":"World Database on Protected Areas -- Global"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h3 id="arcgis-feature-service">ArcGIS feature Service</h3>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"featureservice",
    "connectorUrl":"https://services.arcgis.com/uDTUpUPbk8X8mXwl/arcgis/rest/services/Public_Schools_in_Onondaga_County/FeatureServer/0?f=json",
    "application":[
     "prep"
    ],
    "name":"Uncontrolled Public-Use Airports -- U.S."
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h3 id="google-earth-engine">Google Earth Engine</h3>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"gee",
    "tableName": "JRC/GSW1_0/GlobalSurfaceWater"
    "application":[
     "rw"
    ],
    "name":"Water occurrence"
}'</span>
</code></pre>
<h3 id="nexgddp">NEXGDDP</h3>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"nexgddp",
    "tableName": "historical/ACCESS1_0"
    "application":[
     "rw"
    ],
    "name":"Nexgddp"
}'</span>
</code></pre>
<h3 id="rasdaman">Rasdaman</h3>

<p>The <code class="prettyprint">connectorUrl</code> must be a URL pointing to a valid geotiff file.</p>
<pre class="highlight shell"><code>curl -XPOST <span class="s1">'https://api.resourcewatch.org/v1/dataset'</span> -d <span class="se">\</span>
-H <span class="s1">'Authorization: Bearer &lt;your-token&gt;'</span>  <span class="se">\</span>
-H <span class="s1">'Content-Type: application/json'</span> -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"rasdaman",
    "connectorUrl":"rw.dataset.raw/1508321309784_test_rasdaman_1b.tiff",
    "application":[
     "rw"
    ],
    "name":"rasdaman dataset"
}'</span>
</code></pre>
<h3 id="json-csv-tsv-or-xml">JSON, CSV, TSV or XML</h3>

<p>This dataset hosts data from a file in JSON, CSV, TSV or XML format. When creating the dataset, the data is copied from the provided
source into the API&rsquo;s internal Elasticsearch instance, which is the source used for subsequent queries or other operations.</p>

<p>The original data must be available on a publicly accessible URL, specified in the <code class="prettyprint">connectorUrl</code> field. The URL must be an accessible CSV, TSV or XML file, non-compressed - zip, tar, tar.gz, etc are not supported. The only exception to this rule is when creating a JSON-based dataset, in which case you can instead pass the actual data on the dataset creation request body - see the example below for more details.</p>

<p>Here&rsquo;s a breakdown of the fields specific to the creation of a document-based dataset:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>connectorUrl</td>
<td style="text-align: center"></td>
<td style="text-align: right">Text</td>
<td style="text-align: right">URL</td>
<td style="text-align: right">Yes, unless JSON data is provided using the <code class="prettyprint">data</code> field.</td>
</tr>
<tr>
<td>data</td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">[{},{},{}]</td>
<td style="text-align: right">Yes for JSON if connectorUrl not present</td>
</tr>
<tr>
<td>legend</td>
<td style="text-align: center">See section below</td>
<td style="text-align: right">Object</td>
<td style="text-align: right"></td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<aside class="notice">
When creating a dataset, if any of the fields has a numerical name (for example, column: `3`), a string named `col_` will be appended to the beginning of the name of the column. This way, an uploaded column named `3` will become `col_3`.
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"document",
    "provider":"csv",
    "connectorUrl":"https://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers.csv",
    "application":[
     "gfw"
    ],
    "legend": {
      "lat": "lat",
      "long": "lon"
    },
    "name":"Glad points"
}'</span>
</code></pre>
<blockquote>
<p>Creating a JSON dataset with data provided on the request body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"document",
    "provider":"json",
    "connectorUrl":"",
    "application":[
     "your", "apps"
    ],
    "data": {"myData":[
            {"name":"nameOne", "id":"random1"},
            {"name":"nameTow", "id":"random2"}
          ]},
    "legend": {
      "lat": "lat-column",
      "long": "long-column",
      "date": ["date1Column", "date2Column"],
      "region": ["region1Column", "region2Column"],
      "country": ["country1Column", "country2Column"]
    },
    "name":"Example JSON Dataset"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h4 id="legend">Legend</h4>

<p>By default, the data is ingested by the API and the field types are automatically determined by the underlying Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/mapping.html#_dynamic_mapping">dynamic mapping API</a>.
However, in some scenarios, it may be desirable to specify some or all of these mappings manually, to match each field type to its Elasticsearch equivalent.</p>

<p>When defining manual mappings, you don&rsquo;t need to map every single field. When processing the data, if a field is found for which there isn&rsquo;t a manual mapping, Elasticsearch will fallback to its dynamic mapping algorithm to try and guess that field&rsquo;s type. This API only supports a single explicit mapping per field, meaning you cannot declare a given field as both <code class="prettyprint">text</code> and <code class="prettyprint">keyword</code> for example.</p>

<p>Field mapping can only be defined on dataset creation. Should you want to change these mappings, you can only do so by creating a new dataset with the new mapping structure.</p>

<p>The <code class="prettyprint">legend</code> field allows explicitly identifying the following mappings:</p>

<table><thead>
<tr>
<th>Mapping</th>
<th style="text-align: center">Notes</th>
</tr>
</thead><tbody>
<tr>
<td>lat</td>
<td style="text-align: center">If <code class="prettyprint">lat</code> and <code class="prettyprint">long</code> are both provided, a <code class="prettyprint">the_geom</code> mapping is added</td>
</tr>
<tr>
<td>long</td>
<td style="text-align: center">If <code class="prettyprint">lat</code> and <code class="prettyprint">long</code> are both provided, a <code class="prettyprint">the_geom</code> mapping is added</td>
</tr>
<tr>
<td>date</td>
<td style="text-align: center">Name of columns with date values (ISO Format)</td>
</tr>
<tr>
<td>country</td>
<td style="text-align: center">Name of columns with country values (ISO3 code)</td>
</tr>
<tr>
<td>region</td>
<td style="text-align: center">Name of columns with region values (ISO3 code)</td>
</tr>
<tr>
<td></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>nested</td>
<td style="text-align: center"><a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/nested.html">Nested objects</a> need to be explicitly identified in order to be indexed.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>integer</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>short</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>byte</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>double</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>half_float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>scaled_float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>boolean</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>binary</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>text</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>keyword</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
</tbody></table>

<p>For more details on the characteristics of each of the basic data types, refer to the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/mapping.html#_field_datatypes">Elasticsearch documentation</a>.</p>

<h2 id="uploading-a-dataset-binary">Uploading a Dataset (Binary)</h2>

<p>You can upload your raw data directly to S3 making use of the &ldquo;upload&rdquo; endpoint. This endpoint accepts a file in the property &ldquo;dataset&rdquo; and returns a valid connectorUrl. With this connectorUrl you can create or update a &ldquo;document&rdquo; dataset, or a raster dataset in the Rasdaman adapter.</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/upload <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-F <span class="nv">provider</span><span class="o">=</span>csv,
-F <span class="nv">dataset</span><span class="o">=</span>@&lt;your-file&gt;
</code></pre>
<p>It returns the following information:</p>

<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"connectorUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw.dataset.raw/tmp/upload_75755182b1ceda30abed717f655c077d-observed_temp.csv"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
<span class="s1">'{
    "connectorType":"document",
    "provider":"csv",
    "connectorUrl":"rw.dataset.raw/tmp/upload_75755182b1ceda30abed717f655c077d-observed_temp.csv",
    "application":[
     "your", "apps"
    ],
    "name":"Example RAW Data Dataset"
}'</span>
</code></pre>
<h2 id="updating-a-dataset">Updating a Dataset</h2>

<p>In order to modify the dataset, you can PATCH a request. It accepts the same parameters as the <em>create dataset</em> endpoint, and you will need an authentication token.</p>

<blockquote>
<p>An example update request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
    "name": "Another name for the dataset"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h2 id="deleting-a-dataset">Deleting a Dataset</h2>

<p><strong>When a dataset is deleted the user&rsquo;s applications that were present on the dataset will be removed from it. If this results in a dataset without applications, the dataset itself will be then deleted.</strong></p>

<p>Datasets can be deleted either by with role ADMIN or by the user with role MANAGER that created them. </p>

<p>In order to perform this operation, the following conditions must be met:
- the dataset&rsquo;s <code class="prettyprint">protected</code> property must be set to <code class="prettyprint">false</code>.
- the user must be logged in and belong to the same application as the dataset
- the user must match one of the following:
  - have role <code class="prettyprint">ADMIN</code>
  - have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</p>

<p>Note that the deletion process cascades in a non-atomic way; deleting a dataset will also attempt to remove all the layers, widgets, vocabularies, related knowledge graph elements, and metadata entities associated with it. However, if one of these deletes fails (ie. attempting to delete a protected layer will fail), the dataset will still be deleted, and those resources will be left orphaned.</p>

<aside class="warning">
Deleting a dataset removes it permanently! It is recommended that you save a local copy before doing so.
</aside>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h2 id="cloning-a-dataset">Cloning a Dataset</h2>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/5306fd54-df71-4e20-8b34-2ff464ab28be/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "datasetUrl": "/query/5306fd54-df71-4e20-8b34-2ff464ab28be?sql=select%20%2A%20from%20data%20limit%2010",
    "application": [
      "your",
      "apps"
    ]
  }
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h2 id="concatenate-and-append-data">Concatenate and Append Data</h2>

<p>Using these endpoints, you can add more data to an already existing dataset. You can either provide the URL for the file containing the data you wish to add, or simply provide that data in the body of your request, as a JSON object.</p>

<p>These process are asynchronous and not instantaneous. Immediately when triggered, these requests will cause the dataset&rsquo;s <code class="prettyprint">status</code> to be set to <code class="prettyprint">pending</code>, meaning you will not be able to issue new overwrite, concatenate or append requests. Once the request has been fully processed, the status will be automatically set to <code class="prettyprint">saved</code>. Depending on factors like API load or the size of the data being uploaded, this may take from a few minutes to a few hours to occur. The API does not issue any notification when the asynchronous operation is finished.</p>

<p>In order to perform these operation, the following conditions must be met:</p>

<ul>
<li>the dataset&rsquo;s <code class="prettyprint">overwrite</code> property must be set to <code class="prettyprint">true</code>.</li>
<li>the dataset&rsquo;s <code class="prettyprint">status</code> property must be set to <code class="prettyprint">saved</code>.</li>
<li>the user must be logged in and match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code> and belong to the same application as the dataset</li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<p>While they ultimately achieve a very similar end result, concatenate and append rely on different internal processes, each with its own characteristics.</p>

<ul>
<li>The concatenate process relies on a slower approach to ensure the operation is atomic. Until the operation is completed, you will see the dataset data as it was before the concatenate operation was triggered. If the operation fails, the old version of the data is kept accessible as it was before the concatenation process was started. There&rsquo;s a known issue where concatenating new data to already existing large datasets may result in failure.</li>
<li>The append operation relies on a faster process that does not offer atomicity. The new data is simply added to the current dataset, and any queries done while this process is taking place may produce results based on the preexisting data mixed with parts of the newly added values. Should the operation fail halfway, your dataset may contain all the preexisting records as well as part (but not all) of the newly added ones. </li>
</ul>

<blockquote>
<p>Concatenate data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/concat <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "connectorUrl":"&lt;csvUrl&gt;",
    "dataPath": "data... etc"
}'</span>
</code></pre>
<blockquote>
<p>Append data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/append <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "connectorUrl":"&lt;csvUrl&gt;",
    "dataPath": "data... etc"
}'</span>
</code></pre>
<blockquote>
<p>Concatenate data using JSON array in post body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/concat <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "data": [{},{}]
}'</span>
</code></pre>
<aside class="notice">
    These are authenticated endpoints.
</aside>

<h2 id="overwrite-data">Overwrite Data</h2>

<p>Using this endpoint, you can add completely replace the data of an already existing dataset. All previously existing data will be permanently deleted. You can either provide the URL for the file containing the data you wish to add, or simply provide that data in the body of your request, as a JSON object.</p>

<p>This process is asynchronous and not instantaneous. Immediately when triggered, this request will cause the dataset&rsquo;s <code class="prettyprint">status</code> to be set to <code class="prettyprint">pending</code>, meaning you will not be able to issue new overwrite or concat requests, and will not yet be able to access the new data yet. Once the request has been fully processed, the status will be automatically set to <code class="prettyprint">saved</code> and the new data will be accessible. Depending on factors like API load or the size of the data being uploaded, this may take from a few minutes to a few hours to occur. The API does not issue any notification when the asynchronous operation is finished.</p>

<p>In order to perform this operation, the following conditions must be met:
- the dataset&rsquo;s <code class="prettyprint">overwrite</code> property must be set to <code class="prettyprint">true</code>.
- the dataset&rsquo;s <code class="prettyprint">status</code> property must be set to <code class="prettyprint">saved</code>.
- the user must be logged in and match one of the following:
  - have role <code class="prettyprint">ADMIN</code> and belong to the same application as the dataset
  - have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</p>

<blockquote>
<p>Overwrite data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/data-overwrite <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
   "url":"&lt;url&gt;",
   "provider": "csv"
}'</span>
</code></pre>
<blockquote>
<p>Overwrite data using JSON array in post body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/data-overwrite <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
   "data": [{},{}],
   "provider": "csv"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<p>Who can use this endpoint?</p>

<ul>
<li><strong>MANAGER</strong> users who are included in the <code class="prettyprint">userId</code> field of the dataset entity.</li>
<li><strong>ADMIN</strong> users who belong to <strong>at least one of the dataset&rsquo;s applications</strong>.</li>
</ul>

<h2 id="dataset-data-sync">Dataset data sync</h2>

<p>To sync the data of a dataset, you need to choose the action type (concat or overwrite), a cron pattern and a valid url. This configuration should be set in the &#39;sync&rsquo; property when creating or updating a document dataset.</p>

<p>Please be sure that the &#39;overwrite&rsquo; property is set to true. This could be used as a lock in order to not allow new updates even if the sync task is actually created.</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
<span class="s1">'{
    "connectorType":"document",
    "provider":"csv",
    "connectorUrl":"&lt;csvUrl&gt;",
    "application":[
     "your", "apps"
    ],
    "name":"Example SYNC Dataset",
    "overwrite": true,
    "sync": {
        "action":"concat",
        "cronPattern":"0 * * * * *",
        "url":"&lt;updateCsvUrl&gt;"
    }
}'</span>
</code></pre>
          <h1 id="widget">Widget</h1>

<h2 id="what-is-a-widget">What is a Widget?</h2>

<p>A widget is a graphic representation of a Dataset&rsquo;s data. Most of them are defined with <a href="#what-is-vega">Vega grammar</a> but we can also find other custom definitions. Here are the <a href="https://github.com/resource-watch/notebooks/blob/develop/ResourceWatch/Api_definition/widget_definition.ipynb">RW widgets definitions</a>.</p>

<p>Widgets contain the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>slug</td>
<td style="text-align: center">Unique identifier of the widget</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the widget</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset that the widget belongs</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template (base schema to create other widgets)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s a default widget for the dataset that it belongs</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected widget (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Status of the Widget</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment can be one of <code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code>. <em>By default, it&rsquo;s set to &ldquo;production&rdquo; unless specified otherwise on creation/update</em></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>thumbnailUrl</td>
<td style="text-align: center">Url of the widget&rsquo;s thumbnail, if one exists</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Date in which the widget was created</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Date in which the widget was last updated</td>
<td style="text-align: right">Date</td>
</tr>
</tbody></table>

<h3 id="what-is-vega">What is Vega?</h3>

<p>Vega is a visualization grammar; a declarative format for creating, saving and sharing interactive visualization designs. This wiki contains documentation and learning materials for getting up and running with Vega. <a href="https://github.com/vega/vega/wiki">More info</a></p>

<h2 id="how-obtain-a-single-widget">How obtain a single widget</h2>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="customize-the-query-url-of-a-widget">Customize the query url of a widget</h3>

<p>The <code class="prettyprint">queryUrl</code> query parameter can be set if the user needs to modify the final url that will be requested. All parameters indicated in the <code class="prettyprint">queryUrl</code> will be pass to the microservice.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/049f074a-3528-427d-922b-3c2320e9caf6?queryUrl<span class="o">=</span>/v1/query?sql<span class="o">=</span>Select%20<span class="k">*</span>%20from%20data&amp;geostore<span class="o">=</span>ungeostore
</code></pre>
<h2 id="how-to-obtain-all-widgets">How to obtain all widgets</h2>

<p>To obtain all widgets:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<aside class="success">
Remember — <strong>the resulting list is filtered by env=production</strong> unless another env is explicitly provided as a query param. <i>A list of environments can also be provided such as e.g. &ldquo;env=production,preproduction&rdquo;</i>.
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"8f67fadd-d8df-4a28-82dd-a22a337d71b9"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:[</span><span class="w">
               </span><span class="s2">"aqueduct"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="s2">"percentage-of-country-s-population-is-at-high-risk-of-hunger"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Percentage of country's population at high risk of hunger."</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="s2">"f1d24950-c764-4f90-950a-4541f798eb95"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="s2">"query/f1d24950-c764-4f90-950a-4541f798eb95?sql=select * from crops"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:{</span><span class="w">
                </span><span class="err">...</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="kc">false</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"first"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prev"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=2&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=64&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1&amp;page%5Bsize%5D=10"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">372</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Available filters parameters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Filter the widgets whose name contains the filter text</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">Filter the widgets by dataset uuid</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align: center">Sort json response by specific attributes</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Filter widgets on status (pending, saved, failed, all)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter widgets on published status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter widgets on freeze status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">Filter by verified status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">Filter by template status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">Filter by default status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>app</td>
<td style="text-align: center">Filter widgets on application (prep, gfw, etc..)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment can be one of <code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the widgets filtered whose name contains glad</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?name<span class="o">=</span>glad
</code></pre>
<blockquote>
<p>Return the widgets filtered by dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?dataset<span class="o">=</span>d02df2f6-d80c-4274-bb6f-f062061655c4
curl -X GET https://api.resourcewatch.org/v1/dataset/d02df2f6-d80c-4274-bb6f-f062061655c4/widget
</code></pre>
<blockquote>
<p>Sort by name</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Filter widgets by status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?status<span class="o">=</span>failed
</code></pre>
<blockquote>
<p>Filter widgets by published status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?published<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Filter widgets by verified status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?verified<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Return the widgets filtered by template</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?template<span class="o">=</span><span class="nb">true</span>
</code></pre>
<blockquote>
<p>Filter widgets by default option</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?default<span class="o">=</span><span class="nb">true</span>
</code></pre>
<blockquote>
<p>Return widgets whose applications contain rw</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?app<span class="o">=</span>rw
</code></pre>
<h3 id="pagination-params">Pagination params</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">Number elements per page</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">Number of page</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the widgets from page 2, with 5 elements per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?page[size]<span class="o">=</span>5&amp;page[number]<span class="o">=</span>2
</code></pre>
<h2 id="how-to-obtain-a-widget-for-a-specific-dataset">How to obtain a widget for a specific dataset</h2>

<p>To obtain the widget:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/d02df2f6-d80c-4274-bb6f-f062061655c4/widget/20ec7861-5251-40a7-9503-5ee3686a66a3
curl -X GET https://api.resourcewatch.org/v1/widget/20ec7861-5251-40a7-9503-5ee3686a66a3
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20ec7861-5251-40a7-9503-5ee3686a66a3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57a0693b49c36b265ba3bec8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"rw"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"estimated-c02-emission"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Estimated C02 emission"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d02df2f6-d80c-4274-bb6f-f062061655c4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"query/d02df2f6-d80c-4274-bb6f-f062061655c4?sql=select country, rank, iso3, total from estimated_co2_emission_filtered"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"scales"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"padding"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"top"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
          </span><span class="s2">"left"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
          </span><span class="s2">"right"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
          </span><span class="s2">"bottom"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-17T17:50:45.655Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-06T15:12:38.749Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="create-a-widget">Create a Widget</h2>

<p>To create a widget, you need to define all of the required fields in the request body. The fields that compose a widget are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the widget belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid query</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Vega configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Status of the Widget</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">1</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected widget (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s default for dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of layer</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a widget, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "widget": {
      "application":[
         "your", "apps"
      ],
      "name":"Example Carto Dataset"
      "status": 1,
      "published": true
   }
}'</span>
</code></pre>
<aside class="notice">
Creating a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="update-a-widget">Update a Widget</h2>

<p>To update a widget, you need to define all of the required fields in the request body. The fields that compose a widget are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the widget belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid query</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Vega configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Status of the Widget</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">1</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s default for dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of layer</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment</td>
<td style="text-align: right">Text</td>
<td style="text-align: right"><code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<p>A user with role <code class="prettyprint">USER</code> can update their own widgets, based on the <code class="prettyprint">userId</code> field. A user with <code class="prettyprint">ADMIN</code> role can update any widget.</p>

<blockquote>
<p>To update a widget, you have to do a PATCH request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "widget": {
      "application":[
         "your", "apps"
      ],
      "name":"New Example Carto Dataset Name",
      "widgetConfig": {}
   }
}'</span>
</code></pre>
<aside class="notice">
Updating a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="clone-a-widget">Clone a Widget</h2>

<p>You can clone an existing widget as long as you have permissions to the applications associated with it. Basic usage requires no body params, but you can optionally pass a new <code class="prettyprint">name</code> or <code class="prettyprint">description</code> to be used in the creation of the new widget.</p>

<blockquote>
<p>To clone a widget, you should use one of the following POST requests:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<blockquote>
<p>You can optionally set a new name or description:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "name for the cloned widget",
   "description": "
   "name": "name for the cloned widget", for the cloned widget",
}'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "name for the cloned widget",
   "description": "
   "name": "name for the cloned widget", for the cloned widget",
}'</span>
</code></pre>
<h3 id="cloning-widgets-from-other-microservices">Cloning widgets from other microservices</h3>

<p>When cloning a widget, the newly created clone will take the <code class="prettyprint">userId</code> of the originating request. If you call this endpoint as an authenticated user from your custom application, that means it will get that authenticated user&rsquo;s <code class="prettyprint">userId</code>. However, if invoked from another API microservice, that <code class="prettyprint">userId</code> is no longer available. In this scenario, when the request to clone is originated internally, you can optionally pass a <code class="prettyprint">userÌd</code> body value that will be set as the <code class="prettyprint">userId</code> of the newly created widget.</p>

<aside class="warning">
User IDs provided this way are not validated.
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;microservice-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "userId": "123456789",
}'</span>
</code></pre>
<aside class="notice">
Cloning a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="delete-a-widget">Delete a Widget</h2>

<p>Who can delete Widgets?</p>

<ul>
<li>Users with the <code class="prettyprint">MANAGER</code> role who are in the same app as the widget and are in the widget&rsquo;s <code class="prettyprint">userId</code></li>
<li>Users with the <code class="prettyprint">ADMIN</code> role who are in the same app as the widget.</li>
</ul>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="layer">Layer</h1>

<h2 id="what-is-a-layer">What is a Layer?</h2>

<p>A layer is a geographical representation of a Dataset&rsquo;s data.</p>

<p>Layer contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>slug</td>
<td style="text-align: center">Unique identifier of the layer</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the layer</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset that the layer belongs</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s a default layer for the dataset that it belongs</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Is the layer published?</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">environment in witch the layer was published, one of <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<h2 id="how-obtain-all-layers">How obtain all layers</h2>

<p>To obtain all layers:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"rw"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
              </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
              </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"first"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prev"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=2&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=64&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1&amp;page%5Bsize%5D=10"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">628</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="filter-params">Filter params</h3>

<p>Available filters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Filter the layers whose name contains the filter text</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">Filter the layers by dataset uuid</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align: center">Sort json response by specific attributes</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Filter layers on status (pending, saved, failed, all)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter layers on published status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>app</td>
<td style="text-align: center">Filter layers on application (prep, gfw, etc..)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment in witch the layer was published, one of <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers filtered by those whose name contains emissions</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?name<span class="o">=</span>emissions
</code></pre>
<blockquote>
<p>Return the layers filtered by dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?dataset<span class="o">=</span>11de2bc1-368b-42ed-a207-aaff8ece752b
curl -X GET https://api.resourcewatch.org/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer
</code></pre>
<blockquote>
<p>Sort by name</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Filter layers by status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?status<span class="o">=</span>failed
</code></pre>
<blockquote>
<p>Filter layers by published status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?published<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Return the layers filtered by those whose applications contain rw</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?app<span class="o">=</span>rw
</code></pre>
<h3 id="pagination-params">Pagination params</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">Number elements per page</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">Number of page</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers of page 2 with 5 elements per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?page[size]<span class="o">=</span>5&amp;page[number]<span class="o">=</span>2
</code></pre>
<h2 id="how-obtain-a-layer-for-specific-dataset">How obtain a layer for specific dataset</h2>

<p>To obtain the layer:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
curl -X GET https://api.resourcewatch.org/v1/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"rw"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
          </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
      </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="create-a-layer">Create a Layer</h2>

<p>To create a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration, <a href="https://github.com/resource-watch/notebooks/blob/develop/ResourceWatch/Api_definition/layer_definition.ipynb">rw definition example</a></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">Isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true-false</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a layer, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "application":[
       "your", "apps"
    ],
    "name":"Example layer",
    "status": 1
}'</span>
</code></pre>
<blockquote>
<p>The following structure was previously supported but should now be considered deprecated:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"Example layer",
      "status": 1
   }
}'</span>
</code></pre>
<h2 id="update-a-layer">Update a Layer</h2>

<p>To update a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a layer, you have to do a POST requestwith the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"New Example layer Name",
      "layerConfig": {}
   }
}'</span>
</code></pre>
<h2 id="delete-a-layer">Delete a Layer</h2>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="query">Query</h1>

<p>In order to retrieve data from the datasets it is possible to send queries to the API using the SQL or Feature Service languages.</p>

<p>Two different endpoints are provided (under the dataset path and a generic one) and the sql query can be provided via query parameters or in the body of a POST request.</p>
<pre class="highlight shell"><code>curl -i -H <span class="s1">'Authorization: Bearer your-token&gt;'</span> -H <span class="s1">'Content-Type: application/json'</span> -XPOST <span class="s1">'http://api.resourcewatch.org/v1/query/&lt;dataset_id&gt;/'</span> -d <span class="s1">'{
    "sql": "SELECT * FROM &lt;dataset_id&gt; limit 10"
}
'</span>
</code></pre><pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;
</code></pre>
<aside class="notice">
While we aim to make our query interface as broad and transparent as possible, some of the querying options described 
below will not be available for specific dataset providers, depending on this API&rsquo;s implementation or limitations on the
actual data provider&rsquo;s side.
</aside>

<h2 id="select-clause">Select clause</h2>

<p>The <code class="prettyprint">SELECT</code> part of the queries supports naming columns, <strong>alias</strong>, <strong>math operations</strong>, <strong>DISTINCT</strong>, <strong>COUNT</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">as</span> <span class="n">minimum</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="from-clause">From clause</h2>

<p>It is possible to refer to a dataset by using its <strong>table name</strong>, <strong>slug</strong> or <strong>id</strong>. </p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">tableName</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">slug</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">id</span><span class="o">&gt;</span>
</code></pre>
<h2 id="where-clause">Where clause</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">text</span> <span class="k">like</span> <span class="s1">'a%'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">st_intersects</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="s1">'{}'</span><span class="p">),</span> <span class="mi">4326</span><span class="p">),</span> <span class="n">the_geom</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="k">data</span> <span class="k">BETWEEN</span> <span class="mi">1</span> <span class="k">AND</span> <span class="mi">3</span>
</code></pre>
<h2 id="group-by-clause">Group by clause</h2>

<p>It is possible to group results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong>.
Special grouping operations are available for document-type datasets (CSV and JSON) - see <a href="https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql">this link</a> for more info.</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span><span class="p">,</span> <span class="n">columnTwo</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom_point</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">a</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</code></pre><pre class="highlight sql"><code><span class="cm">/* Only supported in document-type datasets - see https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql for full details */</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">range</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span> 
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_histogram</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'interval'</span><span class="o">=</span><span class="s1">'1d'</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_range</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'format'</span><span class="o">=</span><span class="s1">'yyyy-MM-dd'</span> <span class="p">,</span><span class="s1">'2014-08-18'</span><span class="p">,</span><span class="s1">'2014-08-17'</span><span class="p">,</span><span class="s1">'now-8d'</span><span class="p">,</span><span class="s1">'now-7d'</span><span class="p">,</span><span class="s1">'now-6d'</span><span class="p">,</span><span class="s1">'now'</span><span class="p">)</span>
</code></pre>
<h2 id="order-by-clause">Order by clause</h2>

<p>It is possible to order results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>

<h2 id="limit-and-offset-clause">Limit and offset clause</h2>

<p>You can specify <code class="prettyprint">limit</code> and <code class="prettyprint">offset</code> clauses</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span> <span class="k">offset</span> <span class="mi">10</span>
</code></pre>
<h2 id="raster-queries-available">Raster queries available</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="n">ST_METADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_BANDMETADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="n">occurrence</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_SUMMARYSTATS</span><span class="p">()</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_HISTOGRAM</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="freeze-query">Freeze query</h2>

<p>It is possible generate a json file in a bucket of the sql result. You only need send a query param freeze with value true and you will obtain the url of the json file.</p>

<aside class="notice">
    This is an authenticated feature!
</aside>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;&amp;freeze<span class="o">=</span><span class="nb">true</span>
</code></pre>
<h2 id="rasdaman-queries">Rasdaman queries</h2>

<p>SQL-like queries can be employed for accessing data stored in Rasdaman datasets. Subsets on the original axes of the data may be provided in the WHERE statement. So far, only operations that result in a single scalar can be obtained from Rasdaman - averages, minimums, maximums.</p>
<pre class="highlight shell"><code>curl -XGET https://api.resourcewatch.org/v1/query?sql<span class="o">=</span>SELECT avg<span class="o">(</span>Green<span class="o">)</span> from 18c0b71d-2f55-4a45-9e5b-c35db3ebfe94 where Lat &gt; 0 and  Lat &lt; 45 <span class="se">\</span>
    -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'Authorization: Bearer &lt;token&gt;'</span>
</code></pre>
<h2 id="nex-gddp-queries">NEX-GDDP queries</h2>

<p>A SQL wrapper is offered for accessing the NASA NEX-GDDP dataset with sql-like statements. The API stores calculated indexes over the original data, and several views over the data are available. These can be accessed in the following ways:</p>

<h3 id="spatial-aggregates-over-a-layer">Spatial aggregates over a layer</h3>

<p>Access spatial aggregates over the data by listing all dataset data for a particular year:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ </span>where<span class="se">\ </span>year<span class="se">\ \=\ </span>1960
</code></pre>
<p>Access particular aggregates:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ </span>avg<span class="se">\,\ </span>min<span class="se">\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ </span>where<span class="se">\ </span>year<span class="se">\ \=\ </span>1960
</code></pre>
<p>Calculate statistics for a range of years:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ \ </span>where<span class="se">\ </span>year<span class="se">\ </span>between<span class="se">\ </span>1960<span class="se">\ </span>and<span class="se">\ </span>1962
</code></pre>
<p>You can delimit an area of interest by providing a geostore id as a parameter:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ \ </span>where<span class="se">\ </span>year<span class="se">\ </span>between<span class="se">\ </span>1960<span class="se">\ </span>and<span class="se">\ </span>1962&amp;geostore<span class="se">\=</span>0279093c278a64f4c3348ff63e4cfce0
</code></pre>
<h2 id="download">Download</h2>

<p>You can download the result of a query using the <code class="prettyprint">download</code> endpoint. </p>

<aside class="warning">
    <ul>
    This endpoint is not supported for all the dataset providers. The following dataset connector provide support for downloads:
        <li>Google Earth Engine</li>
        <li>Document</li>
        <li>Carto</li>
        <li>BigQuery</li>
        <li>ArcGIS FeatureService</li>
    </ul>
</aside>
<pre class="highlight shell"><code><span class="c"># The id of the dataset is part of the URL</span>
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;

<span class="c"># The id of the dataset is in the FROM clause</span>
curl -XGET https://api.resourcewatch.org/v1/download?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.id&gt;
</code></pre>
<p>There are two ways to call it:</p>

<ul>
<li>you can either specify the id of the dataset in the URL</li>
<li>or you can pass it as part of the SQL query (in the FROM clause)</li>
</ul>

<p>You can also specify which file type you want to download (JSON or CSV), except for Google Earth Engine datasets (only JSON).</p>

<aside class="notice">
    By default, the API will return a CSV file (JSON file for Google Earth Engine).
</aside>
<pre class="highlight shell"><code><span class="c"># The format is explicitly set</span>
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>json
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>csv
</code></pre>
          <h1 id="fields">Fields</h1>

<h2 id="what-are-fields">What are fields?</h2>

<p>Fields can be defined as the dataset properties. These fields are automatically generated when a dataset is created.</p>

<h2 id="how-to-get-the-dataset-fields">How to get the dataset fields</h2>

<p>Once the dataset is properly created and saved, it is possible to access to its fields as well as getting some information about them.</p>

<p>To do that, it is necessary to use of the following endpoint:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/fields/&lt;dataset-id&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/fields/1170030b-9725-4bfe-8fb4-1b0eb81020d2
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"public.cait_2_0_country_ghg_emissions_toplow2011"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"cartodb_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom_webmercator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="rasdaman">Rasdaman</h3>

<p>The structure of datacubes needs a more verbose field specification. The fields endpoint for rasdaman-backed datasets includes information on the spatial reference system, nodata values, axes, units, and bands. It looks like so:</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell"><code>curl -i  -XGET <span class="s1">'http://api.resourcewatch.org/v1/fields/491ae6fe-6767-44d1-b5c3-c7b8b384bb7a'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"coverageId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nightlights"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"srs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"srsDimension"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"srs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"crs/EPSG/0/4326"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"axisLabels"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lat Long"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uomLabels"</span><span class="p">:</span><span class="w"> </span><span class="s2">"degree degree"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"undefined"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"swe:nilValues"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"swe:NilValues"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"swe:nilValue"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
              </span><span class="s2">"$t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
              </span><span class="s2">"$t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"swe:uom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10^0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"coverageBounds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"upperCorner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"89.999999999966665 180.000000000189335"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lowerCorner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-89.999999999961335 -179.999999999666665"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="metadata">Metadata</h1>

<h2 id="metadata-definition">Metadata definition</h2>

<p>Metadata can be any kind of data associated to an existing resource (i.e. Dataset, Layer or Widget). Note that, although there might be several metadata per resource, each resource will have - at most - one metadata element per <code class="prettyprint">application</code> and <code class="prettyprint">language</code> pair. As such, the <code class="prettyprint">application</code> and <code class="prettyprint">language</code> attributes are required and it is mandatory to include them in when creating/updating metadata.</p>

<p>Some fields are important to identify the entity properly; others are just optional and give extra information about it.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">The metadata application</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">The metadata language</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">The associated dataset id to the metadata</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>resource</td>
<td style="text-align: center">The resource associated to the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; id</td>
<td style="text-align: center">Resource id</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Resource type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">The metadata name</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">The metadata description</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">The metadata source</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">The metadata citation</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">The metadata license type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">Some info about the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">Measurement units</td>
<td style="text-align: right">Object</td>
</tr>
</tbody></table>

<h2 id="creating-a-metadata-object">Creating a metadata object</h2>

<p>Only <code class="prettyprint">ADMIN</code>s and <code class="prettyprint">MANAGER</code>s can create metadata for an app (as long as they belong to that app).</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Required/Optional</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">optional</td>
</tr>
</tbody></table>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the payload.</p>

<aside class="notice">
Please, be sure that the request is properly authenticated and the current user has permission to the resource.
If you don&rsquo;t know how to do this, please go to the <a href="#authentication">Authentication section</a>
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "rw",
   "language": "en"
  }'</span>
</code></pre>
<blockquote>
<p>Response: 200 OK HTTP RESPONSE + JSON-API-LIKE BODY</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>It could respond with a <strong>401</strong> status code if the request is not authenticated, <strong>403</strong> if the request is not allowed to do that operation,
<strong>400</strong> if the request is not well formatted, or <strong>5XX</strong> HTTP codes in other cases.</p>

<p>The same operation applies to Widget and Layer just changing the endpoint for the appropriate one.</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<h2 id="getting-metadata">Getting metadata</h2>

<p>application filter:
<code class="prettyprint">
application: gfw, gfw-climate, prep, rw, forest-atlas (select one or some of them)
</code></p>

<p>language filter:
<code class="prettyprint">
language: select between available languages (select one or some of them)
</code></p>

<p>limit filter:
<code class="prettyprint">
limit: the desired number
</code></p>

<p>Custom param for /metadata endpoint:
<code class="prettyprint">
type: [dataset, widget, layer]
</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/metadata
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata
</code></pre>
<h2 id="updating-a-metadata">Updating a metadata</h2>

<p>Partial update:</p>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the payload.</p>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "rw",
   "language": "en",
   "name": "Cloud Computing Market - USA - 2016",
   "source": "http://www.forbes.com/",
   "info": {
       "summary": "These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales).",
       "author": "Louis Columbus",
       "date": "MAR 13, 2016 @ 10:42 PM",
       "link": "http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"
   }
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="deleting-a-metadata">Deleting a metadata</h2>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the query params.</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata?application<span class="o">=</span>&lt;app-id&gt;&amp;language<span class="o">=</span>&lt;language&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata?application<span class="o">=</span>rw&amp;language<span class="o">=</span>en <span class="se">\</span>
</code></pre>
<h2 id="getting-all">Getting all</h2>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata
</code></pre>
<blockquote>
<p>Real examples</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?type<span class="o">=</span>widget
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?application<span class="o">=</span>rw&amp;language<span class="o">=</span>es,en&amp;limit<span class="o">=</span>20
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?application<span class="o">=</span>rw,gfw&amp;language<span class="o">=</span>en&amp;type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?language<span class="o">=</span>en
</code></pre>
<h2 id="finding-getting-by-ids">Finding (getting) by ids</h2>

<p>The &ldquo;ids&rdquo; property is required in the payload, and in other case the endpoint responds with a 400 HTTP ERROR (Bad Request)
This property can be an Array or a String (comma-separated)
payload -&gt; {&ldquo;ids&rdquo;: [&ldquo;112313&rdquo;, &ldquo;111123&rdquo;]}
payload -&gt; {&ldquo;ids&rdquo;: &ldquo;112313, 111123&rdquo;}</p>

<p>application filter:
<code class="prettyprint">
application: gfw, gfw-climate, prep, rw, forest-atlas (select one or some of them)
</code></p>

<p>language filter:
<code class="prettyprint">
language: select between available languages (select one or some of them)
</code></p>

<p>limit filter:
<code class="prettyprint">
limit: the desired number
</code></p>

<p>Custom param for the metadata endpoint:
<code class="prettyprint">
type: [dataset, widget, layer]
</code></p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
     "ids": "b000288d-7037-43ba-aa34-165eab549613, 942b3f38-9504-4273-af51-0440170ffc86"
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613-dataset-b000288d-7037-43ba-aa34-165eab549613-prep-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prep"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already “locked in” due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2°F to +5.9°F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
        </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"organization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe Casola, University of Washington"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already “locked in” due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2°F to +5.9°F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"short-description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change in the Puget Sound Lowlands relative to average temperature between 1950-2005. Light colored lines in the background show the range of projections. All climate scenarios project warming for the Puget Sound region during the 21st century."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
          </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:02:28.337Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:03:02.445Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="vocabulary-and-tags">Vocabulary (and Tags)</h1>

<h2 id="tags-definition">Tags definition</h2>

<p>A way to categorize a resource within a vocabulary context.</p>

<h2 id="vocabulary-definition">Vocabulary definition</h2>

<p>The Vocabulary can be described as a cluster of tags.</p>

<p>It is currently possible to just create a Vocabulary without any tags or relationships.
To do it, the only parameter that is required is the name of the Vocabulary.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">The name of the Vocabulary (<strong>it has to be unique and it represents the &ldquo;primaryKey&rdquo;</strong>)</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">The associated application for this vocabulary</td>
<td style="text-align: right">String</td>
</tr>
</tbody></table>

<p>However, the most common use case relies on the relationships creation.</p>

<h2 id="relationships">Relationships</h2>

<p>This section describes how to associate an existing or new Vocabulary to a resource.</p>

<p>Some important points:</p>

<ul>
<li>A <strong>Vocabulary</strong> can have <strong>N</strong> associated <strong>Resources</strong>.</li>
<li>A <strong>Resource</strong> can have <strong>M</strong> associated <strong>Vocabularies</strong>.</li>
<li>The way of building these <strong>relationships</strong> is creating <strong>Tags</strong>.</li>
</ul>

<h2 id="assign-a-vocabulary-to-an-existing-resource">Assign a Vocabulary to an existing Resource</h2>

<p>To create a relationship between a resource and a Vocabulary (even if the vocabulary doesn&rsquo;t exist yet) it is only required that you set the tags that define the relationship.</p>

<p>Some writing operations can take a little more time than reading ones. Even if the relationships are not strong, the writing operations have to ensure consistency along entities.</p>

<aside class="notice">
Please, be sure that the request is properly authenticated and the current user has permission to the resource.
If you don&rsquo;t know how to do this, please go to the <a href="#authentication">Authentication section</a>
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": ["biology", "chemistry"]
  }'</span>
</code></pre>
<blockquote>
<p>real Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"science"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="updating-tags-of-an-existing-relationship">Updating Tags of an existing relationship</h2>

<p>If a relationship has to be updated, it&rsquo;s necessary to define it&rsquo;s new tags.
The previous tags will be deleted in benefit of the new ones.</p>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": ["maths", "astronomy"]
  }'</span>
</code></pre>
<blockquote>
<p>response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"science"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"maths"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"astronomy"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="creating-several-relationships">Creating several relationships</h2>

<p>There is also an endpoint that allows you to create some relationships in the same request.</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "vocabularyOne": {
   "application": &lt;application&gt;,
       "tags": [&lt;tags&gt;]
   },
   "vocabularyTwo": {
   "application": &lt;application&gt;,
       "tags": [&lt;tags&gt;]
   }
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary<span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "vocabularyOne": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  },
  "vocabularyTwo": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  }
 }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "vocabularyOne": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  },
  "vocabularyTwo": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  }
 }'</span>
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary?application<span class="o">=</span>&lt;application&gt;
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
     "country": {
         "tags": ["Spain", "Italy", "Portugal"]
     },
     "sport": {
         "tags": ["football", "basketball", "voleyball"]
     },
     "color": {
         "tags": ["red", "green", "blue"]
     }
  }'</span>
</code></pre>
<blockquote>
<p>response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameTwo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"newV"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"test1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"test2"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sport"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"football"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"basketball"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"voleyball"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="deleting-relationships">Deleting relationships</h2>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre><pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre><pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
</code></pre>
<blockquote>
<p>response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="getting-vocabularies-associated-to-a-resource">Getting vocabularies associated to a resource</h2>

<p>You can be request all vocabularies that are associated to a particular resource.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary
</code></pre>
<blockquote>
<p>response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="getting-a-single-relationship-broken-now">Getting a single relationship (broken now)</h2>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<h2 id="getting-resources-common-use-case">Getting resources (COMMON USE CASE)</h2>

<p>There is also an endpoint available which accepts requests just indicating resource type and
the desired vocabulary-tag matching.</p>

<p>It currently supports DOUBLE-OR pattern matching, meaning the API will return
all resources that at least have one (or more) tags in a particular vocabulary. At the same time it will also apply an OR to the entities of other vocabulary-tag matchings.</p>

<p>The query has to be set in the url by the query params.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/vocabulary/find
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/vocabulary/find
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/vocabulary/find
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET http://api.resourcewatch.org/v1/dataset/vocabulary/find?legacy<span class="o">=</span>cdi,coasts
</code></pre>
<h2 id="getting-all-vocabularies">Getting all vocabularies</h2>

<p>This endpoint is quite useful to have a quick overview of all existing vocabularies and resources.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/vocabulary
</code></pre>
<h2 id="finding-getting-by-ids">Finding (getting) by ids</h2>

<p>The &ldquo;ids&rdquo; property is required in the payload. In other cases the endpoint responds with a 400 HTTP ERROR (Bad Request)
This property can be an Array or a String (comma-separated)
payload -&gt; {&ldquo;ids&rdquo;: [&ldquo;112313&rdquo;, &ldquo;111123&rdquo;]}
payload -&gt; {&ldquo;ids&rdquo;: &ldquo;112313, 111123&rdquo;}</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "ids": "942b3f38-9504-4273-af51-0440170ffc86, 08ff8183-48dc-457a-8924-bb4e7a87b8a8"
  }'</span>
</code></pre>
<blockquote>
<p>response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"resource"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"08ff8183-48dc-457a-8924-bb4e7a87b8a8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"legacy"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"cdi"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"inundation"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"national"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"united states"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"local"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"coasts"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"flooding"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"health"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"resource"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="vocabulary-creation">Vocabulary Creation</h2>

<p>As was mentioned before, it is possible to just create a new and empty vocabulary</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/vocabulary/vocabularyName <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;application&gt;,
   "name": &lt;vocabularyName&gt;
  }'</span>
</code></pre>
<p>It is also possible to update and delete an entire vocabulary. Said that, because
it&rsquo;s necessary to keep consistency between entities with weak relationship, these
operations are only available to SUPERADMINS.</p>

          <h1 id="geostore">Geostore</h1>

<h2 id="what-is-geostore">What is Geostore?</h2>

<p>Geostore is a geojson database. You can save your geojson or obtain geojson by country, region, Protected areas, etc.</p>

<p>Geostore object contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td style="text-align: center">Id of the geostore</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with the geometry</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>hash</td>
<td style="text-align: center">MD5 hash generated from geojson. Is the same that the id</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>provider</td>
<td style="text-align: center">This field should be completed if the geostore was created from a provider</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. It is possible use AND &amp; OR conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>areaHa</td>
<td style="text-align: center">Area in Hectares of the geojson</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>bbox</td>
<td style="text-align: center">Bounding box of the geojson</td>
<td style="text-align: right">Array</td>
</tr>
</tbody></table>

<aside class="notice">
Remember — All endpoint of geostore don&rsquo;t need that you are authenticated.
</aside>

<h2 id="create-geostore">Create Geostore</h2>

<p>You can create a geostore in 4 different ways:</p>

<h3 id="with-a-geojson">With a Geojson</h3>

<p>If you have your own geojson, you can save it in geostore. To create the geostore, you need to define all the required fields in the request body. The fields that compose a geostore are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with your geometry</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a Geostore, you have to do a POST query with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson": &lt;yourGeoJSONObject&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson":{
      "type":"FeatureCollection",
      "features":[
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"LineString",
               "coordinates":[
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ],
                  [
                     -3.995418548583985,
                     41.03767166215326
                  ],
                  [
                     -3.9842605590820312,
                     41.03844854003296
                  ],
                  [
                     -3.9844322204589844,
                     41.04589315472392
                  ],
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ]
               ]
            }
         },
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"Polygon",
               "coordinates":[
                  [
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ]
                  ]
               ]
            }
         }
      ]
   }
}'</span>
</code></pre>
<p>The response will be 200 if the geostore saves correctly and returns the geostore object with all information:</p>

<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"geojson"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"features"</span><span class="p">:[</span><span class="w">
               </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"geometry"</span><span class="p">:{</span><span class="w">
                     </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Polygon"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"coordinates"</span><span class="p">:[</span><span class="w">
                        </span><span class="p">[</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">]</span><span class="w">
                        </span><span class="p">]</span><span class="w">
                     </span><span class="p">]</span><span class="w">
                  </span><span class="p">}</span><span class="w">
               </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"crs"</span><span class="p">:{</span><span class="w">

            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"FeatureCollection"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"hash"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"provider"</span><span class="p">:{</span><span class="w">

         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="mf">397372.34122605197</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bbox"</span><span class="p">:[</span><span class="w">
            </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
            </span><span class="mf">40.84706035607122</span><span class="p">,</span><span class="w">
            </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
            </span><span class="mf">41.30257109430557</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country">From country</h3>

<p>If you need obtain the geostore of a country, you can obtain it with the ISO3 code in the Geostore API.</p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Spain
<code class="prettyprint">shell
curl -X GET https://api.resourcewatch.org/v1/geostore/admin/ESP
</code></p>
</blockquote>

<h3 id="country-list">Country list</h3>

<p>A list of countries can be obtained from this endpoint.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/list
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35a6d982388ee5c4e141c2bceac3fb72"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ESP"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spain"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8f77fe62cf15d5098ba0ee11c5126aa6"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FRA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"France"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1d568c183033da6c17cc28c4aecf1bcf"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cod"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Democratic Republic of the Congo"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country-and-region">From country and region</h3>

<p>If you need obtain the geostore of a region in a country, you can obtain it with the ISO3 and region code:</p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Madrid&rsquo;s Comunity in Spain</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/ESP/8
</code></pre>
<h3 id="from-world-database-on-protected-areas-wdpa">From World Database on Protected Areas (wdpa)</h3>

<p>Is possible obtain the geostore of a World Database on Protected Areas of the world. You only need the id of the protected area (WDPA).
<a href="https://www.protectedplanet.net/">World Database on Protected Areas web</a></p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/wdpa/&lt;wdpaId&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/wdpa/&lt;wdpaId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of &lsquo;Sierra de Guadarrama&rsquo; protected area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/wdpa/555538160
</code></pre>
<h3 id="from-land-use-areas">From land use areas</h3>

<p>Geostore has the geojson of 4 different lands use:</p>

<h4 id="oil-palm">Oil palm</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one Oil palm area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/556
</code></pre>
<h4 id="mining">Mining</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/mining/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/mining/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one mining area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/mining/573
</code></pre>
<h4 id="wood-fiber">Wood fiber</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/fiber/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/fiber/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one Wood fiber area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/fiber/346
</code></pre>
<h4 id="congo-basin-logging-roads">Congo Basin logging roads</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/logging/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Oil palm area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/102
</code></pre>
<h3 id="from-carto">From Carto</h3>

<p>If your geojson is in carto table, is possible import this geojson in geostore.
To import the geojson in geostore, you need to define all of the required fields in the request body. The fields that compose a import are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td style="text-align: center">Provider of data</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
<td>carto</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. Is possible put and and or conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To import a Geostore, you have to do a POST with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": &lt;tableName&gt;,
        "user": &lt;userName&gt;,
        "filter": &lt;conditions&gt;
    }
}'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": "gfw_mining",
        "user": "wri-01",
        "filter": "cartodb_id=573"
    }
}'</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="obtain-a-geostore">Obtain a Geostore</h2>

<p>To obtain a geostore, you only need the id of the Geostore. You can perform a GET request for the geostore with its id.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/&lt;geostoreId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining one geostore</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/26f8975c4c647c19a2edaa11f23880a2
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="tasks">Tasks</h1>

<h2 id="what-is-a-task">What is a task?</h2>

<p>In the context of this API, a task is a process in charge of performing certain actions on datasets of the document type.
These actions can be creating a dataset or overwriting its content.</p>

<p>A task may contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td style="text-align: center">Id of the task</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>type</td>
<td style="text-align: center">Task type - see full list <a href="https://github.com/resource-watch/doc-importer-messages/blob/master/task.messages.js#L4">here</a></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>message</td>
<td style="text-align: center">Task message, which parametrizes the task</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Status of the task - see full list <a href="https://github.com/resource-watch/doc-orchestrator/blob/master/app/src/app.constants.js#L3">here</a></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>reads</td>
<td style="text-align: center">Number of data reads performed by the task</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>writes</td>
<td style="text-align: center">Number of data writes performed by the task</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>index</td>
<td style="text-align: center">Name of the Elasticsearch index used in this task</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>datasetId</td>
<td style="text-align: center">Id of the dataset to which this task relates</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>logs</td>
<td style="text-align: center">List of the individual operations carried out by this task</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>error</td>
<td style="text-align: center">Error message generated should the task fail</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Date and time in which the task was created</td>
<td style="text-align: right">DateTime</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Date and time in which the task was last updated</td>
<td style="text-align: right">DateTime</td>
</tr>
</tbody></table>

<p>A task is fundamentally an internal element to the API, and it&rsquo;s visibility and interaction is limited to maintenance and debug actions.
At its core, a task represents a single package that contains:</p>

<ul>
<li>An action to be carried out.</li>
<li>A message that parametrises that action.</li>
<li>A status that identifies the progress stage of the task.</li>
<li>A dataset to which that action should relate.</li>
<li>An Elasticsearch index identifier where the resulting data will be saved.</li>
<li>Counters for read and write operations.</li>
<li>Logs for those operations.</li>
<li>An optional error field that identifies what happened in case of failure.</li>
</ul>

<h2 id="get-all-tasks">Get all tasks</h2>

<p>To obtain all tasks:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:31.295Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:07.147Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a67f2557-9237-4435-82fd-3a0ad64b0292"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53ac8e83-167b-4c77-9b61-6642b1764b32"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">

            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"638cce8c-3e97-4bdd-b4de-41cd28254370"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:36.421Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:09.175Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_638cce8c3e974bddb4de41cd28254370_1550652900017"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"638cce8c-3e97-4bdd-b4de-41cd28254370"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8f5b6b0c-9132-4b5c-b7c4-b58582b3cb0b"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_638cce8c3e974bddb4de41cd28254370_1550652900017"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"63c69b2b-31cd-4bdb-9794-f6d4ec155e7b"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="filter-params">Filter params</h3>

<p>Available filters:</p>

<p>type: &lsquo;type&rsquo;,
            status: &#39;status&rsquo;,
            createdAt: &#39;createdAt&rsquo;,
            updatedAt: &#39;updatedAt&rsquo;,
            createdBefore: &#39;createdAt&rsquo;,
            createdAfter: &#39;createdAt&rsquo;,
            updatedBefore: &#39;updatedAt&rsquo;,
            updatedAfter: &#39;updatedAt&rsquo;</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td style="text-align: center">Task type</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Task status</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>datasetID</td>
<td style="text-align: center">Id of the dataset to which the task refers</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Tasks created on the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Tasks last updated on the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>createdBefore</td>
<td style="text-align: center">Tasks created before the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>createdAfter</td>
<td style="text-align: center">Tasks created after the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedBefore</td>
<td style="text-align: center">Tasks last updated before the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAfter</td>
<td style="text-align: center">Tasks last updated after the given date</td>
<td style="text-align: right">Date</td>
</tr>
</tbody></table>

<blockquote>
<p>Return tasks with type TASK_OVERWRITE</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?type<span class="o">=</span>TASK_OVERWRITE
</code></pre>
<blockquote>
<p>Return the tasks with status SAVED</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?status<span class="o">=</span>SAVED
</code></pre>
<blockquote>
<p>Return the tasks created on Feb 1st 2019</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?createdAt<span class="o">=</span>2019-02-01
</code></pre>
<blockquote>
<p>Return the tasks last updated between Jan 2nd and Feb 2nd 2019</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?updatedAfter<span class="o">=</span>2019-01-02&amp;updatedBefore<span class="o">=</span>2019-02-02
</code></pre>
<blockquote>
<p>Return the tasks last updated before and Feb 2nd 2019 and with status ERROR</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?updatedBefore<span class="o">=</span>2019-02-02&amp;status<span class="o">=</span>ERROR
</code></pre>
<h2 id="get-a-single-task">Get a single task</h2>

<p>To obtain the task:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task/55b02cfd-dabf-4ad0-a04d-5501cf248a0c
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
            </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:31.295Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:07.147Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a67f2557-9237-4435-82fd-3a0ad64b0292"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53ac8e83-167b-4c77-9b61-6642b1764b32"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete-a-task">Delete a task</h2>

<p>You can delete a task if, for example, it is stuck on a running state, but it&rsquo;s not actually running. This should
be considered a &ldquo;only do it if you know what you are doing&rdquo; operation, and requires ADMIN permission.</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/doc-importer/task/&lt;task_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="microservices">Microservices</h1>

<p>A list of information related to the microservices</p>

<aside class="notice">
    These services are only available to ADMIN users.
</aside>

<h2 id="list-all-registered-microservices">List all registered microservices</h2>

<p>To obtain a list of all the registered microservices:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/api/v1/microservice <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.748Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="w">

        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dataset"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dataset.default.svc.cluster.local:3000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/find-by-ids"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/find-by-ids"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-24T13:04:46.728Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.778Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5aa667d1aee7ae16fb419c23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://layer.default.svc.cluster.local:6000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-08T12:07:38.014Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete-microservice">Delete microservice</h2>

<p>To remove a microservice:</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/api/v1/microservice/:id <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h4 id="notes">Notes</h4>

<p>Keep in mind that this does not actually delete the microservice, instead it schedules it for being removed. 
There&rsquo;s a cron task that does the actual deleting, so the process is async.</p>

          <h1 id="errors">Errors</h1>

<p>The Resource Watch API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request is incomplete or contains errors</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is incorrect</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that is not json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
