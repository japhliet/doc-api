<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Aqueduct API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index-aqueduct aqueduct" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo-aqueduct.png" alt="Logo aqueduct" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://ui.resourcewatch.org'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/resource-watch/doc-api'>Contribute to these docs</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Aqueduct API Documentation</p>

          <h1 id="about-these-docs">About these docs</h1>

<p>This documentation page aims to cover the Resource Watch API functionality and details. In it, you&rsquo;ll find a top-level description of the services it provides, as well as a breakdown of the different endpoints, their functionality, parameters and output. The goal is to give you the tools to create powerful applications and data products.</p>

<p>The RW API is <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> and <a href="https://en.wikipedia.org/wiki/JSON">JSON</a> based, and these docs assume you are familiar with both technologies. Besides endpoint descriptions, the documentation will include example code snippets that use <a href="https://en.wikipedia.org/wiki/CURL">cURL</a> to illustrate how you would use each endpoint. Knowing the basics of cURL will help you better understand those examples. </p>

<p>For readability, URLs and query parameters may be displayed without escaping/encoding, but be sure to encode your URLs before issuing a request to the API, or it may produce undesired results. If you are using the RW API to build your own application, there&rsquo;s probably a library out there that does this for you automatically.</p>

<p>In these examples, you&rsquo;ll also find references to a <code class="prettyprint">Authorization: Bearer &lt;your-token&gt;</code> HTTP header. You can find more details about tokens in the <a href="#authentication">authentication</a> section, which you should read before you get started.   </p>

<p>Last but not least, the RW API and its docs are made by humans, who will occasionally make mistakes. If you find something that you think is incorrect, could be improved, if you want to contribute yourself, or just want to say &ldquo;thank you&rdquo;, you can reach us through <a href="https://github.com/resource-watch/doc-api">the RW API documentation Github project page</a>.</p>

          <h1 id="authentication">Authentication</h1>

<p>The RW API uses JWT <a href="https://tools.ietf.org/html/rfc7519">(JSON Web Tokens)</a> to identify and authenticate its users. This token must be provided inside an <code class="prettyprint">Authorization</code> header, with the form <code class="prettyprint">Bearer: &lt;token&gt;</code>.</p>

<p>However, in order to perform GET requests for content that is not private, there&rsquo;s no need for any sort of authentication or token.</p>

<h2 id="how-to-generate-your-private-token">How to generate your private token</h2>

<ol>
<li>On the browser, visit the API&rsquo;s login page at <a href="https://api.resourcewatch.org/auth/login">https://api.resourcewatch.org/auth/login</a>.</li>
<li>Login using your account.</li>
<li>Once you are at <code class="prettyprint">auth/success</code>, go to <a href="https://api.resourcewatch.org/auth/generate-token">https://api.resourcewatch.org/auth/generate-token</a> to generate a new token.</li>
</ol>

<p><img src="images/authentication/auth-success.png" alt="Auth success" /></p>

<h2 id="how-to-create-a-new-user">How to create a new user</h2>

<p>To create a new user make a request like the one in the sidebar:</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/auth/user <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"&lt;email&gt;",
    "role":"&lt;role&gt;",
    "extraUserData": {
      "apps": [
        "&lt;apps&gt;"
      ]
    }
}'</span>
</code></pre>
<p>There are three allowed roles: <code class="prettyprint">USER</code>, <code class="prettyprint">MANAGER</code> and <code class="prettyprint">ADMIN</code>. The &lsquo;apps&rsquo; field only permits applications that are powered by the API: <code class="prettyprint">rw</code>, <code class="prettyprint">gfw</code>, <code class="prettyprint">prep</code>, etc.</p>

          <h1 id="contact">Contact</h1>

<p>The following contact endpoints are available</p>

<h2 id="contact-us">Contact us</h2>

<p>Sends a contact form including a topic, email address, and a message. </p>

<h3 id="example">Example</h3>

<p>Contact form sent using the type <code class="prettyprint">General question or feedback</code>, the email address <code class="prettyprint">example@example.com</code> and the message <code class="prettyprint">This is a text</code>:</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/contact-us <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
    <span class="s1">'{
        "topic": "General question or feedback",
        "email": "example.example@vizzuality.com",
        "text": "This is a test"
    }'</span>
</code></pre>
          <h1 id="collections">Collections</h1>

<p>The users can save a collection of resources in the API.</p>

<aside class="notice">
Remember — All favorite endpoints need to be authenticated.
</aside>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of collection owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>ownerId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>resources</td>
<td style="text-align: center">Resources in the collection</td>
<td style="text-align: right">Array of Objects</td>
</tr>
<tr>
<td>&mdash; type</td>
<td style="text-align: center">The type of resource</td>
<td style="text-align: right">Text (dataset, layer, widget)</td>
</tr>
<tr>
<td>&mdash; id</td>
<td style="text-align: center">The id of the resource</td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<h2 id="create-collection">Create Collection</h2>

<p>To create a collection, you need to define all next fields in the request body. The required fields that compose a collection are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of collection owner</td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<blockquote>
<p>To create an empty collection, you have to do a POST with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/collection <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "&lt;name&gt;"
  }'</span>
</code></pre>
<blockquote>
<p>You can also add a resource in the body of the request when creating a new collection with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/collection <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "&lt;name&gt;",
   "resources": [
     {
      "type": "&lt;type&gt;",
      "id": "&lt;id&gt;"
      }
   ]
  }'</span>
</code></pre>
<h2 id="update-collection">Update Collection</h2>

<blockquote>
<p>To update a collection, you should perform a PATCH request including the collection ID in the url. Here&rsquo;s an example:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/collection/&lt;collection-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "&lt;name&gt;"
  }'</span>
</code></pre>
<h2 id="add-resource-to-collection">Add Resource to Collection</h2>

<p>To create a collection, you need to define all next fields in the request body. The required fields that compose a collection are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td style="text-align: center">Type of resource being added</td>
<td style="text-align: right">Text (dataset, layer, widget)</td>
</tr>
<tr>
<td>id</td>
<td style="text-align: center">Id of the resource</td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<blockquote>
<p>To add a resource to a collection, you have to do a POST with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/collection/:id/resource <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "type": "&lt;type&gt;",
   "id": "&lt;id&gt;"
  }'</span>
</code></pre>
<h2 id="get-collections">Get Collections</h2>

<p>This endpoint returns the collections of the logged user.</p>

<blockquote>
<p>To get all collections of the logged user, you have to do a GET request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/collection <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h2 id="get-collection-by-id">Get Collection by id</h2>

<p>This endpoint returns the collection with id of the param. If the collection belongs to other user or not exist, the endpoint returns 400.</p>

<blockquote>
<p>To get the collection by id, you have to do a GET request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/collection/:id <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h2 id="delete-collection">Delete Collection</h2>

<p>This endpoint deletes the collection with id of the param. If the collection belongs to other user or not exist, the endpoint returns 400.</p>

<blockquote>
<p>To delete the collection by id, you have to do a DELETE request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/collection/:id <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h2 id="delete-collection-resource">Delete Collection Resource</h2>

<p>Using this endpoint you can also delete a resource in a collection with the id, resource type and resource id of the param. If the collection belongs to other user or not exist, the endpoint returns 400.</p>

<blockquote>
<p>To delete the resource you have to do a DELETE request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/collection/:id/resource/:resourceType/:resourceId <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
          <h1 id="dataset">Dataset</h1>

<h2 id="what-is-a-dataset">What is a dataset?</h2>

<p>If you are new to the RW API, or want to learn more about the concept of a dataset, we strongly encourage you to read the <a href="#dataset">dataset concept</a> documentation first. It gives you a brief and clear description of what a dataset is, and what it can do for you.</p>

<p>Once you&rsquo;ve read that section, you can come back here to learn more details about using the RW API&rsquo;s datasets feature. The RW API is home to many datasets uploaded by <a href="https://www.wri.org/">WRI</a>, its partner organizations, or by API users like you. These datasets contain a lot of information about a wide range of topics that you may want to learn about or build on top of. To find out more about finding and accessing the datasets already available on the RW API, check out the documentation on <a href="#getting-all-datasets">getting datasets</a>. A nice, visual way to explore existing datasets is by using the <a href="https://resourcewatch.org/">Resource Watch</a> website. </p>

<p>You can also <a href="#creating-a-dataset">create you own datasets</a> on the RW API, if you&rsquo;d like to share your data with the world, or 
 if you are looking to use the RW API and its features to gain insights into your data.</p>

<h2 id="getting-all-datasets">Getting all datasets</h2>

<p>This endpoint will allow you to get the list of the datasets available in the API, and it&rsquo;s a great place for new users to start exploring the RW API. By default, this endpoint will give you a paginated list of 10 datasets. In the sections below, we&rsquo;ll explore how you can customize this endpoint call to match your needs. </p>

<p>For a detailed description of each field, check out the <a href="#dataset-reference">Dataset reference</a> section.</p>

<blockquote>
<p>Getting a list of datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00f2be42-1ee8-4069-a55a-16a988f2b7a0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Glad points"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Glad-points-1490086842129"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"data4sdgs"</span><span class="p">],</span><span class="w">
            </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributesPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"connectorType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"document"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"58333dcfd9f39b189ca44c75"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"connectorUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers.csv"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"overwrite"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geoInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                </span><span class="p">},</span><span class="w">
            </span><span class="s2">"clonedHost"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
            </span><span class="s2">"errorMessage"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-13T10:45:46.368Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetRelevantProps"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"layerRelevantProps"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=99&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"prev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?page[number]=2&amp;page[size]=10"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">990</span><span class="p">,</span><span class="w">
    </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="pagination">Pagination</h3>

<p>The RW API lists many of its resources as pages, as opposed to showing all results at once. By default, datasets are listed in pages of 10 datasets each, and the first page is loaded. However, you can customize this behavior using the following query parameters:  </p>

<blockquote>
<p>Custom pagination: load page 2 using 25 results per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?page[number]<span class="o">=</span>2&amp;page[size]<span class="o">=</span>25
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Default</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">The number elements per page. Values above 100 are not officially supported.</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">10</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">The page number</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">1</td>
</tr>
</tbody></table>

<h3 id="search">Search</h3>

<blockquote>
<p>Search for datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?search<span class="o">=</span>wind
</code></pre>
<p>The dataset service offers a simple yet powerful search mechanism that will help you look for datasets. The query argument <code class="prettyprint">search</code> allows you to specify a search string that will match:</p>

<ul>
<li>The dataset name.</li>
<li>The dataset&rsquo;s metadata name.</li>
<li>The dataset&rsquo;s metadata description.</li>
<li>The <a href="#graph">relational graph</a> node list.</li>
</ul>

<h3 id="filters">Filters</h3>

<blockquote>
<p>Filtering datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?name<span class="o">=</span>birds&amp;provider<span class="o">=</span>cartodb
</code></pre>
<blockquote>
<p>Matching vocabulary tags</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?vocabulary[legacy]<span class="o">=</span>umd
</code></pre>
<p>The dataset list provides a wide range of parameters that you can use to tailor your dataset listing. Most of these parameters reflect fields you&rsquo;ll find in a dataset itself (which you can learn more about in the <a href="#dataset-reference">Dataset reference</a> section), while others are convenience filters for things like user role or favourites. These parameters can be combined into a complex <code class="prettyprint">and</code> logic query.</p>

<p>Here&rsquo;s the comprehensive list of filters supported by datasets:</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Description</th>
<th>Type</th>
<th>Expected values</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Filter returned datasets by the name of the dataset.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>slug</td>
<td>Filter returned datasets by the slug of the dataset.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>type</td>
<td>Filter returned datasets by dataset type.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>subtitle</td>
<td>Filter returned datasets by dataset subtitle.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>application</td>
<td>Applications associated to this dataset.</td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>applicationConfig</td>
<td>If the dataset has <code class="prettyprint">applicationConfig</code> data (i.e. contains a non-empty object in the <code class="prettyprint">applicationConfig</code> field)</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>dataPath</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>attributesPath</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>connectorType</td>
<td>Filter returned datasets by the type of connector used.</td>
<td>String</td>
<td><code class="prettyprint">rest</code>, <code class="prettyprint">document</code> or <code class="prettyprint">wms</code></td>
</tr>
<tr>
<td>provider</td>
<td>Dataset provider this include inner connectors and 3rd party ones</td>
<td>String</td>
<td><a href="index-rw.html#creating-a-dataset">Check the available providers when creating a dataset</a></td>
</tr>
<tr>
<td>connectorUrl</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>sources</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>tableName</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>userId</td>
<td>Filter results by the owner of the dataset. Does not support regexes.</td>
<td>String</td>
<td>valid user id</td>
</tr>
<tr>
<td>status</td>
<td>Filter results by the current status of the dataset.</td>
<td>String</td>
<td><code class="prettyprint">pending</code>, <code class="prettyprint">saved</code> or <code class="prettyprint">failed</code></td>
</tr>
<tr>
<td>overwrite</td>
<td>If the data can be overwritten (only for being able to make dataset updates)</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>errorMessage</td>
<td>If this dataset is in <code class="prettyprint">error</code> state, this field may contain additional details about the error.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>mainDateField</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>published</td>
<td>If the dataset is published or not.</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>env</td>
<td>Environment to which the dataset belongs. Multiple values can be combined using <code class="prettyprint">,</code> as a separator. Does not support regexes.</td>
<td>String</td>
<td>any valid text. Defaults to <code class="prettyprint">production</code>.</td>
</tr>
<tr>
<td>geoInfo</td>
<td>If it contains interceptable geographical info</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>protected</td>
<td>If the dataset is protected.</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>taskId</td>
<td>Id of the latest task associated with this dataset. Typically only present in <code class="prettyprint">document</code> connectorType datasets</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.lat</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.long</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.date</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.region</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.country</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.nested</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.integer</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.short</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.byte</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.double</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.byte</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.float</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.half_float</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.scaled_float</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.boolean</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.binary</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.text</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>legend.keyword</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>clonedHost.hostProvider</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>clonedHost.hostUrl</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>clonedHost.hostId</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>clonedHost.hostType</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>clonedHost.hostPath</td>
<td></td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>widgetRelevantProps</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>layerRelevantProps</td>
<td></td>
<td>Array</td>
<td>any valid text</td>
</tr>
<tr>
<td>subscribable</td>
<td>If the dataset is subscribable (i.e. contains a non-empty object in the <code class="prettyprint">subscribable</code> field)</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>user.role</td>
<td>Filter results by the role of the owner of the dataset. If the requesting user does not have the ADMIN role, this filter is ignored.</td>
<td>String</td>
<td><code class="prettyprint">ADMIN</code>, <code class="prettyprint">MANAGER</code> or <code class="prettyprint">USER</code></td>
</tr>
<tr>
<td>vocabulary[name]</td>
<td>Filter returned datasets by vocabulary tags. Does not support regexes.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>collection</td>
<td>Filter returned datasets collection id. Does not support regexes.</td>
<td>String</td>
<td>any valid text</td>
</tr>
<tr>
<td>favourite</td>
<td>Filter by favourited datasets. See <a href="#favorites">this section</a> for more info. Does not support regexes.</td>
<td>String</td>
<td>any valid text</td>
</tr>
</tbody></table>

<p>Please keep in mind the following:</p>

<ul>
<li>String types support and expect a regex value, unless detailed otherwise on the <code class="prettyprint">Description</code> field. Although typically they will match exact strings, you may have to escape certain characters (PCRE v8.42 spec).</li>
<li>Array types support multiple values. Use <code class="prettyprint">,</code> as an <code class="prettyprint">or</code> multi-value separator, or <code class="prettyprint">@</code> as a multi-value, exact match separator.</li>
<li>Object types expect a boolean value, where <code class="prettyprint">true</code> matches a non-empty object, and <code class="prettyprint">false</code> matches an empty object.</li>
</ul>

<h3 id="sorting">Sorting</h3>

<h4 id="basics-of-sorting">Basics of sorting</h4>

<blockquote>
<p>Sorting datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Sorting datasets by multiple criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>name,description
</code></pre>
<blockquote>
<p>Sort by name descending, description ascending</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>-name,+description
</code></pre>
<blockquote>
<p>Sorting datasets by the role of the user who owns the dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>user.role
</code></pre>
<p>The API currently supports sorting by means of the <code class="prettyprint">sort</code> query parameter. Sorting can be done using any field from the <a href="#dataset-reference">dataset model</a>, as well as <code class="prettyprint">user.name</code> and <code class="prettyprint">user.role</code> (sorting by user data is restricted to ADMIN users). Sorting by nested fields is not supported at the moment.</p>

<p>Multiple sorting criteria can be used, separating them by commas.</p>

<p>You can also specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> for descending order or <code class="prettyprint">+</code> for ascending order. By default, ascending order is assumed.</p>

<h4 id="special-sorting-criteria">Special sorting criteria</h4>

<blockquote>
<p>Sorting datasets with special criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>-most-favorited
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?sort<span class="o">=</span>relevance&amp;status<span class="o">=</span>saved&amp;search<span class="o">=</span>agriculture
</code></pre>
<p>Special search criteria must be used as sole sorting criteria, as it&rsquo;s not possible to combine any of them with any other search criteria. The following criteria can be used for special sorting in datasets:</p>

<ul>
<li><code class="prettyprint">most-viewed</code> delegates sorting to the graph component, sorting by the datasets that have been queried more frequently. Supports ascending/descending order.</li>
<li><code class="prettyprint">most-favorited</code>: delegates sorting to the graph component, sorting by the datasets that have been more favorited. Supports ascending/descending order.</li>
<li><code class="prettyprint">relevance</code>: delegates sorting to the metadata component, sorting by the datasets which metadata better match the search criteria. Can only be used in conjunction with a <code class="prettyprint">search</code> parameter. Does not support ascending order.</li>
</ul>

<p>You can specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> for descending order or <code class="prettyprint">+</code> for ascending order. By default, ascending order is assumed.</p>

<h3 id="include-related-entities">Include related entities</h3>

<blockquote>
<p>Loads metadata and widgets associated with each dataset:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?includes<span class="o">=</span>metadata,widget
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06c44f9a-aae7-401e-874c-de13b7764959"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Historical Precipitation -- U.S. (Puget Sound Lowlands)"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Historical-Precipitation-US-Puget-Sound-Lowlands-1490086842133"</span><span class="p">,</span><span class="w">
                </span><span class="err">...</span><span class="w">
                </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">  

                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57a2251d5cd6980a00e054d9"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="s2">"widget"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">  
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"73f00267-fe34-42aa-a611-13b102f38d75"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?includes=widget%2Cmetadata&amp;page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?includes=widget%2Cmetadata&amp;page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?includes=widget%2Cmetadata&amp;page[number]=223&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"prev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?includes=widget%2Cmetadata&amp;page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.resourcewatch.org/v1/dataset?includes=widget%2Cmetadata&amp;page[number]=2&amp;page[size]=10"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">223</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">2228</span><span class="p">,</span><span class="w">
        </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Loading layers for the given dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET http://api.resourcewatch.org/dataset?includes<span class="o">=</span>layer
</code></pre>
<blockquote>
<p>Loading the information about the user who authored the dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset?includes<span class="o">=</span>user
</code></pre>
<p>When fetching datasets, you can request additional entities to be loaded. The following entities are available:</p>

<ul>
<li><code class="prettyprint">widget</code> - loads all widgets associated with a given dataset.</li>
<li><code class="prettyprint">layer</code> - loads all layers associated with a given dataset.</li>
<li><code class="prettyprint">vocabulary</code> - loads all vocabulary entities associated with a given dataset.</li>
<li><code class="prettyprint">metadata</code> - loads all metadata associated with a given dataset.</li>
<li><code class="prettyprint">user</code> - loads the name, email address and role of the author of the dataset. If you do not issue this request as an ADMIN user, or if no user data is available, the <code class="prettyprint">user</code> object will be empty.</li>
</ul>

<p><strong>Note:</strong> If you include related entities (e.g. layers) with query filters, the filters will not cascade to the related entities.</p>

<h2 id="getting-a-dataset-by-id-or-slug">Getting a dataset by id or slug</h2>

<blockquote>
<p>Getting a dataset by id:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/51943691-eebc-4cb4-bdfb-057ad4fc2145
</code></pre>
<blockquote>
<p>Getting a dataset by slug:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/Timber-Production-RDC
</code></pre>
<blockquote>
<p>Response (equal for both cases):</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"data"</span>: <span class="o">{</span>
        <span class="s2">"id"</span>: <span class="s2">"51943691-eebc-4cb4-bdfb-057ad4fc2145"</span>,
        <span class="s2">"type"</span>: <span class="s2">"dataset"</span>,
        <span class="s2">"attributes"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Timber Production RDC"</span>,
            <span class="s2">"slug"</span>: <span class="s2">"Timber-Production-RDC"</span>,
            <span class="s2">"type"</span>: null,
            <span class="s2">"subtitle"</span>: null,
            <span class="s2">"application"</span>: <span class="o">[</span><span class="s2">"forest-atlas"</span><span class="o">]</span>,
            <span class="s2">"dataPath"</span>: null,
            <span class="s2">"attributesPath"</span>: null,
            <span class="s2">"connectorType"</span>: <span class="s2">"document"</span>,
            <span class="s2">"provider"</span>: <span class="s2">"csv"</span>,
            <span class="s2">"userId"</span>: <span class="s2">"58750a56dfc643722bdd02ab"</span>,
            <span class="s2">"connectorUrl"</span>: <span class="s2">"http://wri-forest-atlas.s3.amazonaws.com/COD/temp/annual%20timber%20production%20DRC%20%28test%29%20-%20Sheet1.csv"</span>,
            <span class="s2">"sources"</span>: <span class="o">[]</span>,
            <span class="s2">"tableName"</span>: <span class="s2">"index_51943691eebc4cb4bdfb057ad4fc2145"</span>,
            <span class="s2">"status"</span>: <span class="s2">"saved"</span>,
            <span class="s2">"overwrite"</span>: <span class="nb">false</span>,
            <span class="s2">"legend"</span>: <span class="o">{</span>
                <span class="s2">"date"</span>: <span class="o">[</span><span class="s2">"year"</span><span class="o">]</span>,
                <span class="s2">"region"</span>: <span class="o">[]</span>,
                <span class="s2">"country"</span>: <span class="o">[]</span>,
                <span class="s2">"long"</span>: <span class="s2">""</span>,
                <span class="s2">"lat"</span>: <span class="s2">""</span>
            <span class="o">}</span>,
            <span class="s2">"clonedHost"</span>: <span class="o">{}</span>,
            <span class="s2">"errorMessage"</span>: null,
            <span class="s2">"createdAt"</span>: <span class="s2">"2017-01-25T21:48:27.535Z"</span>,
            <span class="s2">"updatedAt"</span>: <span class="s2">"2017-01-25T21:48:28.675Z"</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>If you know the id or the <code class="prettyprint">slug</code> of a dataset, then you can access it directly. Both id and <code class="prettyprint">slug</code> are case-sensitive.</p>

<p>Using this endpoint, you can also <a href="#include-related-entities">include related entities</a>, in the same way you do when loading multiple datasets. </p>

<blockquote>
<p>Getting a dataset by its including its relationships:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/06c44f9a-aae7-401e-874c-de13b7764959?includes<span class="o">=</span>metadata,vocabulary,widget,layer
</code></pre>
<h2 id="getting-multiple-datasets-by-ids">Getting multiple datasets by ids</h2>

<p>This endpoint allows you to load multiple datasets by id in a single request.</p>

<h4 id="errors-for-getting-multiple-datasets-by-ids">Errors for getting multiple datasets by ids</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>ids: ids can not be empty.</td>
<td>The required <code class="prettyprint">ids</code> field is missing in the request body.</td>
</tr>
</tbody></table>

<blockquote>
<p>Getting multiple datasets by their ids:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "ids": [
        "0706f039-b929-453e-b154-7392123ae99e",
        "0c630feb-8146-4fcc-a9be-be5adcb731c8",
    ]
}'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="w">    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0706f039-b929-453e-b154-7392123ae99e"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Social Vulnerability Index (2006-2010) -- U.S. (New Hampshire)"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Social-Vulnerability-Index-2006-2010-US-New-Hampshire-1490086842541"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tabular"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="err">...</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0c630feb-8146-4fcc-a9be-be5adcb731c8"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USGS Land Cover - Impervious Surface (2001) -- U.S. (Alaska)"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USGS-Land-Cover-Impervious-Surface-2001-US-Alaska-1490086842439"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"raster"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="err">...</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="creating-a-dataset">Creating a dataset</h2>

<p>So you are ready to create your first dataset on the RW API? Great, welcome aboard! These instruction will help you create your dataset on the RW API, so you can start sharing your data with the world and taking full advantage of all the RW API features on your projects.</p>

<p>Before creating a dataset, there are a few things you must know and do:</p>

<ul>
<li>In order to be able to create a dataset, you need to be <a href="#authentication">authenticated</a>.</li>
<li>Depending on your user account&rsquo;s role, you may have permission to create a dataset but not delete it afterwards.</li>
<li>All data uploaded to the RW API will be publicly visible and available to other users. </li>
</ul>

<p>The first thing to consider when creating a dataset is where your data currently is - this will determine the <a href="#dataset-providers">Dataset provider</a> you will need to use and, with it, a set of things you need to take into account - we&rsquo;ll cover each provider in detail shortly. When building your request to the RW API to create your dataset, you will need to take into account both the general details that follow, plus the details for the <code class="prettyprint">provider</code> you are using. Be sure to review both sections when creating your datasets, to avoid any pitfalls.</p>

<p>Creating a dataset is done using a POST request and passing the relevant data as body files. The supported body fields are as defined on the <a href="#dataset-reference">dataset reference</a> section, but the minimum field list you must specify for all datasets is:</p>

<ul>
<li>name</li>
<li>application</li>
<li>connectorType</li>
<li>provider </li>
</ul>

<p>Additionally, depending on the data provider you will be using, other fields may be required - we&rsquo;ll cover those in detail in each provider&rsquo;s specific documentation.</p>

<p>A successful dataset creation request will return a 200 HTTP code, and the dataset details as stored on the RW API. PAy special attention to the <code class="prettyprint">id</code> or the <code class="prettyprint">slug</code>, as those will allow you to <a href="#getting-a-dataset-by-id-or-slug">access your dataset</a> later.</p>

<p><strong>There&rsquo;s one aspect of the dataset creation process that you need to keep in mind: it is an asynchronous process.</strong> This means that a successful call to the create dataset endpoint will <em>start</em> the process, but the dataset may not be immediately available to be used. The <code class="prettyprint">status</code> field will tell you if the dataset creation process is in progress (status set to <code class="prettyprint">pending</code>), if something went wrong (<code class="prettyprint">failed</code>, in which case the <code class="prettyprint">errorMessage</code> field will have a short description of what went wrong) or if the dataset is available to be used (when status is <code class="prettyprint">saved</code>). The amount of time it takes for a newly created dataset to go from <code class="prettyprint">pending</code> to <code class="prettyprint">saved</code> depends on the provider and amount of data. Just keep in mind that you need to wait for the status to be set to <code class="prettyprint">saved</code> before starting to use your datasets. You should <a href="#getting-a-dataset-by-id-or-slug">check your dataset</a> manually to see when the <code class="prettyprint">status</code> is updated.</p>

<h4 id="errors-for-creating-a-dataset">Errors for creating a dataset</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td><code class="prettyprint">&lt;field&gt;</code>: <code class="prettyprint">&lt;field&gt;</code> can not be empty</td>
<td>Your are missing a required field value.</td>
</tr>
<tr>
<td>400</td>
<td><code class="prettyprint">&lt;field&gt;</code>: empty or invalid <code class="prettyprint">&lt;field&gt;</code></td>
<td>The provided value for <code class="prettyprint">&lt;field&gt;</code> is invalid. This is usually happens if an invalid value type is provided, but certain fields use more advanced validation rules, that may produce this error message if validation fails (ie: on a carto dataset, the <code class="prettyprint">connectorUrl</code> must contain a valid carto URL).</td>
</tr>
<tr>
<td>400</td>
<td>provider: must be valid <list of valid providers></td>
<td>Your <code class="prettyprint">provider</code> value is invalid. The <code class="prettyprint">&lt;list of valid providers&gt;</code> will contain the list of providers that are supported for the <code class="prettyprint">connectorType</code> you specified.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You are not authenticated. If creating a BigQuery dataset, you may also see this message if you are authenticated. Refer to the <a href="#bigquery49">BigQuery documentation</a> for more details.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden - User does not have access to this dataset&rsquo;s application</td>
<td>You are trying to create a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
</tbody></table>

<h3 id="carto-datasets">Carto datasets</h3>

<blockquote>
<p>Example of creating a dataset based on CartoDB data with the minimum fields required</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "name":"World Database on Protected Areas -- Global",
    "connectorType":"rest",
    "provider":"cartodb",
    "connectorUrl":"https://wri-01.carto.com/tables/wdpa_protected_areas/table",
    "application":[
      "gfw", 
      "forest-atlas"
    ]
  }
}'</span>
</code></pre>
<p>To create a dataset connected to a Carto data source, besides the common required fields, you must provide the following required data:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Example value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">connectorType</code></td>
<td style="text-align: center">The type of connector. Must be set to <code class="prettyprint">rest</code>.</td>
<td style="text-align: right"><code class="prettyprint">rest</code></td>
</tr>
<tr>
<td><code class="prettyprint">provider</code></td>
<td style="text-align: center">The provider should be set to <code class="prettyprint">cartodb</code>.</td>
<td style="text-align: right"><code class="prettyprint">cartodb</code></td>
</tr>
<tr>
<td><code class="prettyprint">connectorUrl</code></td>
<td style="text-align: center">The URL for the CartoDB table that this dataset will be using.</td>
<td style="text-align: right"><code class="prettyprint">https://wri-01.carto.com/tables/wdpa_protected_areas/table</code></td>
</tr>
</tbody></table>

<p>The RW API will use the information above to directly query the Carto account specified on the <code class="prettyprint">connectorUrl</code> field whenever this dataset is accessed on the RW API. This has a few implications that you should be aware of:</p>

<ul>
<li>The Carto URL provided will be publicly visible to all RW API users.</li>
<li>The Carto account will see increased traffic.</li>
<li>Any changes made to the data hosted on Carto will be automatically reflected on the data served by the RW API for this dataset.</li>
<li>If you restructure or delete your Carto table, the corresponding RW API dataset will be in an invalid state, and you should delete it.</li>
</ul>

<p>The <code class="prettyprint">tableName</code> value of a carto-based dataset will automatically be filled with the name of the carto table corresponding to the dataset.</p>

<p>When creating a Carto based-dataset, the RW API will try to validate the <code class="prettyprint">connectorUrl</code> by trying to connect to the corresponding Carto table - the result of this will determine if the dataset&rsquo;s status will be set to <code class="prettyprint">saved</code> or <code class="prettyprint">error</code>.</p>

<h3 id="arcgis-feature-layer">ArcGIS feature layer</h3>

<blockquote>
<p>Example of creating a dataset based on ArcGIS feature layer data with the minimum fields required</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "connectorType":"rest",
    "provider":"featureservice",
    "connectorUrl":"https://services.arcgis.com/uDTUpUPbk8X8mXwl/arcgis/rest/services/Public_Schools_in_Onondaga_County/FeatureServer/0?f=json",
    "application":[
     "prep"
    ],
    "name":"Uncontrolled Public-Use Airports -- U.S."
  }
}'</span>
</code></pre>
<p>To create a dataset using ArcGIS feature layer as data source, besides the common required fields, you must provide the following required data:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Example value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">connectorType</code></td>
<td style="text-align: center">The type of connector. Must be set to <code class="prettyprint">rest</code>.</td>
<td style="text-align: right"><code class="prettyprint">rest</code></td>
</tr>
<tr>
<td><code class="prettyprint">provider</code></td>
<td style="text-align: center">The provider should be set to <code class="prettyprint">featureservice</code>.</td>
<td style="text-align: right"><code class="prettyprint">featureservice</code></td>
</tr>
<tr>
<td><code class="prettyprint">connectorUrl</code></td>
<td style="text-align: center">The URL for the JSON data in ArcGIS services this dataset will be using.</td>
<td style="text-align: right">https://services.arcgis.com/uuid/arcgis/rest/services/example/FeatureServer/0?f=json</td>
</tr>
</tbody></table>

<p>The RW API will use the information above to directly query the ArcGIS feature layer server specified on the <code class="prettyprint">connectorUrl</code> field whenever this dataset is accessed on the RW API. This has a few implications that you should be aware of:</p>

<ul>
<li>The ArcGIS feature layer URL provided will be publicly visible to all RW API users.</li>
<li>The ArcGIS feature layer server will see increased traffic.</li>
<li>Any changes made to the data hosted on ArcGIS feature layer will be automatically reflected on the data served by the RW API for this dataset.</li>
<li>If you restructure or delete your ArcGIS feature layer dataset, the corresponding RW API dataset will be in an invalid state, and you should delete it.</li>
</ul>

<p>The <code class="prettyprint">tableName</code> value of a ArcGIS-based dataset will automatically be filled with the name of the ArcGIS feature layer table corresponding to the dataset.</p>

<p>When creating a ArcGIS-based dataset, the RW API will try to validate the <code class="prettyprint">connectorUrl</code> by trying to connect to the corresponding ArcGIS Feature Layer - the result of this will determine if the dataset&rsquo;s status will be set to <code class="prettyprint">saved</code> or <code class="prettyprint">error</code>.</p>

<h3 id="google-earth-engine">Google Earth Engine</h3>

<blockquote>
<p>Example of creating a dataset based on Google Earth Engine data with the minimum fields required</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "connectorType":"rest",
    "provider":"gee",
    "tableName": "JRC/GSW1_0/GlobalSurfaceWater"
    "application":[
     "rw"
    ],
    "name":"Water occurrence"
  }
}'</span>
</code></pre>
<p>To create a dataset using Google Earth Engine (GEE) as data source, besides the common required fields, you must provide the following required data:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Example value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">connectorType</code></td>
<td style="text-align: center">The type of connector. Must be set to <code class="prettyprint">rest</code>.</td>
<td style="text-align: right"><code class="prettyprint">rest</code></td>
</tr>
<tr>
<td><code class="prettyprint">provider</code></td>
<td style="text-align: center">The provider should be set to <code class="prettyprint">gee</code>.</td>
<td style="text-align: right"><code class="prettyprint">gee</code></td>
</tr>
<tr>
<td><code class="prettyprint">tableName</code></td>
<td style="text-align: center">Relative path of the dataset within GEE.</td>
<td style="text-align: right">users/resourcewatch_wri/dataset_name</td>
</tr>
</tbody></table>

<p>The RW API will use the information above to directly query the GEE dataset specified on the <code class="prettyprint">tableName</code> field whenever this dataset is accessed on the RW API. This has a few implications that you should be aware of:</p>

<ul>
<li>The GEE resource name provided will be publicly visible to all RW API users.</li>
<li>Any changes made to the data hosted on GEE will be automatically reflected on the data served by the RW API for this dataset.</li>
<li>If you restructure or delete your GEE dataset, the corresponding RW API dataset will be in an invalid state, and you should delete it.</li>
</ul>

<p>When creating a GEE-based dataset, the RW API will try to validate it by connecting to the corresponding dataset GEE - the result of this will determine if the dataset&rsquo;s status will be set to <code class="prettyprint">saved</code> or <code class="prettyprint">error</code>.</p>

<h3 id="wms">WMS</h3>

<blockquote>
<p>Example of creating a dataset based on WMS data with the minimum fields required</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST <span class="s1">'https://api.resourcewatch.org/v1/dataset'</span> -d <span class="se">\</span>
-H <span class="s1">'Authorization: Bearer &lt;your-token&gt;'</span>  <span class="se">\</span>
-H <span class="s1">'Content-Type: application/json'</span> -d <span class="se">\</span>
<span class="s1">'{
   "dataset": {
     "application": [
       "rw"
     ],
     "name": "Seasonal variability",
     "connectorType": "wms",
     "provider":"wms",
     "connectorUrl":"http://gis-gfw.wri.org/arcgis/rest/services/prep/nex_gddp_indicators/MapServer/6?f=pjson"
   }
 }
'</span>
</code></pre>
<p>To create a dataset using WMS as data source, you should provide the following data:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Example value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">connectorType</code></td>
<td style="text-align: center">The type of connector. Must be set to <code class="prettyprint">wms</code>.</td>
<td style="text-align: right"><code class="prettyprint">wms</code></td>
</tr>
<tr>
<td><code class="prettyprint">provider</code></td>
<td style="text-align: center">The provider should be set to <code class="prettyprint">wms</code>.</td>
<td style="text-align: right"><code class="prettyprint">wms</code></td>
</tr>
<tr>
<td><code class="prettyprint">connectorUrl</code></td>
<td style="text-align: center">URL of the server hosting the data in WMS format.</td>
<td style="text-align: right"><code class="prettyprint">https://maps.heigit.org/osm-wms/service?request=GetCapabilities&amp;service=WMS</code></td>
</tr>
</tbody></table>

<p>The RW API will use the information above to directly query the WMS dataset specified on the <code class="prettyprint">connectorUrl</code> field whenever this dataset is accessed on the RW API. This has a few implications that you should be aware of:</p>

<ul>
<li>The WMS server URL provided will be publicly visible to all RW API users.</li>
<li>Any changes made to the data hosted on the WMS server data will be automatically reflected on the data served by the RW API for this dataset.</li>
<li>If you restructure or delete your WMS server data, the corresponding RW API dataset will be in an invalid state, and you should delete it.</li>
</ul>

<p>When creating a WMS-based dataset, no validation is done - the dataset is automatically created in a <code class="prettyprint">saved</code> state.</p>

<h3 id="document-based-datasets-json-csv-tsv-or-xml">Document based datasets: JSON, CSV, TSV or XML</h3>

<blockquote>
<p>Creating a CSV dataset with data provided by externally hosted files:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "connectorType":"document",
    "provider":"csv",
    "sources": [
      "https://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers_1.csv",
      "https://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers_2.csv",
      "https://gfw2-data.s3.amazonaws.com/alerts-tsv/glad_headers_3.csv"
    ],
    "application":[
     "gfw"
    ],
    "name":"Glad points"
  }
}'</span>
</code></pre>
<blockquote>
<p>Creating a JSON dataset with data provided on the request body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "connectorType":"document",
    "provider":"json",
    "application":[
     "your", "apps"
    ],
    "data": {"myData":[
            {"name":"nameOne", "id":"random1"},
            {"name":"nameTow", "id":"random2"}
          ]},
    "name":"Example JSON Dataset"
  }
}'</span>
</code></pre>
<p>This dataset hosts data from files in JSON, CSV, TSV or XML format.</p>

<p>Here&rsquo;s a breakdown of the fields you need to specify when creating a document type dataset, besides the common required fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Example value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">connectorType</code></td>
<td style="text-align: center">The type of connector. Must be set to <code class="prettyprint">document</code>.</td>
<td style="text-align: right"><code class="prettyprint">document</code></td>
</tr>
<tr>
<td><code class="prettyprint">provider</code></td>
<td style="text-align: center">The type of data you are uploading. Must be one of the following: <code class="prettyprint">csv</code>, <code class="prettyprint">tsv</code>, <code class="prettyprint">json</code> or <code class="prettyprint">xml</code>.</td>
<td style="text-align: right"><code class="prettyprint">csv</code>, <code class="prettyprint">tsv</code>, <code class="prettyprint">json</code> or <code class="prettyprint">xml</code></td>
</tr>
<tr>
<td><code class="prettyprint">connectorUrl</code></td>
<td style="text-align: center">URL from which to source data.</td>
<td style="text-align: right">http://gis-gfw.wri.org/arcgis/rest/services/prep/nex_gddp_indicators/MapServer/6?f=pjson</td>
</tr>
<tr>
<td><code class="prettyprint">sources</code></td>
<td style="text-align: center">List of URLs from which to source data.</td>
<td style="text-align: right">[&lsquo;http://gis-gfw.wri.org/arcgis/rest/services/prep/nex_gddp_indicators/MapServer/6?f=pjson&rsquo;,&#39;http://gis-gfw.wri.org/arcgis/rest/services/prep/nex_gddp_indicators/MapServer/7?f=pjson&rsquo;]</td>
</tr>
<tr>
<td><code class="prettyprint">data</code></td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present.</td>
<td style="text-align: right">[{&ldquo;key&rdquo;:&ldquo;value1&rdquo;},{&ldquo;key&rdquo;:&ldquo;value2&rdquo;}]]</td>
</tr>
</tbody></table>

<p>When creating a document based dataset, you have multiple ways of providing your data to the API, of which you should use only one:</p>

<ul>
<li>The <code class="prettyprint">sources</code> field expects a list of URL containing files in the format matching your <code class="prettyprint">provider</code> value. This is the recommended way of uploading data.</li>
<li>The <code class="prettyprint">connectorUrl</code> field is similar to <code class="prettyprint">sources</code>, but it only accepts a single value. <strong>Deprecation notice</strong>: The previously used <code class="prettyprint">connectorUrl</code> field should be considered deprecated when creating document-based datasets.</li>
<li>If creating a dataset based on JSON data, you can upload the data on the actual request you issue to the API, inside the <code class="prettyprint">data</code> field.</li>
</ul>

<p>The data passed in <code class="prettyprint">sources</code> or <code class="prettyprint">connectorUrl</code> must be available on a publicly accessible URLs, specified in the <code class="prettyprint">sources</code> array field or the <code class="prettyprint">connectorUrl</code> single value field. The URLs must be an accessible CSV, TSV or XML file, non-compressed - zip, tar, tar.gz, etc are not supported. <code class="prettyprint">sources</code> allows you to specify multiple URLs for a single dataset, provided all files have the same format and data structure. This is particularly useful when creating very large datasets, as it will allow the creation process to be parallelized. No warranties are provided about the order in which the files or their parts are imported.</p>

<p><em>Notice: If you want to create a dataset from a file you have, but that it&rsquo;s not available on a public URL, check out our docs for <a href="#uploading-a-dataset">uploading a dataset</a>.</em></p>

<p>Unlike with other dataset types, when the dataset is created, the data is copied from the provided source into the API&rsquo;s internal Elasticsearch instance, which is the source used for subsequent queries or other operations. This has a few implications that you should be aware of:</p>

<ul>
<li>The URLs provided in <code class="prettyprint">sources</code> or <code class="prettyprint">connectorUrl</code> will be publicly visible to all RW API users.</li>
<li>On dataset creation, those URLs will be visited as the API loads and copies your data.</li>
<li>Queries to the dataset will use the API&rsquo;s internal copy of your data. If you wish to update that data, see the documentation below on how to update your data.</li>
<li>If the URLs provided become unavailable after the creation process is over, the dataset will continue to work normally - your data will still be available online.</li>
</ul>

<p><em>Notice: When creating a document-based dataset, if any of the fields has a numerical name (for example, column: <code class="prettyprint">3</code>), a string named <code class="prettyprint">col_</code> will be appended to the beginning of the name of the column. This way, an uploaded column named <code class="prettyprint">3</code> will become <code class="prettyprint">col_3</code>.</em></p>

<p><em>Tip: If you want to periodically and automatically update your document based dataset with new data, check out the <a href="#dataset-automatic-synchronization">dataset automatic synchronization</a> functionality.</em></p>

<p>When creating a document-based dataset, the RW API will start a complex process that copies your data into the API&rsquo;s internal database, and perform certain indexing actions. This process is called a <strong>Task</strong>, and is given a <code class="prettyprint">taskId</code> that is stored on the dataset&rsquo;s field with the same name. Depending on the size of your dataset, this may take from a few seconds to a few hours to complete. The result of this import process will determine if the dataset&rsquo;s status will be set to <code class="prettyprint">saved</code> or <code class="prettyprint">error</code>. You can follow this process by using the <code class="prettyprint">taskId</code> value with the <a href="#get-a-single-task">Tasks API</a>.</p>

<h4 id="using-the-legend-fields-to-define-field-types">Using the legend fields to define field types</h4>

<p>By default, when creating a document based dataset, the data is ingested by the API and the field types are automatically determined by the underlying Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/mapping.html#_dynamic_mapping">dynamic mapping API</a>.
However, in some scenarios, it may be desirable to specify some or all of these mappings manually, to match each field type to its Elasticsearch equivalent.</p>

<p>When defining manual mappings, you don&rsquo;t need to map every single field. When processing the data, if a field is found for which there isn&rsquo;t a manual mapping, Elasticsearch will fallback to its dynamic mapping algorithm to try and guess that field&rsquo;s type. This API only supports a single explicit mapping per field, meaning you cannot declare a given field as both <code class="prettyprint">text</code> and <code class="prettyprint">keyword</code> for example.</p>

<p>Field mapping can only be defined on dataset creation. Should you want to change these mappings, you can only do so by creating a new dataset with the new mapping structure.</p>

<p>The <code class="prettyprint">legend</code> field allows explicitly identifying the following mappings:</p>

<table><thead>
<tr>
<th>Mapping</th>
<th style="text-align: center">Notes</th>
</tr>
</thead><tbody>
<tr>
<td>lat</td>
<td style="text-align: center">If <code class="prettyprint">lat</code> and <code class="prettyprint">long</code> are both provided, a <code class="prettyprint">the_geom</code> mapping is added</td>
</tr>
<tr>
<td>long</td>
<td style="text-align: center">If <code class="prettyprint">lat</code> and <code class="prettyprint">long</code> are both provided, a <code class="prettyprint">the_geom</code> mapping is added</td>
</tr>
<tr>
<td>date</td>
<td style="text-align: center">Name of columns with date values (ISO Format)</td>
</tr>
<tr>
<td>country</td>
<td style="text-align: center">Name of columns with country values (ISO3 code)</td>
</tr>
<tr>
<td>region</td>
<td style="text-align: center">Name of columns with region values (ISO3 code)</td>
</tr>
<tr>
<td></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>nested</td>
<td style="text-align: center"><a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/nested.html">Nested objects</a> need to be explicitly identified in order to be indexed.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>integer</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>short</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>byte</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>double</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>half_float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>scaled_float</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>boolean</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>binary</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>text</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
<tr>
<td>keyword</td>
<td style="text-align: center">In beta, not fully supported</td>
</tr>
</tbody></table>

<p>For more details on the characteristics of each of the basic data types, refer to the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.5/mapping.html#_field_datatypes">Elasticsearch documentation</a>.</p>

<h4 id="uploading-a-dataset-file">Uploading a dataset file</h4>

<blockquote>
<p>Upload raw data for using in a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/upload <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-F <span class="nv">provider</span><span class="o">=</span>csv,
-F <span class="nv">dataset</span><span class="o">=</span>@&lt;your-file&gt;
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"connectorUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw.dataset.raw/some-file.csv"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Country (region)"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Positive affect"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Negative affect"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Social support"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Freedom"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Corruption"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Generosity"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Using the returned connectorUrl to create a new dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
<span class="s1">'{
  "dataset": {
    "connectorType":"document",
    "provider":"csv",
    "connectorUrl":"rw.dataset.raw/some-file.csv",
    "application":[
     "your", "apps"
    ],
    "name":"Example RAW Data Dataset"
  }
}'</span>
</code></pre>
<p>The <code class="prettyprint">upload</code> endpoint allows you to create datasets on the API from local files that aren&rsquo;t available online. 
If your file is up to 4MB in size, you can upload it to the API by using the <code class="prettyprint">upload</code> endpoint. 
This endpoint accepts a file in the &ldquo;dataset&rdquo; field of your POST request, and a <code class="prettyprint">provider</code> that matches your file type and extension. 
The supported formats/extensions are: csv, json, tsv, xml, tif, tiff and geo.tiff.
The request uploads the file to the API, and returns a specially crafted <code class="prettyprint">connectorUrl</code> value, and a list of fields found in your file.
With this data, you can create a document type dataset by passing it to the <code class="prettyprint">connectorUrl</code> value of a <a href="#document-based-datasets-json-csv-tsv-or-xml">new document type dataset</a>.</p>

<h4 id="errors-for-upload-a-dataset-file">Errors for upload a dataset file</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>- no file to check -</td>
<td>A file was not provided, or was provided in the wrong request field.</td>
</tr>
<tr>
<td>400</td>
<td>- dataset: file dataset can not be a empty file -</td>
<td>A file was not provided, or was provided in the wrong request field.</td>
</tr>
<tr>
<td>400</td>
<td>provider: provider must be in [csv,json,tsv,xml,tif,tiff,geo.tiff].</td>
<td>A file was not provided, or was provided in the wrong request field.</td>
</tr>
<tr>
<td>400</td>
<td>- dataset: file too large -</td>
<td>Your file is larger than 4MB.</td>
</tr>
<tr>
<td>400</td>
<td>- dataset: file <your file name> is bad file type. -</td>
<td>The <code class="prettyprint">provider</code> value must match the extension of the uploaded file.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to upload a file.</td>
</tr>
</tbody></table>

<h2 id="updating-a-dataset">Updating a dataset</h2>

<p>There are multiple options to update a dataset, depending on what modification you are trying to achieve, and the underlying data provider of the dataset itself. This section covers the different endpoints that allow you to modify a dataset, their details, and helps you pick the option that best fits your scenario. We recommend reviewing all of them before proceeding, so you can find the endpoint that best matches your needs.</p>

<h3 id="updating-the-fields-of-a-dataset">Updating the fields of a dataset</h3>

<blockquote>
<p>Example request for updating the name of a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id-or-slug&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
    "name": "Another name for the dataset"
}'</span>
</code></pre>
<p>In order to modify the fields of a dataset, you can use the patch dataset endpoint. 
This endpoint allows you to modify most of your dataset&rsquo;s details, like the name or publishing status, but can also be used to modify internal fields of a dataset, like <code class="prettyprint">connectorType</code>. 
When making these changes, be mindful that some of these fields are critical to the correct behavior of the dataset, and providing incorrect values may break your dataset. 
There are other endpoints documented in this page that allow you to perform certain update-like operations (ie. update data on a document-type dataset), so refer to those first before using this endpoint. 
Also important to keep in mind is the fact that this endpoint does not perform validation on things like <code class="prettyprint">connectorUrl</code>/<code class="prettyprint">sources</code> URLs.</p>

<p>All the fields in the <a href="#dataset-reference">dataset reference</a> can be modified, except the following:</p>

<ul>
<li><code class="prettyprint">slug</code></li>
<li><code class="prettyprint">userId</code></li>
<li><code class="prettyprint">createdAt</code></li>
<li><code class="prettyprint">updatedAt</code></li>
</ul>

<p>Additionally, certain fields have special behavior associated with them:</p>

<ul>
<li><code class="prettyprint">status</code> can only be modified by users with <code class="prettyprint">ADMIN</code> role or by other microservices.</li>
<li><code class="prettyprint">taskId</code> and <code class="prettyprint">errorMessage</code> can only be modified by other microservices.</li>
<li><code class="prettyprint">published</code> can only be modified by users with <code class="prettyprint">ADMIN</code> role.</li>
<li><code class="prettyprint">env</code> changes will not only affect the dataset, but also related widgets and layers. Refer to the PATCH <code class="prettyprint">/widget/change-environment/&lt;dataset id&gt;/&lt;env&gt;</code> and the the PATCH <code class="prettyprint">/layer/change-environment/&lt;dataset id&gt;/&lt;env&gt;</code> endpoints respectively for more details.</li>
</ul>

<p>When passing new values for Object type fields, the new value will fully overwrite the previous one. It&rsquo;s up to you, as an API user, to build any merging logic into your application.</p>

<p>To perform this operation, the following conditions must be met:</p>

<ul>
<li>the user must be logged in and belong to the same application as the dataset</li>
<li>the user must match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code></li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<p>Use this endpoint when:</p>

<ul>
<li>Modifying the fields of a dataset, like name, and not the data itself.</li>
<li>Modifying the source of data for any dataset that&rsquo;s not document based (<code class="prettyprint">connectorType</code> values other than <code class="prettyprint">document</code>).</li>
<li>Making advanced changes to a dataset.</li>
</ul>

<h4 id="errors-for-updating-the-fields-of-a-dataset">Errors for updating the fields of a dataset</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to update a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset).</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You are trying to update a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Dataset with id <id> doesn&rsquo;t exist</td>
<td>A dataset with the provided id does not exist.</td>
</tr>
</tbody></table>

<h3 id="concatenate-and-append-data-to-a-document-based-dataset">Concatenate and append data to a document based dataset</h3>

<blockquote>
<p>Concatenate data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/concat <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "sources": ["&lt;csv1Url&gt;", "&lt;csv2Url&gt;", "&lt;csv3Url&gt;"],
    "dataPath": "data... etc"
}'</span>
</code></pre>
<blockquote>
<p>Append data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/append <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "sources": ["&lt;csvUrl&gt;"],
    "dataPath": "data... etc"
}'</span>
</code></pre>
<blockquote>
<p>Concatenate data using JSON array in post body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/concat <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "provider": "json",
    "data": [{},{}]
}'</span>
</code></pre>
<p>Using these endpoints, you can add more data to an already existing dataset. They are exclusively available for document based datasets - you&rsquo;ll get a <code class="prettyprint">404</code> error if you use them on a dataset of a different type. You can either provide the URL for the file containing the data you wish to add, or simply provide that data in the body of your request, as a JSON object.</p>

<p>These process are asynchronous and not instantaneous. Immediately when triggered, these requests will cause the dataset&rsquo;s <code class="prettyprint">status</code> to be set to <code class="prettyprint">pending</code>, meaning you will not be able to issue new overwrite, concatenate or append requests. Once the request has been fully processed, the status will be automatically set to <code class="prettyprint">saved</code>. Depending on factors like API load or the size of the data being uploaded, this may take from a few minutes to a few hours to occur. The API does not issue any notification when the asynchronous operation is finished.</p>

<p>In order to perform these operation, the following conditions must be met:</p>

<ul>
<li>the dataset&rsquo;s <code class="prettyprint">overwrite</code> property must be set to <code class="prettyprint">true</code>.</li>
<li>the dataset&rsquo;s <code class="prettyprint">status</code> property must be set to <code class="prettyprint">saved</code>.</li>
<li>the user must be logged in and match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code> and belong to the same application as the dataset</li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<p>While they ultimately achieve a very similar end result, concatenate and append rely on different internal processes, each with its own characteristics.</p>

<ul>
<li>The concatenate process relies on a slower approach to ensure the operation is atomic. Until the operation is completed, you will see the dataset data as it was before the concatenate operation was triggered. If the operation fails, the old version of the data is kept accessible as it was before the concatenation process was started. There&rsquo;s a known issue where concatenating new data to already existing large datasets may result in failure.</li>
<li>The append operation relies on a faster process that does not offer atomicity. The new data is simply added to the current dataset, and any queries done while this process is taking place may produce results based on the preexisting data mixed with parts of the newly added values. Should the operation fail halfway, your dataset may contain all the preexisting records as well as part (but not all) of the newly added ones.</li>
</ul>

<aside class="notice">
    Using the previous <code class="prettyprint">url</code> field to pass the url of a single file is still permitted but is now deprecated in favor of <code class="prettyprint">sources</code>.
</aside>

<p>Here&rsquo;s a more detailed description of the request&rsquo;s body fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td style="text-align: center">Dataset provider this include inner connectors and 3rd party ones</td>
<td style="text-align: right">String</td>
<td style="text-align: right">A valid dataset provider</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>sources</td>
<td style="text-align: center">List of URLs from which to source data</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">URL array</td>
<td style="text-align: right">Yes, unless JSON data is provided using the <code class="prettyprint">data</code> field</td>
</tr>
<tr>
<td>data</td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">[{},{},{}]</td>
<td style="text-align: right">Yes for JSON if <code class="prettyprint">sources</code> is not present</td>
</tr>
<tr>
<td>dataPath</td>
<td style="text-align: center">Path to the data in a JSON file-based datasets</td>
<td style="text-align: right">String</td>
<td style="text-align: right">&ldquo;</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<p><em>Tip: If you want to periodically and automatically concatenate data to your document based dataset, check out the <a href="#dataset-automatic-synchronization">dataset automatic synchronization</a> functionality.</em></p>

<p>Use this endpoint when:</p>

<ul>
<li>Adding new data to an existing document based dataset, without modifying/removing the existing one.</li>
</ul>

<h4 id="errors-for-concatenating-and-appending-data-to-a-document-based-dataset">Errors for concatenating and appending data to a document based dataset</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Dataset is not in saved status</td>
<td>The dataset&rsquo;s <code class="prettyprint">status</code> value is not set to <code class="prettyprint">saved</code>. Refer to <a href="#dataset-reference">dataset reference</a> for more details on this field and its values.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to update a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset).</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You are trying to update a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Endpoint not found</td>
<td>A dataset with the provided id does not exist, or does not have <code class="prettyprint">connectorType</code> with value <code class="prettyprint">document</code>.</td>
</tr>
<tr>
<td>409</td>
<td>Dataset locked. Overwrite false.</td>
<td>The dataset you&rsquo;re trying to modify has <code class="prettyprint">overwrite</code> value set to <code class="prettyprint">false</code>, to explicitly prevent data modifications.</td>
</tr>
</tbody></table>

<h3 id="overwrite-data-for-a-document-based-dataset">Overwrite data for a document based dataset</h3>

<blockquote>
<p>Overwrite data using external data source:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/data-overwrite <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
   "sources": ["&lt;url of the data source&gt;"],
   "provider": "csv"
}'</span>
</code></pre>
<blockquote>
<p>Overwrite data using JSON array in post body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset_id/data-overwrite <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
   "data": [{},{}],
   "provider": "csv"
}'</span>
</code></pre>
<p>Using this endpoint, you can add or completely replace the data of an already existing dataset. 
It&rsquo;s exclusively available for document based datasets - you&rsquo;ll get a <code class="prettyprint">404</code> error if you use it on a dataset of a different type. 
All previously existing data will be permanently deleted. 
You can either provide the URL(s) for the file(s) containing the data you wish to add, or simply provide that data in the body of your request, as a JSON object. 
There are no requirements regarding similarity of the data structure between existing and new data - your overwrite data can have a completely different data schema.</p>

<p>This process is asynchronous and not instantaneous. Immediately when triggered, this request will cause the dataset&rsquo;s <code class="prettyprint">status</code> to be set to <code class="prettyprint">pending</code>, meaning you will not be able to issue new overwrite or concat requests, and will not yet be able to access the new data yet. Once the request has been fully processed, the status will be automatically set to <code class="prettyprint">saved</code> and the new data will be accessible. Depending on factors like API load or the size of the data being uploaded, this may take from a few minutes to a few hours to occur. The API does not issue any notification when the asynchronous operation is finished.</p>

<p>In order to perform this operation, the following conditions must be met:</p>

<ul>
<li>the dataset&rsquo;s <code class="prettyprint">overwrite</code> property must be set to <code class="prettyprint">true</code>.</li>
<li>the dataset&rsquo;s <code class="prettyprint">status</code> property must be set to <code class="prettyprint">saved</code>.</li>
<li>the user must be logged in and match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code> and belong to the same application as the dataset</li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<p>Here&rsquo;s a more detailed description of the request&rsquo;s body fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td style="text-align: center">Dataset provider this include inner connectors and 3rd party ones</td>
<td style="text-align: right">String</td>
<td style="text-align: right">A valid dataset provider</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>sources</td>
<td style="text-align: center">List of URLs from which to source data</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">URL array</td>
<td style="text-align: right">Yes, unless JSON data is provided using the <code class="prettyprint">data</code> field</td>
</tr>
<tr>
<td>data</td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">[{},{},{}]</td>
<td style="text-align: right">Yes for JSON if <code class="prettyprint">sources</code> is not present</td>
</tr>
<tr>
<td>legend</td>
<td style="text-align: center">The schema of the new data. If none is provided, a guessing mechanism will be used. The existing <code class="prettyprint">legend</code> value of the dataset will be ignored and overwritten in all <code class="prettyprint">overwrite</code> operations. See <a href="#legend">the legend section</a> above for more details.</td>
<td style="text-align: right">Object</td>
<td style="text-align: right"></td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<p><em>Tip: If you want to periodically and automatically overwrite the data on your document based dataset, check out the <a href="#dataset-automatic-synchronization">dataset automatic synchronization</a> functionality.</em></p>

<h4 id="errors-for-overwriting-data-for-a-document-based-dataset">Errors for overwriting data for a document based dataset</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Dataset is not in saved status</td>
<td>The dataset&rsquo;s <code class="prettyprint">status</code> value is not set to <code class="prettyprint">saved</code>. Refer to <a href="#dataset-reference">dataset reference</a> for more details on this field and its values.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to update a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset).</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You are trying to update a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Endpoint not found</td>
<td>A dataset with the provided id does not exist, or does not have <code class="prettyprint">connectorType</code> with value <code class="prettyprint">document</code>.</td>
</tr>
<tr>
<td>409</td>
<td>Dataset locked. Overwrite false.</td>
<td>The dataset you&rsquo;re trying to modify has <code class="prettyprint">overwrite</code> value set to <code class="prettyprint">false</code>, to explicitly prevent data modifications.</td>
</tr>
</tbody></table>

<p>Use this endpoint when:</p>

<ul>
<li>Fully replacing the data of an existing document based dataset, while keeping other values like id or name.</li>
<li>Modifying the structure of the data for a document based dataset.</li>
</ul>

<h2 id="cloning-a-dataset">Cloning a dataset</h2>

<blockquote>
<p>Example request for cloning a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/5306fd54-df71-4e20-8b34-2ff464ab28be/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "datasetUrl": "/query/5306fd54-df71-4e20-8b34-2ff464ab28be?sql=select%20%2A%20from%20data%20limit%2010",
    "application": [
      "your",
      "apps"
    ],
    "legend": {...},
    "applicationConfig" : {...}
  }
}'</span>
</code></pre>
<p>This endpoint allows you to create a new, json based dataset, from the result of a RW API endpoint call. The basic usage example would be to create a new dataset based on a custom query to an existing dataset - this is illustrated in the example <code class="prettyprint">curl</code> call in this section. Other use cases could be converting the result of an analysis endpoint into a dataset, or capturing the result of a query to a REST based dataset (cartodb, arcgis, etc) to an internal json representation of the same data, that is kept in the API database.   </p>

<p>In order to perform this operation, the following conditions must be met:</p>

<ul>
<li>the user must belong to the applications specified in the request body.</li>
<li>the user must be logged in and match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code></li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<p>The request requires two fields to be present:</p>

<ul>
<li><code class="prettyprint">datasetUrl</code>: the URL from where to load the data to populate the new dataset. Must be RW API, relative path, like <code class="prettyprint">/query/5306fd54-df71-4e20-8b34-2ff464ab28be?sql=select%20%2A%20from%20data%20limit%2010</code>.</li>
<li><code class="prettyprint">application</code>: the array of applications to which the new dataset will belong.</li>
</ul>

<p>Additionally, you can optionally specify these fields:</p>

<ul>
<li><code class="prettyprint">legend</code>: field structure and type of the new dataset. Refer to <a href="#dataset-reference">dataset reference</a> for more details.</li>
<li><code class="prettyprint">applicationConfig</code>: application-specific configuration. Refer to <a href="#dataset-reference">dataset reference</a> for more details. If not provided, it will be copied from the original dataset.</li>
<li><code class="prettyprint">published</code>: if the user has <code class="prettyprint">ADMIN</code> role, they can set this value to <code class="prettyprint">true</code>. </li>
</ul>

<p>For the fields in the following list, values will be copied from the original dataset to the new one, unless specified:</p>

<ul>
<li><code class="prettyprint">name</code>: copied from the original dataset, with a timestamp appended, to ensure uniqueness.</li>
<li><code class="prettyprint">subtitle</code></li>
<li><code class="prettyprint">dataPath</code>: will always be set to <code class="prettyprint">data</code>, matching the expected response structure of RW API responses like <code class="prettyprint">/query</code> that encapsulate the &quot;real&rdquo; data in a <code class="prettyprint">data</code> json object.</li>
<li><code class="prettyprint">connectorType</code>: will be set to <code class="prettyprint">document</code></li>
<li><code class="prettyprint">provider</code>: will be set to <code class="prettyprint">json</code></li>
<li><code class="prettyprint">attributesPath</code></li>
<li><code class="prettyprint">tableName</code></li>
<li><code class="prettyprint">dataLastUpdated</code></li>
<li><code class="prettyprint">overwrite</code></li>
<li><code class="prettyprint">published</code>: if the user has role <code class="prettyprint">ADMIN</code> and does not explicitly set <code class="prettyprint">published</code> to <code class="prettyprint">true</code> on the request body, this value is inherited. Otherwise, it&rsquo;s set to <code class="prettyprint">false</code>.</li>
</ul>

<p>Datasets created through a cloning operation will have a specific <code class="prettyprint">clonedHost</code> object, with additional data. Refer to <a href="#dataset-reference">dataset reference</a> for more details on the content of this field. </p>

<p>The dataset cloning requests accepts an optional <code class="prettyprint">full</code> boolean query parameter that, when set to <code class="prettyprint">true</code>, will clone of vocabulary-related data and metadata from the original dataset to the new one.</p>

<h4 id="errors-for-cloning-a-dataset">Errors for cloning a dataset</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td><field>: <field> can not be empty.</td>
<td>The required field identified in the error message is missing in the request body.</td>
</tr>
<tr>
<td>400</td>
<td>- application: must be a non-empty array -</td>
<td><code class="prettyprint">application</code> must be specified as an array.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to clone a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset).</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden - User does not have access to this dataset&rsquo;s application</td>
<td>You specified an <code class="prettyprint">application</code> in your request body that is not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Dataset with id <id> doesn&rsquo;t exist</td>
<td>A dataset with the provided id does not exist.</td>
</tr>
</tbody></table>

<h2 id="deleting-a-dataset">Deleting a dataset</h2>

<p>Use this endpoint if you wish to delete a dataset. Deleting a dataset of type document (<code class="prettyprint">connectorType</code> with value <code class="prettyprint">document</code>) will cause the API&rsquo;s internal copy of said data to be deleted. Dataset types that proxy data from an external source (ie. carto, gee, etc) will be deleted without modifying said external source.</p>

<p>When deleting a dataset that is associated with multiple <code class="prettyprint">application</code> values, the user issuing the request must be associated with all of them in order for the dataset to be deleted. If that&rsquo;s not the case, the <code class="prettyprint">application</code> values associated with the user will be removed from the dataset&rsquo;s <code class="prettyprint">application</code> list, and no further action will be taken - the dataset itself and its associated resources will continue to exist. The dataset is only actually deleted if the user has access to all of the <code class="prettyprint">application</code> to which the dataset belongs. </p>

<p>Besides deleting the dataset itself, this endpoint also deletes graph vocabularies, layers, widgets and metadata related to the dataset itself. These delete operations are issued in this order, and prior to deleting the dataset itself, but are not atomic - if one of them fails (for example, if attempting to delete a protected resource), the following ones are canceled, but the already deleted elements are not restored. </p>

<p>In order to delete a dataset, the following conditions must be met:</p>

<ul>
<li>the dataset&rsquo;s <code class="prettyprint">protected</code> property must be set to <code class="prettyprint">false</code>.</li>
<li>the user must be logged in and belong to the same application as the dataset</li>
<li>the user must match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code></li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<blockquote>
<p>Example request for deleting a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Dataset is protected</td>
<td>You are attempting to delete a dataset that has <code class="prettyprint">protected</code> set to prevent deletion.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to delete a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You are trying to delete a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Dataset with id <id> doesn&rsquo;t exist</td>
<td>A dataset with the provided id does not exist.</td>
</tr>
</tbody></table>

<h2 id="dataset-automatic-synchronization">Dataset automatic synchronization</h2>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
<span class="s1">'{
    "connectorType":"document",
    "provider":"csv",
    "connectorUrl":"&lt;csvUrl&gt;",
    "application":[
     "your", "apps"
    ],
    "name":"Example SYNC Dataset",
    "overwrite": true,
    "sync": {
        "action":"concat",
        "cronPattern":"0 * * * * *",
        "url":"&lt;updateCsvUrl&gt;"
    }
}'</span>
</code></pre>
<p>Certain datasets contain data that evolves frequently over time, and you, as the creator of this dataset, what to ensure that it&rsquo;s up-to-date. As we&rsquo;ve seen before, if your data is hosted on one of the supported 3rd party data providers, like Carto or Arcgis, your data will be proxied, so users of the RW API will always see the latest version of your data. However, if you uploaded your data from a file, your data is copied to the RW API database at the time of the dataset&rsquo;s creation, so keeping it up-to-date requires a different approach. It&rsquo;s with scenario in mind that the RW API offers the automatic synchronization mechanism.</p>

<p>The automatic synchronization mechanism is available for document based datasets only, and you can configure it when <a href="#creating-a-dataset">creating</a> or <a href="#updating-the-fields-of-a-dataset">updating</a> a dataset. When enabled, it will schedule an automatic, periodic task, that will update your document based dataset&rsquo;s data, based on data from an URL you provide. This means that, once configured, you just have to make sure the automatic synchronization mechanism can find the newest version of the data at the specified URL, and the RW API will take care of the actual data update process for you.</p>

<p>To configure automatic synchronization on dataset creation or update, you need to pass a <code class="prettyprint">sync</code> object on your calls to the respective endpoints, next to the other fields. See the included example for a clearer idea of how creating a dataset with automatic synchronization looks like.</p>

<p>There are 3 fields, all required, that you need to specify inside the <code class="prettyprint">sync</code> object:</p>

<ul>
<li><code class="prettyprint">action</code>: choose either <code class="prettyprint">concat</code> or <code class="prettyprint">overwrite</code>. See more details above about <a href="#concatenate-and-append-data-to-a-document-based-dataset">concatenating</a> and <a href="#overwrite-data-for-a-document-based-dataset">overwriting</a> dataset data. Append operations, as documented in the section above, is not supported.</li>
<li><code class="prettyprint">cronPattern</code>: <a href="https://en.wikipedia.org/wiki/Cron">cron</a> expression representing when and how frequently the synchronization process should take place. The host executing these tasks use UTC timezone.</li>
<li><code class="prettyprint">url</code>: publicly available URL from where the automatic synchronization mechanism will load the data to replace/concatenate to your dataset. </li>
</ul>

<p>Internally, the automatic synchronization mechanism will call either the <a href="#concatenate-and-append-data-to-a-document-based-dataset">dataset concatenation</a> or <a href="#overwrite-data-for-a-document-based-dataset">dataset overwrite</a> endpoint. 
If that internal request fails - for example, if <code class="prettyprint">overwrite</code> is set to <code class="prettyprint">false</code> - the sync process will fail silently. 
If you have the <code class="prettyprint">ADMIN</code> role, you can use the <code class="prettyprint">/v1/task</code> endpoint to see scheduled tasks and their error output, but otherwise this failure will be invisible to end users.</p>

<p>On the other hand, if the request goes through, but the concatenation/overwrite process fails - for example, if the URL provided is not available - then your dataset <code class="prettyprint">status</code> will be set to <code class="prettyprint">error</code> and the <code class="prettyprint">errorMessage</code> field will give you a simple description of what happened.</p>

<p>To see the details (including the date) of the last operation performed on the dataset, use the link in the <code class="prettyprint">taskId</code> field.</p>

<h2 id="flush-dataset-cache">Flush dataset cache</h2>

<blockquote>
<p>Flush dataset&rsquo;s cache</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/0c630feb-8146-4fcc-a9be-be5adcb731c8/flush <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight shell"><code>OK
</code></pre>
<p>Flushes the cache for the specified dataset. Take into account that only the dataset itself, query results and fields will be flushed. Any other relation, like metadata, layers or widgets linked to the specified dataset will not be affected by this action.</p>

<p>In order to flush a dataset&rsquo;s cache, the following conditions must be met:</p>

<ul>
<li>the user must be logged in.</li>
<li>the user must match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code></li>
<li>have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</li>
</ul></li>
</ul>

<h4 id="errors-for-flushing-a-dataset-39-s-cache">Errors for flushing a dataset&rsquo;s cache</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged in to be able to delete a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to either have the <code class="prettyprint">ADMIN</code> role, or have role <code class="prettyprint">MANAGER</code> and be the dataset&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the dataset)</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You are trying to delete a dataset with one or more <code class="prettyprint">application</code> values that are not associated with your user account.</td>
</tr>
<tr>
<td>404</td>
<td>Dataset with id <id> doesn&rsquo;t exist</td>
<td>A dataset with the provided id does not exist.</td>
</tr>
</tbody></table>

<h2 id="recover">Recover</h2>

<blockquote>
<p>Recover dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/0c630feb-8146-4fcc-a9be-be5adcb731c8/recover <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight shell"><code>OK
</code></pre>
<p>Resets a dataset&rsquo;s <code class="prettyprint">status</code> to <code class="prettyprint">saved</code> and clears its errors. Keep in mind that this does NOT modify the dataset in any other way - if the underling dataset&rsquo;s data was inconsistent for any reason, this endpoint will not change it, and it&rsquo;s up to you to fix it using a <code class="prettyprint">data-overwrite</code> or other endpoints.</p>

<p>In order to recover a dataset, the user must be logged in and have the <code class="prettyprint">ADMIN</code> role.</p>

<h4 id="errors-for-recovering-a-dataset-39-s-cache">Errors for recovering a dataset&rsquo;s cache</h4>

<table><thead>
<tr>
<th>Error code</th>
<th>Error message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>You need to be logged with to be able to delete a dataset.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>You need to have the <code class="prettyprint">ADMIN</code> role.</td>
</tr>
<tr>
<td>404</td>
<td>Dataset with id <id> doesn&rsquo;t exist</td>
<td>A dataset with the provided id does not exist.</td>
</tr>
</tbody></table>

<h2 id="dataset-reference">Dataset reference</h2>

<p>This section gives you a complete view at the properties that are maintained as part of dataset. When interacting with a dataset (on get, on create, etc) you will find most of these properties available to you, although they may be organized in a slightly different structure (ie: on get, everything but the <code class="prettyprint">id</code> is nested inside an <code class="prettyprint">attributes</code> object).</p>

<p>You can find more details in the <a href="https://github.com/resource-watch/dataset/blob/master/app/src/models/dataset.model.js">source code</a>.</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Type</th>
<th>Required</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>Yes (autogenerated)</td>
<td></td>
<td>Unique Id of the dataset. Auto generated on creation. Cannot be modified by users.</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Yes</td>
<td></td>
<td>Name of the dataset.</td>
</tr>
<tr>
<td>slug</td>
<td>String</td>
<td>Yes (autogenerated)</td>
<td></td>
<td>Slug of the dataset. Auto generated on creation. Cannot be modified by users.</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Type of the dataset.</td>
</tr>
<tr>
<td>subtitle</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Subtitle of the dataset.</td>
</tr>
<tr>
<td>application</td>
<td>Array</td>
<td>Yes</td>
<td></td>
<td>Applications associated with this dataset.</td>
</tr>
<tr>
<td>applicationConfig</td>
<td>Object</td>
<td>No</td>
<td></td>
<td>Key-value storage of application-specific data. Use the <code class="prettyprint">application</code> value as key and a JSON Object as the value to store complex, extensible data.</td>
</tr>
<tr>
<td>dataPath</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Path to the data in a JSON file-based datasets.</td>
</tr>
<tr>
<td>attributesPath</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>connectorType</td>
<td>String</td>
<td>Yes</td>
<td></td>
<td>Type of connector. <code class="prettyprint">wms</code> for WMS-based datasets, <code class="prettyprint">rest</code> for datasets that rely on external data sources (carto, arcgis, etc) or <code class="prettyprint">document</code> for file-based datasets (JSON, CSV, etc).</td>
</tr>
<tr>
<td>provider</td>
<td>String</td>
<td>Yes</td>
<td></td>
<td>Dataset provider.</td>
</tr>
<tr>
<td>userId</td>
<td>String</td>
<td>Yes (autopopulated)</td>
<td></td>
<td>Id of the user who created the dataset. Set automatically on creation. Cannot be modified by users.</td>
</tr>
<tr>
<td>connectorUrl</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Path to the source of the data. On datasets with <code class="prettyprint">document</code> connectorType, <code class="prettyprint">sources</code> should be used instead.</td>
</tr>
<tr>
<td>sources</td>
<td>Array</td>
<td>No</td>
<td>null</td>
<td>Path to the source files of the data. Only used on datasets with <code class="prettyprint">document</code> connectorType.</td>
</tr>
<tr>
<td>tableName</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Additional value used to locate the dataset within a given underlying provider. Refer to the documentation of the different connector for more details.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>No</td>
<td>pending</td>
<td>Status of the dataset. <code class="prettyprint">saved</code> means the dataset is available to use, <code class="prettyprint">pending</code> means an operation is ongoing and the dataset is temporarily unavailable, <code class="prettyprint">error</code> means the dataset is in an invalid state and requires further action before becoming available.</td>
</tr>
<tr>
<td>overwrite</td>
<td>Boolean</td>
<td>No</td>
<td>false</td>
<td>If the data can be overwritten (only for being able to update dataset)</td>
</tr>
<tr>
<td>errorMessage</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>If this dataset is in <code class="prettyprint">error</code> state, this field may contain additional details about the error.</td>
</tr>
<tr>
<td>mainDateField</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>published</td>
<td>Boolean</td>
<td>Yes</td>
<td>true</td>
<td>If the dataset is published or not.</td>
</tr>
<tr>
<td>env</td>
<td>String</td>
<td>Yes</td>
<td>production</td>
<td>Environment to which the dataset belongs.</td>
</tr>
<tr>
<td>geoInfo</td>
<td>Boolean</td>
<td>Yes</td>
<td>false</td>
<td>If it contains interceptable geographical info</td>
</tr>
<tr>
<td>protected</td>
<td>Boolean</td>
<td>Yes</td>
<td>false</td>
<td>If the dataset is protected. A protected dataset cannot be deleted.</td>
</tr>
<tr>
<td>taskId</td>
<td>String</td>
<td>No</td>
<td>null</td>
<td>Id of the latest task associated with this dataset. Typically only present in <code class="prettyprint">document</code> connectorType datasets</td>
</tr>
<tr>
<td>subscribable</td>
<td>Object</td>
<td>No</td>
<td></td>
<td>Information about the dataset being subscribable for alerts. More info about this can be found on the <a href="#subscriptions">Subscriptions</a> section of the docs.</td>
</tr>
<tr>
<td>legend.lat</td>
<td>String</td>
<td>No</td>
<td></td>
<td>Dataset field representing a latitude value.</td>
</tr>
<tr>
<td>legend.long</td>
<td>String</td>
<td>No</td>
<td></td>
<td>Dataset field representing a longitude value.</td>
</tr>
<tr>
<td>legend.*</td>
<td>Array</td>
<td>No</td>
<td></td>
<td>Different keys corresponding to data types. Each key may have an array of strings, referencing dataset fields that match that data type. Used functionally for document-based datasets, but may also be set by the user as reference for other types. See <a href="#using-the-legend-fields-to-define-field-types">this section</a> for more details.</td>
</tr>
<tr>
<td>clonedHost.hostProvider</td>
<td>String</td>
<td>No</td>
<td></td>
<td>When cloning a dataset, this will retain the <code class="prettyprint">provider</code> value of the original dataset.</td>
</tr>
<tr>
<td>clonedHost.hostUrl</td>
<td>String</td>
<td>No</td>
<td></td>
<td>When cloning a dataset, this will retain the <code class="prettyprint">connectorUrl</code> value of the original dataset.</td>
</tr>
<tr>
<td>clonedHost.hostId</td>
<td>String</td>
<td>No</td>
<td></td>
<td>When cloning a dataset, this will retain the <code class="prettyprint">Id</code> value of the original dataset.</td>
</tr>
<tr>
<td>clonedHost.hostType</td>
<td>String</td>
<td>No</td>
<td></td>
<td>When cloning a dataset, this will retain the <code class="prettyprint">connectorType</code> value of the original dataset.</td>
</tr>
<tr>
<td>clonedHost.hostPath</td>
<td>String</td>
<td>No</td>
<td></td>
<td>When cloning a dataset, this will retain the <code class="prettyprint">tableName</code> value of the original dataset.</td>
</tr>
<tr>
<td>widgetRelevantProps</td>
<td>Array</td>
<td>No</td>
<td></td>
<td>Group of relevant props of a widget.</td>
</tr>
<tr>
<td>layerRelevantProps</td>
<td>Array</td>
<td>No</td>
<td></td>
<td>Group of relevant props of a layer.</td>
</tr>
<tr>
<td>dataLastUpdated</td>
<td>Date</td>
<td>No</td>
<td></td>
<td>User defined date of when a dataset was last updated.</td>
</tr>
<tr>
<td>userName</td>
<td>String</td>
<td>No (autogenerated)</td>
<td>null</td>
<td>Name of the user who created the dataset. This value is used only internally, and is never directly exposed through the API. Cannot be modified by users.</td>
</tr>
<tr>
<td>userRole</td>
<td>String</td>
<td>No (autogenerated)</td>
<td>null</td>
<td>Role of the user who created the dataset. This value is used only internally, and is never directly exposed through the API. Cannot be modified by users.</td>
</tr>
<tr>
<td>createdAt</td>
<td>Date</td>
<td>No (autogenerated)</td>
<td><current date></td>
<td>Automatically maintained date of when the dataset was created. Cannot be modified by users.</td>
</tr>
<tr>
<td>updatedAt</td>
<td>Date</td>
<td>No (autogenerated)</td>
<td><current date></td>
<td>Automatically maintained date of when the dataset was last updated. Cannot be modified by users.</td>
</tr>
</tbody></table>

          <h1 id="widget">Widget</h1>

<h2 id="what-is-a-widget">What is a Widget?</h2>

<p>A widget is a graphic representation of a Dataset&rsquo;s data. Most of them are defined with <a href="#what-is-vega">Vega grammar</a> but we can also find other custom definitions. Here are the <a href="https://github.com/resource-watch/notebooks/blob/develop/ResourceWatch/Api_definition/widget_definition.ipynb">RW widgets definitions</a>.</p>

<p>Widgets contain the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>slug</td>
<td style="text-align: center">Unique identifier of the widget</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the widget</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset that the widget belongs</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template (base schema to create other widgets)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s a default widget for the dataset that it belongs</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected widget (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment can be one of <code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code>. <em>By default, it&rsquo;s set to &ldquo;production&rdquo; unless specified otherwise on creation/update</em></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>thumbnailUrl</td>
<td style="text-align: center">Url of the widget&rsquo;s thumbnail, if one exists</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Date in which the widget was created</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Date in which the widget was last updated</td>
<td style="text-align: right">Date</td>
</tr>
</tbody></table>

<h3 id="what-is-vega">What is Vega?</h3>

<p>Vega is a visualization grammar; a declarative format for creating, saving and sharing interactive visualization designs. This wiki contains documentation and learning materials for getting up and running with Vega. <a href="https://github.com/vega/vega/wiki">More info</a></p>

<h2 id="how-obtain-a-single-widget">How obtain a single widget</h2>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="customize-the-query-url-of-a-widget">Customize the query url of a widget</h3>

<p>The <code class="prettyprint">queryUrl</code> query parameter can be set if the user needs to modify the final url that will be requested. All parameters indicated in the <code class="prettyprint">queryUrl</code> will be pass to the microservice.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/049f074a-3528-427d-922b-3c2320e9caf6?queryUrl<span class="o">=</span>/v1/query?sql<span class="o">=</span>Select%20<span class="k">*</span>%20from%20data&amp;geostore<span class="o">=</span>ungeostore
</code></pre>
<h3 id="include-related-entities">Include related entities</h3>

<p>When loading widget data, you can optionally pass an <code class="prettyprint">includes</code> query argument to load additional data.</p>

<h4 id="vocabulary">Vocabulary</h4>

<p>Loads related vocabularies. If none are found, an empty array is returned.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943?includes<span class="o">=</span>vocabulary
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"vocabulary"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="user">User</h4>

<p>Loads the name and email address of the author of the widget. If you request this issue as an authenticated user with ADMIN role, you will additionally get the author&rsquo;s role.</p>

<p>If the data is not available (for example, the user has since been deleted), no <code class="prettyprint">user</code> property will be added to the widget object.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943?includes<span class="o">=</span>user
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Sample"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.sample@vizzuality.com"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="metadata">Metadata</h4>

<p>Loads the metadata available for the widget. If none are found, an empty array is returned.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943?includes<span class="o">=</span>metadata
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5aeb1c74a096b50010f3843f"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"86777822-d995-49cd-b9c3-d4ea4f82c0a3"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="w">
                  </span><span class="p">},</span><span class="w">
                  </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"widgetLinks"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                  </span><span class="p">},</span><span class="w">
                  </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-05-03T14:28:04.482Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-07T11:30:40.054Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="requesting-multiple-additional-entities">Requesting multiple additional entities</h4>

<p>You can request multiple related entities in a single request using commas to separate multiple keywords</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget/51851e22-1eda-4bf5-bbcc-cde3f9a3a943?includes<span class="o">=</span>metadata,user,vocabulary
</code></pre>
<h2 id="how-to-obtain-all-widgets">How to obtain all widgets</h2>

<p>To obtain all widgets:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<aside class="success">
Remember — <strong>the resulting list is filtered by env=production</strong> unless another env is explicitly provided as a query param. <i>A list of environments can also be provided such as e.g. &ldquo;env=production,preproduction&rdquo;</i>.
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"8f67fadd-d8df-4a28-82dd-a22a337d71b9"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:[</span><span class="w">
               </span><span class="s2">"aqueduct"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="s2">"percentage-of-country-s-population-is-at-high-risk-of-hunger"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Percentage of country's population at high risk of hunger."</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="s2">"f1d24950-c764-4f90-950a-4541f798eb95"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="s2">"query/f1d24950-c764-4f90-950a-4541f798eb95?sql=select * from crops"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:{</span><span class="w">
                </span><span class="err">...</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="kc">false</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"first"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prev"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=2&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=64&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/widget?page%5Bnumber%5D=1&amp;page%5Bsize%5D=10"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">372</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Available filters parameters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Filter the widgets whose name contains the filter text</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">Filter the widgets by dataset uuid</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align: center">Sort json response by specific attributes</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter widgets on published status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">Filter widgets on freeze status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">Filter by verified status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">Filter by template status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">Filter by default status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>app</td>
<td style="text-align: center">Filter widgets on application (prep, gfw, etc..)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment can be one of <code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>userId</td>
<td style="text-align: center">Filter widgets created by a specific user</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>favourite</td>
<td style="text-align: center">Filter favourited widgets of an user</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>collection</td>
<td style="text-align: center">Filter widgets based on an user collection</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>user.role</td>
<td style="text-align: center">The role of the user who created the layer. If the requesting user does not have the ADMIN role, this filter is ignored.</td>
<td style="text-align: right"><code class="prettyprint">ADMIN</code>, <code class="prettyprint">MANAGER</code> or <code class="prettyprint">USER</code></td>
</tr>
</tbody></table>

<aside class="notice">
   Using `userId` filter will return widgets created/cloned by the user. This filter is not compatible with `favourite` or `collection`.
   If you want to fetch favourited widgets, or specific ones from a collection, do not include the `userId` param.
</aside>

<blockquote>
<p>Return the widgets filtered whose name contains glad</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?name<span class="o">=</span>glad
</code></pre>
<blockquote>
<p>Return the widgets filtered by dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?dataset<span class="o">=</span>d02df2f6-d80c-4274-bb6f-f062061655c4
curl -X GET https://api.resourcewatch.org/v1/dataset/d02df2f6-d80c-4274-bb6f-f062061655c4/widget
</code></pre>
<blockquote>
<p>Sort by name</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Filter widgets by published status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?published<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Filter widgets by verified status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?verified<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Return the widgets filtered by template</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?template<span class="o">=</span><span class="nb">true</span>
</code></pre>
<blockquote>
<p>Filter widgets by default option</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?default<span class="o">=</span><span class="nb">true</span>
</code></pre>
<blockquote>
<p>Return widgets whose applications contain rw</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?app<span class="o">=</span>rw
</code></pre>
<h3 id="pagination-params">Pagination params</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">Number elements per page. There&rsquo;s a limit of 100 to the size of each page, which is not being enforced at the moment, but queries for larger page sizes are not supported. This means future requests may fail if not respecting the page size limit.</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">Number of page</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the widgets from page 2, with 5 elements per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?page[size]<span class="o">=</span>5&amp;page[number]<span class="o">=</span>2
</code></pre>
<h3 id="sorting">Sorting</h3>

<p>The API currently supports sorting by means of the <code class="prettyprint">sort</code> parameter. Sorting can be done using any field from the widget, as well as <code class="prettyprint">user.name</code> and <code class="prettyprint">user.role</code> (sorting by user data is restricted to ADMIN users).</p>

<p>Sorting by nested fields is not supported at the moment.</p>

<blockquote>
<p>Sorting widgets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>name
</code></pre>
<p>Multiple sorting criteria can be used, separating them by commas.</p>

<blockquote>
<p>Sorting widgets by multiple criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>name,slug
</code></pre>
<p>You can specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> or <code class="prettyprint">+</code>. By default, <code class="prettyprint">asc</code> order is assumed.</p>

<blockquote>
<p>Explicit order of sorting</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>-name,+slug
</code></pre>
<blockquote>
<p>Sorting widgets by the role of the user who owns the widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?sort<span class="o">=</span>user.role
</code></pre>
<h3 id="include-related-entities">Include related entities</h3>

<p>When loading widget data, you can optionally pass an <code class="prettyprint">includes</code> query argument to load additional data.</p>

<h4 id="vocabulary">Vocabulary</h4>

<p>Loads related vocabularies. If none are found, an empty array is returned.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?includes<span class="o">=</span>vocabulary
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"vocabulary"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="user">User</h4>

<p>Loads the name and email address of the author of the widget. If the data is not available (for example, the user has since been deleted), no <code class="prettyprint">user</code> property will be added to the widget object.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?includes<span class="o">=</span>user
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Sample"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.sample@vizzuality.com"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="metadata">Metadata</h4>

<p>Loads the metadata available for the widget. If none are found, an empty array is returned.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?includes<span class="o">=</span>metadata
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Carto Dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be76f130-ed4e-4972-827d-aef8e0dc6b18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-carto-dataset6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5820ad9469a0287982f4cd18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"rw"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"defaultEditableWidget"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"freeze"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-02-08T15:30:34.505Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5aeb1c74a096b50010f3843f"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"86777822-d995-49cd-b9c3-d4ea4f82c0a3"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51851e22-1eda-4bf5-bbcc-cde3f9a3a943"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="w">
                  </span><span class="p">},</span><span class="w">
                  </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="s2">"t"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"widgetLinks"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                  </span><span class="p">},</span><span class="w">
                  </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-05-03T14:28:04.482Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-07T11:30:40.054Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="requesting-multiple-additional-entities">Requesting multiple additional entities</h4>

<p>You can request multiple related entities in a single request using commas to separate multiple keywords</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/widget?includes<span class="o">=</span>metadata,user,vocabulary
</code></pre>
<h2 id="how-to-obtain-a-widget-for-a-specific-dataset">How to obtain a widget for a specific dataset</h2>

<p>To obtain the widget:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/d02df2f6-d80c-4274-bb6f-f062061655c4/widget/20ec7861-5251-40a7-9503-5ee3686a66a3
curl -X GET https://api.resourcewatch.org/v1/widget/20ec7861-5251-40a7-9503-5ee3686a66a3
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20ec7861-5251-40a7-9503-5ee3686a66a3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"widget"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57a0693b49c36b265ba3bec8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"rw"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"estimated-c02-emission"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Estimated C02 emission"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"layerId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d02df2f6-d80c-4274-bb6f-f062061655c4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"queryUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"query/d02df2f6-d80c-4274-bb6f-f062061655c4?sql=select country, rank, iso3, total from estimated_co2_emission_filtered"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"widgetConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"scales"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="s2">"padding"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"top"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
          </span><span class="s2">"left"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
          </span><span class="s2">"right"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
          </span><span class="s2">"bottom"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-17T17:50:45.655Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-06T15:12:38.749Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="create-a-widget">Create a Widget</h2>

<p>To create a widget, you need to define all of the required fields in the request body. The fields that compose a widget are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the widget belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid query</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Vega configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected widget (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s default for dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of layer</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment of the Widget. Set to &lsquo;production&rsquo; by default</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Valid string</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<p>It is possible to create a widget that has a different <code class="prettyprint">env</code> property to its parent dataset.</p>

<blockquote>
<p>To create a widget, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "widget": {
      "application":[
         "your", "apps"
      ],
      "name":"Example Carto Dataset"
      "published": true
   }
}'</span>
</code></pre>
<aside class="notice">
Creating a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="update-a-widget">Update a Widget</h2>

<p>To update a widget, you need to define all of the required fields in the request body. The fields that compose a widget are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the widget</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">Publisher of the original code</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>sourceUrl</td>
<td style="text-align: center">Link to publisher page</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the widget belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>authors</td>
<td style="text-align: center">Name of the authors</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>queryUrl</td>
<td style="text-align: center">Url with the data of the chart shows</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid query</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>widgetConfig</td>
<td style="text-align: center">Vega configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">If it&rsquo;s available to use</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>freeze</td>
<td style="text-align: center">If the data is frozen</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">If it&rsquo;s verified by other user</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>template</td>
<td style="text-align: center">If it&rsquo;s a template</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s default for dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true - false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>layerId</td>
<td style="text-align: center">UuId of the relationship with layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of layer</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment</td>
<td style="text-align: right">Text</td>
<td style="text-align: right"><code class="prettyprint">production</code> or <code class="prettyprint">preproduction</code></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<p>A user with role <code class="prettyprint">USER</code> can update their own widgets, based on the <code class="prettyprint">userId</code> field. A user with <code class="prettyprint">ADMIN</code> role can update any widget.</p>

<blockquote>
<p>To update a widget, you have to do a PATCH request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "widget": {
      "application":[
         "your", "apps"
      ],
      "name":"New Example Carto Dataset Name",
      "widgetConfig": {}
   }
}'</span>
</code></pre>
<aside class="notice">
Updating a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="clone-a-widget">Clone a Widget</h2>

<p>You can clone an existing widget as long as you have permissions to the applications associated with it. Basic usage requires no body params, but you can optionally pass a new <code class="prettyprint">name</code> or <code class="prettyprint">description</code> to be used in the creation of the new widget.</p>

<blockquote>
<p>To clone a widget, you should use one of the following POST requests:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<blockquote>
<p>You can optionally set a new name or description:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "name for the cloned widget",
   "description": "
   "name": "name for the cloned widget", for the cloned widget",
}'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "name": "name for the cloned widget",
   "description": "
   "name": "name for the cloned widget", for the cloned widget",
}'</span>
</code></pre>
<h3 id="cloning-widgets-from-other-microservices">Cloning widgets from other microservices</h3>

<p>When cloning a widget, the newly created clone will take the <code class="prettyprint">userId</code> of the originating request. If you call this endpoint as an authenticated user from your custom application, that means it will get that authenticated user&rsquo;s <code class="prettyprint">userId</code>. However, if invoked from another API microservice, that <code class="prettyprint">userId</code> is no longer available. In this scenario, when the request to clone is originated internally, you can optionally pass a <code class="prettyprint">userÌd</code> body value that will be set as the <code class="prettyprint">userId</code> of the newly created widget.</p>

<aside class="warning">
User IDs provided this way are not validated.
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/widget/&lt;widget_id&gt;/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;microservice-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "userId": "123456789",
}'</span>
</code></pre>
<aside class="notice">
Cloning a widget will cause a thumbnail to be generated in the background for the new widget. As it is generated asyncronously, the newly generated thumbnail url may only become available on subsequent requests.
</aside>

<h2 id="delete-a-widget">Delete a Widget</h2>

<p>Who can delete Widgets?</p>

<ul>
<li>Users with the <code class="prettyprint">MANAGER</code> role who are in the same app as the widget and are in the widget&rsquo;s <code class="prettyprint">userId</code></li>
<li>Users with the <code class="prettyprint">ADMIN</code> role who are in the same app as the widget.</li>
</ul>

<aside class="notice">
   The endpoints `/widget/:widget` and `/dataset/:dataset/widget/:widget` perform the same action, with the only difference being that the latter checks if the dataset exists before deleting the widget.
</aside>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/widget/&lt;widget_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="layer">Layer</h1>

<h2 id="what-is-a-layer">What is a Layer?</h2>

<p>A layer is a geographical representation of a Dataset&rsquo;s data.</p>

<p>Layer contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>slug</td>
<td style="text-align: center">Unique identifier of the layer</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the layer</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset that the layer belongs</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s a default layer for the dataset that it belongs</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Is the layer published?</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">environment in witch the layer was published, one of <code class="prettyprint">staging</code>, <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<h2 id="how-obtain-all-layers">How obtain all layers</h2>

<p>To obtain all layers:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"rw"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
              </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
              </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"first"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prev"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=2&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=64&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"https://api.resourcewatch.org/v1/layer?page%5Bnumber%5D=1&amp;page%5Bsize%5D=10"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">628</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="filter-params">Filter params</h3>

<p>Available filters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Filter the layers whose name contains the filter text</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">Filter the layers by dataset uuid</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align: center">Sort json response by specific attributes</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Filter layers on status (pending, saved, failed, all)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter layers on published status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>app</td>
<td style="text-align: center">Filter layers on application (prep, gfw, etc..)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment in witch the layer was published, one of <code class="prettyprint">staging</code>, <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code>. Defaults to <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>user.role</td>
<td style="text-align: center">The role of the user who created the layer. If the requesting user does not have the ADMIN role, this filter is ignored.</td>
<td style="text-align: right"><code class="prettyprint">ADMIN</code>, <code class="prettyprint">MANAGER</code> or <code class="prettyprint">USER</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers filtered by those whose name contains emissions</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?name<span class="o">=</span>emissions
</code></pre>
<blockquote>
<p>Return the layers filtered by dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?dataset<span class="o">=</span>11de2bc1-368b-42ed-a207-aaff8ece752b
curl -X GET https://api.resourcewatch.org/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer
</code></pre>
<blockquote>
<p>Sort by name</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Filter layers by status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?status<span class="o">=</span>failed
</code></pre>
<blockquote>
<p>Filter layers by published status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?published<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Filter layers by environment</p>
</blockquote>

<p>If no <code class="prettyprint">env</code> is specified, <code class="prettyprint">production</code> is used as default.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?env<span class="o">=</span>staging
</code></pre>
<blockquote>
<p>Return the layers filtered by those whose applications contain rw</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?app<span class="o">=</span>rw
</code></pre>
<h3 id="pagination-params">Pagination params</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">Number elements per page. There&rsquo;s a limit of 100 to the size of each page, which is not being enforced at the moment, but queries for larger page sizes are not supported. This means future requests may fail if not respecting the page size limit.</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">Number of page</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers of page 2 with 5 elements per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?page[size]<span class="o">=</span>5&amp;page[number]<span class="o">=</span>2
</code></pre>
<h3 id="sorting">Sorting</h3>

<p>The API currently supports sorting by means of the <code class="prettyprint">sort</code> parameter. Sorting can be done using any field from the layer, as well as <code class="prettyprint">user.name</code> and <code class="prettyprint">user.role</code> (sorting by user data is restricted to ADMIN users).</p>

<p>Sorting by nested fields is not supported at the moment.</p>

<blockquote>
<p>Sorting layers</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>name
</code></pre>
<p>Multiple sorting criteria can be used, separating them by commas.</p>

<blockquote>
<p>Sorting layers by multiple criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>name,slug
</code></pre>
<p>You can specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> or <code class="prettyprint">+</code>. By default, <code class="prettyprint">asc</code> order is assumed.</p>

<blockquote>
<p>Explicit order of sorting</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>-name,+slug
</code></pre>
<blockquote>
<p>Sorting layers by the role of the user who owns the layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?sort<span class="o">=</span>user.role
</code></pre>
<h3 id="include-related-entities">Include related entities</h3>

<p>When loading layer data, you can optionally pass an <code class="prettyprint">includes</code> query argument to load additional data.</p>

<h4 id="vocabulary">Vocabulary</h4>

<p>Loads related vocabularies. If none are found, no <code class="prettyprint">vocabulary</code> property will be added to the layer object.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?includes<span class="o">=</span>vocabulary
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"rw"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
              </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
              </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"vocabulary"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="user">User</h4>

<p>Loads the name and email address of the author of the layer. If you request this issue as an authenticated user with ADMIN role, you will additionally get the author&rsquo;s role.</p>

<p>If the data is not available (for example, the user has since been deleted), no <code class="prettyprint">user</code> property will be added to the layer object.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?includes<span class="o">=</span>user
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"rw"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
              </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
              </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Doe"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.doe@vizzuality.com"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="requesting-multiple-additional-entities">Requesting multiple additional entities</h4>

<p>You can request multiple related entities in a single request using commas to separate multiple keywords</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/layer?includes<span class="o">=</span>user,vocabulary
</code></pre>
<h2 id="how-obtain-specific-layers">How obtain specific layers</h2>

<p>To obtain the layer:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
curl -X GET https://api.resourcewatch.org/v1/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"rw"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
          </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
      </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="include-related-entities">Include related entities</h3>

<p>You can load related <code class="prettyprint">user</code> and <code class="prettyprint">vocabulary</code> data in the same request. See <a href="#include-related-layer-entities">this section</a> for more details.</p>

<h2 id="create-a-layer">Create a Layer</h2>

<p>To create a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration, <a href="https://github.com/resource-watch/notebooks/blob/develop/ResourceWatch/Api_definition/layer_definition.ipynb">rw definition example</a></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">Isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true-false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment of the Layer. Set to &lsquo;production&rsquo; by default</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Valid string</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<p>It is possible to create a layer that has a different <code class="prettyprint">env</code> property to its parent dataset.</p>

<blockquote>
<p>To create a layer, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "application":[
       "your", "apps"
    ],
    "name":"Example layer",
    "status": 1
}'</span>
</code></pre>
<blockquote>
<p>The following structure was previously supported but should now be considered deprecated:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"Example layer",
      "status": 1
   }
}'</span>
</code></pre>
<h2 id="update-a-layer">Update a layer</h2>

<p>To update a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, rw, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">The environment to which the layer belongs</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a layer, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"New Example layer Name",
      "layerConfig": {}
   }
}'</span>
</code></pre>
<h2 id="delete-a-layer">Delete a Layer</h2>

<p>In order to perform this operation, the following conditions must be met:</p>

<ul>
<li>the layer&rsquo;s <code class="prettyprint">protected</code> property must be set to <code class="prettyprint">false</code>.</li>
<li>the user must be logged in and belong to the same application as the layer</li>
<li>the user must match one of the following:

<ul>
<li>have role <code class="prettyprint">ADMIN</code></li>
<li>have role <code class="prettyprint">MANAGER</code> and be the layer&rsquo;s owner (through the <code class="prettyprint">userId</code> field of the layer)</li>
</ul></li>
</ul>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="query">Query</h1>

<p>In order to retrieve data from the datasets it is possible to send queries to the API using the SQL or Feature Service languages.</p>

<p>Two different endpoints are provided (under the dataset path and a generic one) and the sql query can be provided via query parameters or in the body of a POST request.</p>
<pre class="highlight shell"><code>curl -i -H <span class="s1">'Authorization: Bearer your-token&gt;'</span> -H <span class="s1">'Content-Type: application/json'</span> -XPOST <span class="s1">'http://api.resourcewatch.org/v1/query/&lt;dataset_id&gt;/'</span> -d <span class="s1">'{
    "sql": "SELECT * FROM &lt;dataset_id&gt; limit 10"
}
'</span>
</code></pre><pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;
</code></pre>
<aside class="notice">
While we aim to make our query interface as broad and transparent as possible, some of the querying options described 
below will not be available for specific dataset providers, depending on this API&rsquo;s implementation or limitations on the
actual data provider&rsquo;s side.
</aside>

<h2 id="select-clause">Select clause</h2>

<p>The <code class="prettyprint">SELECT</code> part of the queries supports naming columns, <strong>alias</strong>, <strong>math operations</strong>, <strong>DISTINCT</strong>, <strong>COUNT</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">as</span> <span class="n">minimum</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="from-clause">From clause</h2>

<p>It is possible to refer to a dataset by using its <strong>table name</strong>, <strong>slug</strong> or <strong>id</strong>. </p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">tableName</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">slug</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">id</span><span class="o">&gt;</span>
</code></pre>
<h2 id="where-clause">Where clause</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">text</span> <span class="k">like</span> <span class="s1">'a%'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">st_intersects</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="s1">'{}'</span><span class="p">),</span> <span class="mi">4326</span><span class="p">),</span> <span class="n">the_geom</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="k">data</span> <span class="k">BETWEEN</span> <span class="mi">1</span> <span class="k">AND</span> <span class="mi">3</span>
</code></pre>
<h2 id="group-by-clause">Group by clause</h2>

<p>It is possible to group results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong>.
Special grouping operations are available for document-type datasets (CSV and JSON) - see <a href="https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql">this link</a> for more info.</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span><span class="p">,</span> <span class="n">columnTwo</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom_point</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">a</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</code></pre><pre class="highlight sql"><code><span class="cm">/* Only supported in document-type datasets - see https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql for full details */</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">range</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span> 
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_histogram</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'interval'</span><span class="o">=</span><span class="s1">'1d'</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_range</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'format'</span><span class="o">=</span><span class="s1">'yyyy-MM-dd'</span> <span class="p">,</span><span class="s1">'2014-08-18'</span><span class="p">,</span><span class="s1">'2014-08-17'</span><span class="p">,</span><span class="s1">'now-8d'</span><span class="p">,</span><span class="s1">'now-7d'</span><span class="p">,</span><span class="s1">'now-6d'</span><span class="p">,</span><span class="s1">'now'</span><span class="p">)</span>
</code></pre>
<h2 id="order-by-clause">Order by clause</h2>

<p>It is possible to order results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>

<h2 id="limit-and-offset-clause">Limit and offset clause</h2>

<p>You can specify <code class="prettyprint">limit</code> and <code class="prettyprint">offset</code> clauses</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span> <span class="k">offset</span> <span class="mi">10</span>
</code></pre>
<h2 id="raster-queries-available">Raster queries available</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="n">ST_METADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_BANDMETADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="n">occurrence</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_SUMMARYSTATS</span><span class="p">()</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_HISTOGRAM</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="freeze-query">Freeze query</h2>

<p>It is possible generate a json file in a bucket of the sql result. You only need send a query param freeze with value true and you will obtain the url of the json file.</p>

<aside class="notice">
    This is an authenticated feature!
</aside>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;&amp;freeze<span class="o">=</span><span class="nb">true</span>
</code></pre>
<h2 id="rasdaman-queries">Rasdaman queries</h2>

<p>SQL-like queries can be employed for accessing data stored in Rasdaman datasets. Subsets on the original axes of the data may be provided in the WHERE statement. So far, only operations that result in a single scalar can be obtained from Rasdaman - averages, minimums, maximums.</p>
<pre class="highlight shell"><code>curl -XGET https://api.resourcewatch.org/v1/query?sql<span class="o">=</span>SELECT avg<span class="o">(</span>Green<span class="o">)</span> from 18c0b71d-2f55-4a45-9e5b-c35db3ebfe94 where Lat &gt; 0 and  Lat &lt; 45 <span class="se">\</span>
    -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'Authorization: Bearer &lt;token&gt;'</span>
</code></pre>
<h2 id="nex-gddp-queries">NEX-GDDP queries</h2>

<p>A SQL wrapper is offered for accessing the NASA NEX-GDDP dataset with sql-like statements. The API stores calculated indexes over the original data, and several views over the data are available. These can be accessed in the following ways:</p>

<h3 id="spatial-aggregates-over-a-layer">Spatial aggregates over a layer</h3>

<p>Access spatial aggregates over the data by listing all dataset data for a particular year:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ </span>where<span class="se">\ </span>year<span class="se">\ \=\ </span>1960
</code></pre>
<p>Access particular aggregates:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ </span>avg<span class="se">\,\ </span>min<span class="se">\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ </span>where<span class="se">\ </span>year<span class="se">\ \=\ </span>1960
</code></pre>
<p>Calculate statistics for a range of years:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ \ </span>where<span class="se">\ </span>year<span class="se">\ </span>between<span class="se">\ </span>1960<span class="se">\ </span>and<span class="se">\ </span>1962
</code></pre>
<p>You can delimit an area of interest by providing a geostore id as a parameter:</p>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.resourcewatch.org/v1/query/b99c5f5e-00c6-452e-877c-ced2b9f0b393<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>nexgddp-historical-ACCESS1_0-prmaxday<span class="se">\ \ </span>where<span class="se">\ </span>year<span class="se">\ </span>between<span class="se">\ </span>1960<span class="se">\ </span>and<span class="se">\ </span>1962&amp;geostore<span class="se">\=</span>0279093c278a64f4c3348ff63e4cfce0
</code></pre>
<h2 id="download">Download</h2>

<p>You can download the result of a query using the <code class="prettyprint">download</code> endpoint. </p>

<aside class="warning">
    <ul>
    This endpoint is not supported for all the dataset providers. The following dataset connector provide support for downloads:
        <li>Google Earth Engine</li>
        <li>Document</li>
        <li>Carto</li>
        <li>BigQuery</li>
        <li>ArcGIS FeatureService</li>
    </ul>
</aside>
<pre class="highlight shell"><code><span class="c"># The id of the dataset is part of the URL</span>
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;

<span class="c"># The id of the dataset is in the FROM clause</span>
curl -XGET https://api.resourcewatch.org/v1/download?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.id&gt;
</code></pre>
<p>There are two ways to call it:</p>

<ul>
<li>you can either specify the id of the dataset in the URL</li>
<li>or you can pass it as part of the SQL query (in the FROM clause)</li>
</ul>

<p>You can also specify which file type you want to download (JSON or CSV), except for Google Earth Engine datasets (only JSON).</p>

<aside class="notice">
    By default, the API will return a CSV file (JSON file for Google Earth Engine).
</aside>
<pre class="highlight shell"><code><span class="c"># The format is explicitly set</span>
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>json
curl -XGET https://api.resourcewatch.org/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>csv
</code></pre>
          <h1 id="fields">Fields</h1>

<h2 id="what-are-fields">What are fields?</h2>

<p>Fields can be defined as the dataset properties. These fields are automatically generated when a dataset is created.</p>

<h2 id="how-to-get-the-dataset-fields">How to get the dataset fields</h2>

<p>Once the dataset is properly created and saved, it is possible to access to its fields as well as getting some information about them.</p>

<p>To do that, it is necessary to use of the following endpoint:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/fields/&lt;dataset-id&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/fields/1170030b-9725-4bfe-8fb4-1b0eb81020d2
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"public.cait_2_0_country_ghg_emissions_toplow2011"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"cartodb_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom_webmercator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="rasdaman">Rasdaman</h3>

<p>The structure of datacubes needs a more verbose field specification. The fields endpoint for rasdaman-backed datasets includes information on the spatial reference system, nodata values, axes, units, and bands. It looks like so:</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell"><code>curl -i  -XGET <span class="s1">'http://api.resourcewatch.org/v1/fields/491ae6fe-6767-44d1-b5c3-c7b8b384bb7a'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"coverageId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nightlights"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"srs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"srsDimension"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"srs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"crs/EPSG/0/4326"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"axisLabels"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lat Long"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uomLabels"</span><span class="p">:</span><span class="w"> </span><span class="s2">"degree degree"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"undefined"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"swe:nilValues"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"swe:NilValues"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"swe:nilValue"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
              </span><span class="s2">"$t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
              </span><span class="s2">"$t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"swe:uom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10^0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"coverageBounds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"upperCorner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"89.999999999966665 180.000000000189335"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lowerCorner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-89.999999999961335 -179.999999999666665"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="metadata">Metadata</h1>

<h2 id="metadata-definition">Metadata definition</h2>

<p>Metadata is data concerning another resource available on this API. It only exists when associated with another resource - currently supported resource types are datasets, widgets or layers. Note that, although there might be several metadata per resource, each resource will have - at most - one metadata element per <code class="prettyprint">application</code> and <code class="prettyprint">language</code> pair. As such, the <code class="prettyprint">application</code> and <code class="prettyprint">language</code> attributes are required and it is mandatory to include them in when creating/updating metadata.</p>

<p>Some fields are important to identify the entity properly; others are just optional and give extra information about it.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">The metadata application</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">The metadata language</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">The associated dataset id to the metadata</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>resource</td>
<td style="text-align: center">The resource associated to the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; id</td>
<td style="text-align: center">Resource id</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Resource type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">The metadata name</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">The metadata description</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">The metadata source</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">The metadata citation</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">The metadata license type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">Some info about the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">Measurement units</td>
<td style="text-align: right">Object</td>
</tr>
</tbody></table>

<h2 id="creating-a-metadata-object">Creating a metadata object</h2>

<p>As previously discussed, a metadata entity is always associated with either a dataset, a widget or a layer resource, and the type of resource it is associated
to dictates which of 3 endpoints you should use when creating a new metadata entity.</p>

<p>In all scenarios, you must be authenticated to be able to create a metadata entity, and meet the following requirements:</p>

<ul>
<li>Have the <code class="prettyprint">ADMIN</code> or <code class="prettyprint">MANAGER</code> role.</li>
<li>Belong to the same <code class="prettyprint">application</code> as the metadata being created. </li>
</ul>

<p>Any of these conditions are not met, the API will generate a 403 <code class="prettyprint">Forbidden</code> error message.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Required/Optional</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">optional</td>
</tr>
</tbody></table>

<aside class="notice">
Please, be sure that the request is properly authenticated and the current user has permission to the resource.
If you don&rsquo;t know how to do this, please go to the <a href="#authentication">Authentication section</a>
</aside>

<blockquote>
<p>Create metadata for a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Create metadata for a widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Create metadata for a layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "rw",
   "language": "en"
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="getting-metadata">Getting metadata</h2>

<p>application filter:
<code class="prettyprint">
application: gfw, gfw-climate, prep, rw, forest-atlas (select one or some of them)
</code></p>

<p>language filter:
<code class="prettyprint">
language: select between available languages (select one or some of them)
</code></p>

<p>limit filter:
<code class="prettyprint">
limit: the desired number
</code></p>

<p>Custom param for /metadata endpoint:
<code class="prettyprint">
type: [dataset, widget, layer]
</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/metadata
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata
</code></pre>
<h2 id="updating-a-metadata">Updating a metadata</h2>

<p>As previously discussed, a metadata entity is always associated with either a dataset, a widget or a layer resource, and the type of resource it is associated
to dictates which of 3 endpoints you should use when updating a metadata entity.</p>

<p>In all scenarios, you must be authenticated to be able to update a metadata entity, and meet the following requirements:</p>

<ul>
<li>Have the <code class="prettyprint">ADMIN</code> or <code class="prettyprint">MANAGER</code> role.</li>
<li>Belong to the same <code class="prettyprint">application</code> as the metadata being created. </li>
</ul>

<p>Any of these conditions are not met, the API will generate a 403 <code class="prettyprint">Forbidden</code> error message.</p>

<p>When updating a metadata, you must always specify both <code class="prettyprint">language</code> and <code class="prettyprint">application</code>, those will be used to determine which metadata entity will be updated.</p>

<blockquote>
<p>Update metadata for a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Update metadata for a widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Update metadata for a layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "rw",
   "language": "en",
   "name": "Cloud Computing Market - USA - 2016",
   "source": "http://www.forbes.com/",
   "info": {
       "summary": "These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales).",
       "author": "Louis Columbus",
       "date": "MAR 13, 2016 @ 10:42 PM",
       "link": "http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"
   }
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="deleting-a-metadata">Deleting a metadata</h2>

<p>As previously discussed, a metadata entity is always associated with either a dataset, a widget or a layer resource, and the type of resource it is associated
to dictates which of 3 endpoints you should use when deleting a metadata entity.</p>

<p>In all scenarios, you must be authenticated to be able to delete a metadata entity, and meet the following requirements:</p>

<ul>
<li>Have the <code class="prettyprint">ADMIN</code> or <code class="prettyprint">MANAGER</code> role.</li>
<li>Belong to the same <code class="prettyprint">application</code> as the metadata being created. </li>
</ul>

<p>Any of these conditions are not met, the API will generate a 403 <code class="prettyprint">Forbidden</code> error message.</p>

<p>When deleting a metadata, you must always specify both <code class="prettyprint">language</code> and <code class="prettyprint">application</code>, those will be used to determine which metadata entity will be deleted.</p>

<blockquote>
<p>Delete metadata for a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/metadata?application<span class="o">=</span>&lt;app-id&gt;&amp;language<span class="o">=</span>&lt;language&gt;
</code></pre>
<blockquote>
<p>Delete metadata for a widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/metadata?application<span class="o">=</span>&lt;app-id&gt;&amp;language<span class="o">=</span>&lt;language&gt;

</code></pre>
<blockquote>
<p>Delete metadata for a layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/metadata?application<span class="o">=</span>&lt;app-id&gt;&amp;language<span class="o">=</span>&lt;language&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata?application<span class="o">=</span>rw&amp;language<span class="o">=</span>en <span class="se">\</span>
</code></pre>
<h2 id="getting-all">Getting all</h2>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata
</code></pre>
<blockquote>
<p>Real examples</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?type<span class="o">=</span>widget
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?application<span class="o">=</span>rw&amp;language<span class="o">=</span>es,en&amp;limit<span class="o">=</span>20
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?application<span class="o">=</span>rw,gfw&amp;language<span class="o">=</span>en&amp;type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/metadata?language<span class="o">=</span>en
</code></pre>
<h2 id="finding-metadata-by-ids">Finding metadata by ids</h2>

<p>The <code class="prettyprint">ids</code> property is required in the body of the request. It can be either an array of ids or a string of comma-separated ids:</p>

<ul>
<li><code class="prettyprint">{&quot;ids&quot;: [&quot;112313&quot;, &quot;111123&quot;]}</code></li>
<li><code class="prettyprint">{&quot;ids&quot;: &quot;112313, 111123&quot;}</code></li>
</ul>

<h3 id="filters">Filters</h3>

<p>The metadata list provided by the endpoint can be filtered with the following attributes:</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Description</th>
<th>Accepted values</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td>Application associated with the metadata entity</td>
<td>any valid text</td>
</tr>
<tr>
<td>language</td>
<td>Language of the metadata entity</td>
<td>any valid text</td>
</tr>
</tbody></table>

<blockquote>
<p>Finding metadata by ids for a dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Finding metadata by ids for a widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset/widget/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Finding metadata by ids for a layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/:dataset/layer/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
     "ids": "b000288d-7037-43ba-aa34-165eab549613, 942b3f38-9504-4273-af51-0440170ffc86"
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613-dataset-b000288d-7037-43ba-aa34-165eab549613-prep-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prep"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already “locked in” due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2°F to +5.9°F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
        </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"organization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe Casola, University of Washington"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already “locked in” due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2°F to +5.9°F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"short-description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change in the Puget Sound Lowlands relative to average temperature between 1950-2005. Light colored lines in the background show the range of projections. All climate scenarios project warming for the Puget Sound region during the 21st century."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
          </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:02:28.337Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:03:02.445Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rw"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazon’s decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="vocabulary-and-tags">Vocabulary (and Tags)</h1>

<h2 id="resource-definition">Resource definition</h2>

<p>A Resource represents an external entity that will be related with a Vocabulary. The most common resources used when creating relationships with vocabulary are <em>datasets</em>, <em>layers</em> and <em>widgets</em>.</p>

<h2 id="tags-definition">Tags definition</h2>

<p>A Tag is a way to categorize a resource within a vocabulary context.</p>

<h2 id="vocabulary-definition">Vocabulary definition</h2>

<p>The Vocabulary can be described as a cluster of tags.</p>

<p>It is currently possible to just create a Vocabulary without any tags or relationships.
To do it, the only parameter that is required is the name of the Vocabulary.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">The name of the Vocabulary (<strong>it has to be unique and it represents the &ldquo;primaryKey&rdquo;</strong>)</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">The associated application for this vocabulary</td>
<td style="text-align: right">String</td>
</tr>
</tbody></table>

<p>However, the most common use case relies on the relationships creation.</p>

<h2 id="relationships">Relationships</h2>

<p>This section describes how to associate an existing or new Vocabulary to a resource.</p>

<p>Some important points:</p>

<ul>
<li>A <strong>Vocabulary</strong> can have <strong>N</strong> associated <strong>Resources</strong>.</li>
<li>A <strong>Resource</strong> can have <strong>M</strong> associated <strong>Vocabularies</strong>.</li>
<li>The way of building these <strong>relationships</strong> is creating <strong>Tags</strong>.</li>
</ul>

<h2 id="creating-a-vocabulary-resource-relationship">Creating a Vocabulary-Resource relationship</h2>

<p>To create a relationship between a Resource and a Vocabulary (even if the Vocabulary or the Resource doesn&rsquo;t exist yet) it is only required that you set the tags that define the relationship.</p>

<p>Some writing operations can take a little more time than reading ones. Even if the relationships are not strong, the writing operations have to ensure consistency along entities.</p>

<p>Remember that you can create relationshipts between Vocabulary and datasets, widgets or layers (the supported Resources).</p>

<aside class="notice">
Please, be sure that the request is properly authenticated and the current user has permission to the resource.
If you don&rsquo;t know how to do this, please go to the <a href="#authentication">Authentication section</a>
</aside>

<blockquote>
<p>Creating a relationship between a Vocabulary and a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Creating a relationship between a Vocabulary and a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Creating a relationship between a Vocabulary and a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": ["biology", "chemistry"]
  }'</span>
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"science"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="updating-an-existing-vocabulary-resource-relationship">Updating an existing Vocabulary-Resource relationship</h2>

<p>If a relationship has to be updated, it&rsquo;s necessary to define it&rsquo;s new tags.
The previous tags will be deleted in benefit of the new ones.</p>

<blockquote>
<p>Updating a relationship between a Vocabulary and a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Updating a relationship between a Vocabulary and a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Updating a relationship between a Vocabulary and a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": [&lt;tags&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
 "application": &lt;application&gt;,
   "tags": ["maths", "astronomy"]
  }'</span>
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"science"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"maths"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"astronomy"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"biology"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"chemistry"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="creating-several-vocabulary-resource-relationships">Creating several Vocabulary-Resource relationships</h2>

<p>There is also an endpoint that allows you to create multiple relationships in the same request.</p>

<blockquote>
<p>Creating multiple relationships between a Vocabulary and a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "vocabularyOne": {
   "application": &lt;application&gt;,
       "tags": [&lt;tags&gt;]
   },
   "vocabularyTwo": {
   "application": &lt;application&gt;,
       "tags": [&lt;tags&gt;]
   }
  }'</span>
</code></pre>
<blockquote>
<p>Creating multiple relationships between a Vocabulary and a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary<span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "vocabularyOne": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  },
  "vocabularyTwo": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  }
 }'</span>
</code></pre>
<blockquote>
<p>Creating multiple relationships between a Vocabulary and a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
  "vocabularyOne": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  },
  "vocabularyTwo": {
  "application": &lt;application&gt;,
      "tags": [&lt;tags&gt;]
  }
 }'</span>
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary?application<span class="o">=</span>&lt;application&gt;
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
     "country": {
         "tags": ["Spain", "Italy", "Portugal"]
     },
     "sport": {
         "tags": ["football", "basketball", "voleyball"]
     },
     "color": {
         "tags": ["red", "green", "blue"]
     }
  }'</span>
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameTwo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabularyNameOne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"tag1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tag3"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"newV"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"test1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"test2"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sport"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"football"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"basketball"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"voleyball"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="deleting-relationships">Deleting relationships</h2>

<blockquote>
<p>Deleting relationships between a Vocabulary and a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>Deleting relationships between a Vocabulary and a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>Deleting relationships between a Vocabulary and a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary/science
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="getting-vocabularies-associated-to-a-resource">Getting Vocabularies associated to a Resource</h2>

<p>You can be request all vocabularies that are associated to a particular resource.</p>

<blockquote>
<p>Getting Vocabularies related with a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary
</code></pre>
<blockquote>
<p>Getting Vocabularies related with a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary
</code></pre>
<blockquote>
<p>Getting Vocabularies related with a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/vocabulary
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vocabulary"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="getting-a-single-relationship-broken-now">Getting a single relationship (broken now)</h2>

<blockquote>
<p>Getting a single relationship between a Vocabulary and a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>Getting a single relationship between a Vocabulary and a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/&lt;widget-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<blockquote>
<p>Getting a single relationship between a Vocabulary and a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/&lt;layer-id&gt;/vocabulary/&lt;vocabulary-id&gt;
</code></pre>
<h2 id="getting-resources-common-use-case">Getting resources (COMMON USE CASE)</h2>

<p>There is also an endpoint available which accepts requests just indicating resource type and
the desired vocabulary-tag matching.</p>

<p>It currently supports DOUBLE-OR pattern matching, meaning the API will return
all resources that at least have one (or more) tags in a particular vocabulary. At the same time it will also apply an OR to the entities of other vocabulary-tag matchings.</p>

<p>The query has to be set in the url by the query params.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/vocabulary/find
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/vocabulary/find
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/vocabulary/find
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET http://api.resourcewatch.org/v1/dataset/vocabulary/find?legacy<span class="o">=</span>cdi,coasts
</code></pre>
<h2 id="getting-all-vocabularies">Getting all vocabularies</h2>

<p>This endpoint is quite useful to have a quick overview of all existing vocabularies and resources.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/vocabulary
</code></pre>
<h2 id="finding-vocabularies-by-ids">Finding vocabularies by ids</h2>

<p>The <code class="prettyprint">ids</code> property is required in the body of the request. It can be either an array of ids or a string of comma-separated ids:</p>

<ul>
<li><code class="prettyprint">{&quot;ids&quot;: [&quot;112313&quot;, &quot;111123&quot;]}</code></li>
<li><code class="prettyprint">{&quot;ids&quot;: &quot;112313, 111123&quot;}</code></li>
</ul>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/widget/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre><pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/&lt;dataset-id&gt;/layer/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Example of request with real data</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/dataset/vocabulary/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "ids": "942b3f38-9504-4273-af51-0440170ffc86, 08ff8183-48dc-457a-8924-bb4e7a87b8a8"
  }'</span>
</code></pre>
<blockquote>
<p>Example of response with real data</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"resource"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"08ff8183-48dc-457a-8924-bb4e7a87b8a8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"legacy"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"cdi"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"inundation"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"national"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"united states"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"local"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"coasts"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"flooding"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"health"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"resource"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Italy"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Portugal"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"red"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"green"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"blue"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="vocabulary-creation">Vocabulary Creation</h2>

<p>As was mentioned before, it is possible to just create a new and empty vocabulary</p>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/vocabulary/vocabularyName <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;application&gt;,
   "name": &lt;vocabularyName&gt;
  }'</span>
</code></pre>
<p>It is also possible to update and delete an entire vocabulary. Said that, because
it&rsquo;s necessary to keep consistency between entities with weak relationship, these
operations are only available to SUPERADMINS.</p>

<h2 id="bulk-delete-of-resource-39-s-vocabulary">Bulk delete of resource&rsquo;s vocabulary</h2>

<blockquote>
<p>Deleting all Vocabulary associated with a Dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/:datasetId/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Deleting all Vocabulary associated with a Widget</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/datasetId/widget/:widgetId/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Deleting all Vocabulary associated with a Layer</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/dataset/datasetId/layer/:layerId/vocabulary <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<p>In order to use these endpoints, you need to meet one of the following criteria:</p>

<ul>
<li>being authenticated as a SUPERADMIN;</li>
<li>being authenticated as an ADMIN who has access to the apps of the resource associated (dataset/widget/layer);</li>
<li>being authenticated as a MANAGER who has access to the apps of the resource associated AND own the resource.</li>
</ul>

<p>All endpoints return <code class="prettyprint">200 OK</code> in case of success, along with the list of the deleted entities.</p>

          <h1 id="geostore">Geostore</h1>

<h2 id="what-is-geostore">What is Geostore?</h2>

<p>Geostore is a geojson database. You can save your geojson or obtain geojson by country, region, Protected areas, etc.</p>

<p>Geostore object contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td style="text-align: center">Id of the geostore</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with the geometry</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>hash</td>
<td style="text-align: center">MD5 hash generated from geojson. Is the same that the id</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>provider</td>
<td style="text-align: center">This field should be completed if the geostore was created from a provider</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. It is possible use AND &amp; OR conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>areaHa</td>
<td style="text-align: center">Area in Hectares of the geojson</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>bbox</td>
<td style="text-align: center">Bounding box of the geojson</td>
<td style="text-align: right">Array</td>
</tr>
</tbody></table>

<aside class="notice">
Remember — All endpoint of geostore don&rsquo;t need that you are authenticated.
</aside>

<h2 id="create-geostore">Create Geostore</h2>

<p>You can create a geostore in 4 different ways:</p>

<h3 id="with-a-geojson">With a Geojson</h3>

<p>If you have your own geojson, you can save it in geostore. To create the geostore, you need to define all the required fields in the request body. The fields that compose a geostore are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with your geometry</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a Geostore, you have to do a POST query with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson": &lt;yourGeoJSONObject&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson":{
      "type":"FeatureCollection",
      "features":[
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"LineString",
               "coordinates":[
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ],
                  [
                     -3.995418548583985,
                     41.03767166215326
                  ],
                  [
                     -3.9842605590820312,
                     41.03844854003296
                  ],
                  [
                     -3.9844322204589844,
                     41.04589315472392
                  ],
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ]
               ]
            }
         },
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"Polygon",
               "coordinates":[
                  [
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ]
                  ]
               ]
            }
         }
      ]
   }
}'</span>
</code></pre>
<p>The response will be 200 if the geostore saves correctly and returns the geostore object with all information:</p>

<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"geojson"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"features"</span><span class="p">:[</span><span class="w">
               </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"geometry"</span><span class="p">:{</span><span class="w">
                     </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Polygon"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"coordinates"</span><span class="p">:[</span><span class="w">
                        </span><span class="p">[</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">]</span><span class="w">
                        </span><span class="p">]</span><span class="w">
                     </span><span class="p">]</span><span class="w">
                  </span><span class="p">}</span><span class="w">
               </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"crs"</span><span class="p">:{</span><span class="w">

            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"FeatureCollection"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"hash"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"provider"</span><span class="p">:{</span><span class="w">

         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="mf">397372.34122605197</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bbox"</span><span class="p">:[</span><span class="w">
            </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
            </span><span class="mf">40.84706035607122</span><span class="p">,</span><span class="w">
            </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
            </span><span class="mf">41.30257109430557</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country">From country</h3>

<p>If you need obtain the geostore of a country, you can obtain it with the ISO3 code in the Geostore API.</p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Spain
<code class="prettyprint">shell
curl -X GET https://api.resourcewatch.org/v1/geostore/admin/ESP
</code></p>
</blockquote>

<h3 id="country-list">Country list</h3>

<p>A list of countries can be obtained from this endpoint.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/list
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35a6d982388ee5c4e141c2bceac3fb72"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ESP"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spain"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8f77fe62cf15d5098ba0ee11c5126aa6"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FRA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"France"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1d568c183033da6c17cc28c4aecf1bcf"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cod"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Democratic Republic of the Congo"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country-and-region">From country and region</h3>

<p>If you need obtain the geostore of a region in a country, you can obtain it with the ISO3 and region code:</p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Madrid&rsquo;s Comunity in Spain</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/admin/ESP/8
</code></pre>
<h3 id="from-world-database-on-protected-areas-wdpa">From World Database on Protected Areas (wdpa)</h3>

<p>Is possible obtain the geostore of a World Database on Protected Areas of the world. You only need the id of the protected area (WDPA).
<a href="https://www.protectedplanet.net/">World Database on Protected Areas web</a></p>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/wdpa/&lt;wdpaId&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/wdpa/&lt;wdpaId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of &lsquo;Sierra de Guadarrama&rsquo; protected area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/wdpa/555538160
</code></pre>
<h3 id="from-land-use-areas">From land use areas</h3>

<p>Geostore has the geojson of 4 different lands use:</p>

<h4 id="oil-palm">Oil palm</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one Oil palm area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/oilpalm/556
</code></pre>
<h4 id="mining">Mining</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/mining/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/mining/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one mining area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/mining/573
</code></pre>
<h4 id="wood-fiber">Wood fiber</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/fiber/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/fiber/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of one Wood fiber area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/fiber/346
</code></pre>
<h4 id="congo-basin-logging-roads">Congo Basin logging roads</h4>

<p><code class="prettyprint">GET https://api.resourcewatch.org/v1/geostore/use/logging/&lt;id&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/&lt;id&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Oil palm area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/102
</code></pre>
<h3 id="from-carto">From Carto</h3>

<p>If your geojson is in carto table, is possible import this geojson in geostore.
To import the geojson in geostore, you need to define all of the required fields in the request body. The fields that compose a import are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td style="text-align: center">Provider of data</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
<td>carto</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. Is possible put and and or conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To import a Geostore, you have to do a POST with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": &lt;tableName&gt;,
        "user": &lt;userName&gt;,
        "filter": &lt;conditions&gt;
    }
}'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.resourcewatch.org/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": "gfw_mining",
        "user": "wri-01",
        "filter": "cartodb_id=573"
    }
}'</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="obtain-a-geostore">Obtain a Geostore</h2>

<p>To obtain a geostore, you only need the id of the Geostore. You can perform a GET request for the geostore with its id.</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/&lt;geostoreId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining one geostore</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/geostore/use/logging/26f8975c4c647c19a2edaa11f23880a2
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="tasks">Tasks</h1>

<h2 id="what-is-a-task">What is a task?</h2>

<p>In the context of this API, a task is a process in charge of performing certain actions on datasets of the document type.
These actions can be creating a dataset or overwriting its content.</p>

<p>A task may contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td style="text-align: center">Id of the task</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>type</td>
<td style="text-align: center">Task type - see full list <a href="https://github.com/resource-watch/doc-importer-messages/blob/master/task.messages.js#L4">here</a></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>message</td>
<td style="text-align: center">Task message, which parametrizes the task</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Status of the task - see full list <a href="https://github.com/resource-watch/doc-orchestrator/blob/master/app/src/app.constants.js#L3">here</a></td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>reads</td>
<td style="text-align: center">Number of data reads performed by the task</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>writes</td>
<td style="text-align: center">Number of data writes performed by the task</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>index</td>
<td style="text-align: center">Name of the Elasticsearch index used in this task</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>datasetId</td>
<td style="text-align: center">Id of the dataset to which this task relates</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>logs</td>
<td style="text-align: center">List of the individual operations carried out by this task</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>error</td>
<td style="text-align: center">Error message generated should the task fail</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Date and time in which the task was created</td>
<td style="text-align: right">DateTime</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Date and time in which the task was last updated</td>
<td style="text-align: right">DateTime</td>
</tr>
</tbody></table>

<p>A task is fundamentally an internal element to the API, and it&rsquo;s visibility and interaction is limited to maintenance and debug actions.
At its core, a task represents a single package that contains:</p>

<ul>
<li>An action to be carried out.</li>
<li>A message that parametrises that action.</li>
<li>A status that identifies the progress stage of the task.</li>
<li>A dataset to which that action should relate.</li>
<li>An Elasticsearch index identifier where the resulting data will be saved.</li>
<li>Counters for read and write operations.</li>
<li>Logs for those operations.</li>
<li>An optional error field that identifies what happened in case of failure.</li>
</ul>

<h2 id="get-all-tasks">Get all tasks</h2>

<p>To obtain all tasks:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:31.295Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:07.147Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a67f2557-9237-4435-82fd-3a0ad64b0292"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53ac8e83-167b-4c77-9b61-6642b1764b32"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">

            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"638cce8c-3e97-4bdd-b4de-41cd28254370"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                        </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
                </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:36.421Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:09.175Z"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_638cce8c3e974bddb4de41cd28254370_1550652900017"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"638cce8c-3e97-4bdd-b4de-41cd28254370"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8f5b6b0c-9132-4b5c-b7c4-b58582b3cb0b"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_638cce8c3e974bddb4de41cd28254370_1550652900017"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"63c69b2b-31cd-4bdb-9794-f6d4ec155e7b"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"415ecb4e-ed9a-4b0f-9f8b-7755775b08f5"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.resourcewatch.org/v1/doc-importer/task?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.resourcewatch.org/v1/doc-importer/task?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.resourcewatch.org/v1/doc-importer/task?page[number]=23&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"prev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.resourcewatch.org/v1/doc-importer/task?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.resourcewatch.org/v1/doc-importer/task?page[number]=2&amp;page[size]=10"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">227</span><span class="p">,</span><span class="w">
        </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="pagination">Pagination</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Default value</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">The number elements per page. The maximum allowed value is 100</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">10</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">The page number</td>
<td style="text-align: right">Number</td>
<td style="text-align: right">1</td>
</tr>
</tbody></table>

<h3 id="filter-params">Filter params</h3>

<p>Available filters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td style="text-align: center">Task type</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Task status</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>datasetID</td>
<td style="text-align: center">Id of the dataset to which the task refers</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>createdAt</td>
<td style="text-align: center">Tasks created on the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAt</td>
<td style="text-align: center">Tasks last updated on the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>createdBefore</td>
<td style="text-align: center">Tasks created before the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>createdAfter</td>
<td style="text-align: center">Tasks created after the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedBefore</td>
<td style="text-align: center">Tasks last updated before the given date</td>
<td style="text-align: right">Date</td>
</tr>
<tr>
<td>updatedAfter</td>
<td style="text-align: center">Tasks last updated after the given date</td>
<td style="text-align: right">Date</td>
</tr>
</tbody></table>

<blockquote>
<p>Return tasks with type TASK_OVERWRITE</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?type<span class="o">=</span>TASK_OVERWRITE
</code></pre>
<blockquote>
<p>Return the tasks with status SAVED</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?status<span class="o">=</span>SAVED
</code></pre>
<blockquote>
<p>Return the tasks created on Feb 1st 2019</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?createdAt<span class="o">=</span>2019-02-01
</code></pre>
<blockquote>
<p>Return the tasks last updated between Jan 2nd and Feb 2nd 2019</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?updatedAfter<span class="o">=</span>2019-01-02&amp;updatedBefore<span class="o">=</span>2019-02-02
</code></pre>
<blockquote>
<p>Return the tasks last updated before and Feb 2nd 2019 and with status ERROR</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task?updatedBefore<span class="o">=</span>2019-02-02&amp;status<span class="o">=</span>ERROR
</code></pre>
<h2 id="get-a-single-task">Get a single task</h2>

<p>To obtain the task:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/v1/doc-importer/task/55b02cfd-dabf-4ad0-a04d-5501cf248a0c
</code></pre>
<aside class="success">
Remember — the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"task"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TASK_CREATE"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"fileUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gfw2-data.s3.amazonaws.com/country-pages/fire_alerts_all.csv"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"csv"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
                    </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rows"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SAVED"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"reads"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
            </span><span class="s2">"writes"</span><span class="p">:</span><span class="w"> </span><span class="mi">973</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T07:39:31.295Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-20T10:10:07.147Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"datasetId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"65593fee-26e0-4c3c-84b3-cc0921bf8bc1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a67f2557-9237-4435-82fd-3a0ad64b0292"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_INDEX_CREATED"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index_65593fee26e04c3c84b3cc0921bf8bc1_1550648371365"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53ac8e83-167b-4c77-9b61-6642b1764b32"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STATUS_READ_DATA"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55b02cfd-dabf-4ad0-a04d-5501cf248a0c"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete-a-task">Delete a task</h2>

<p>You can delete a task if, for example, it is stuck on a running state, but it&rsquo;s not actually running. This should
be considered a &ldquo;only do it if you know what you are doing&rdquo; operation, and requires ADMIN permission.</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/v1/doc-importer/task/&lt;task_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="microservices">Microservices</h1>

<p>A list of information related to the microservices</p>

<aside class="notice">
    These services are only available to ADMIN users.
</aside>

<h2 id="list-all-registered-microservices">List all registered microservices</h2>

<p>To obtain a list of all the registered microservices:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/api/v1/microservice <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.748Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="w">

        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dataset"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dataset.default.svc.cluster.local:3000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/find-by-ids"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/find-by-ids"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-24T13:04:46.728Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.778Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"layer"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5aa667d1aee7ae16fb419c23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://layer.default.svc.cluster.local:6000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-08T12:07:38.014Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<h3 id="filters">Filters</h3>

<p>The microservice list provided by the endpoint can be filtered with the following attributes:</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Description</th>
<th>Accepted values</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>Status of the microservice</td>
<td><code class="prettyprint">pending</code>, <code class="prettyprint">active</code> or <code class="prettyprint">error</code></td>
</tr>
<tr>
<td>url</td>
<td>Internal URL of the microservice within the cluster</td>
<td>String</td>
</tr>
</tbody></table>

<blockquote>
<p>Filtering by status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/api/v1/microservice?status<span class="o">=</span>active <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h2 id="get-a-microservice-by-id">Get a microservice by id</h2>

<p>To obtain the details of a single microservice, use:</p>
<pre class="highlight shell"><code>curl -X GET https://api.resourcewatch.org/api/v1/microservice/5aa667d1aee7ae16fb419c23 <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5aa667d1aee7ae16fb419c23"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.778Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"layer"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"layer"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Layer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://layer.default.svc.cluster.local:6000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/layer"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/layer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/:dataset/layer"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/:dataset/layer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-08T12:07:38.014Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete-microservice">Delete microservice</h2>

<p>To remove a microservice:</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.resourcewatch.org/api/v1/microservice/:id <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<p>This will delete the microservice and its associated endpoints from the gateway&rsquo;s database. It does not remove the actual running microservice application instance, which may re-register and become available once again.</p>

          <h1 id="troubleshooting">Troubleshooting</h1>

<p>This section is meant to help you deal with common pitfalls of everyday usage of the API.</p>

<h2 id="authentication-and-authorization">Authentication and authorization</h2>

<h3 id="401-unauthorized">401 Unauthorized</h3>

<p><code class="prettyprint">401 Unauthorized</code> errors mean that the API did not receive the necessary data to identify who you are. You may not be logged in, there may be an issue with your usage of the user token, or the token you are using may be in the wrong header.</p>

<p>Start by following the steps <a href="#how-to-generate-your-private-token">detailed here for obtaining your private token</a>. At the end you should have your <a href="https://en.wikipedia.org/wiki/JSON_Web_Token">JWT token</a>, a large string of random-looking characters.</p>

<p>If you are sure you have an up-to-date token but are still experiencing <code class="prettyprint">401 Unauthorized</code> errors, there may be an issue with the way the token is transmitted to the API. Be sure to use in <code class="prettyprint">Authorization</code> header and <code class="prettyprint">Bearer &lt;your token goes here&gt;</code> value.</p>

<h3 id="403-forbidden">403 Forbidden</h3>

<p>A <code class="prettyprint">403 Forbidden</code> error means that you are identified as a valid user, but you do not have the required permissions for the action you are trying to perform. Common scenarios where this happens are:
- You do not have the required user <code class="prettyprint">ROLE</code> to carry out that operation.
- You may be trying to operate on a resource that belongs to a different <code class="prettyprint">application</code> than the ones you are associated with.
- Certain resources have a concept of <code class="prettyprint">owner</code> with certain actions being exclusively available to that particular user.</p>

<p>Check the specific documentation for the endpoint you are trying to use for more details on its behavior. Conditions that trigger a <code class="prettyprint">403 Forbidden</code> error will often vary beyond the ones listed above.</p>

          <h1 id="errors">Errors</h1>

<p>The Resource Watch API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request is incomplete or contains errors</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is incorrect</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that is not json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
